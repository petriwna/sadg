/*! For license information please see main-a75b68d9.js.LICENSE.txt */
(()=>{"use strict";var t={};function e(t,e,n){return Array.prototype.slice.call(t,e,n)}function n(t){return t.bind.apply(t,[null].concat(e(arguments,1)))}function r(t,e){return typeof e===t}t.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}();var i=Array.isArray;function o(t){return i(t)?t:[t]}function s(t,e){o(t).forEach(e)}n(r,"function"),n(r,"string"),n(r,"undefined");var a=Object.keys;var c="destroy";function u(t){var r=t?t.event.bus:document.createDocumentFragment(),u=function(){var t=[];function e(t,e,n){s(t,(function(t){t&&s(e,(function(e){e.split(" ").forEach((function(e){var r=e.split(".");n(t,r[0],r[1])}))}))}))}return{bind:function(n,r,i,o){e(n,r,(function(e,n,r){var s="addEventListener"in e,a=s?e.removeEventListener.bind(e,n,i,o):e.removeListener.bind(e,i);s?e.addEventListener(n,i,o):e.addListener(i),t.push([e,n,r,i,a])}))},unbind:function(n,r,i){e(n,r,(function(e,n,r){t=t.filter((function(t){return!!(t[0]!==e||t[1]!==n||t[2]!==r||i&&t[3]!==i)||(t[4](),!1)}))}))},dispatch:function(t,e,n){var r,i=!0;return"function"==typeof CustomEvent?r=new CustomEvent(e,{bubbles:i,detail:n}):(r=document.createEvent("CustomEvent")).initCustomEvent(e,i,!1,n),t.dispatchEvent(r),r},destroy:function(){t.forEach((function(t){t[4]()})),t.length=0}}}();return t&&t.event.on(c,u.destroy),function(t){return e(arguments,1).forEach((function(e){!function(t,e,n){if(t)for(var r=a(t),i=0;i<r.length;i++){var o=r[i];if("__proto__"!==o&&!1===e(t[o],o))break}}(e,(function(n,r){t[r]=e[r]}))})),t}(u,{bus:r,on:function(t,e){u.bind(r,o(t).join(" "),(function(t){e.apply(e,i(t.detail)?t.detail:[])}))},off:n(u.unbind,r),emit:function(t){u.dispatch(r,t,e(arguments,1))}})}function l(t){return t.bind(null,...(e=arguments,1,Array.prototype.slice.call(e,1,undefined)));var e}function h(t,e){return typeof e===t}l(h,"function"),l(h,"string");const d=l(h,"undefined"),f=Object.keys;function p(t,e,n){const{emit:r}=u(t),i=n.intersection||{},o=function(t){const{Components:e}=t;return{keyboard:{enable(){e.Keyboard.disable(!1)},disable(){e.Keyboard.disable(!0)}},autoplay:{enable(){t.options.autoplay&&e.Autoplay.play()},disable(){e.Autoplay.pause()}},autoScroll:{enable(){const t=e.AutoScroll;t&&t.play()},disable(){const t=e.AutoScroll;t&&t.pause()}},video:{enable(){const t=e.Video;t&&t.play()},disable(){const t=e.Video;t&&t.pause()}}}}(t);let s;function a(){s&&(s.disconnect(),s=null)}function c([t]){t&&(t.isIntersecting?function(t){l(i.inView||{}),r("intersection:in",t),i.once&&a()}(t):function(t){l(i.outView||{}),r("intersection:out",t)}(t),r("intersection",t))}function l(t){!function(t,e,n){if(t){let n=f(t);for(let r=0;r<n.length;r++){const i=n[r];if("__proto__"!==i&&!1===e(t[i],i))break}}}(t,((t,e)=>{if(!d(t)){const n=o[e];t?n.enable():n.disable()}}))}return{mount:function(){window.IntersectionObserver&&(s=new IntersectionObserver(c,{root:i.root,rootMargin:i.rootMargin,threshold:i.threshold}),s.observe(t.root))},destroy:a}}function m(t){return m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},m(t)}function y(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,v(r.key),r)}}function v(t){var e=function(t,e){if("object"!=m(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!=m(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==m(e)?e:e+""}var g=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.initSplide()},(e=[{key:"initSplide",value:function(){var t=new Splide(".splide",{type:"loop",lazyLoad:!0,pagination:!1,perPage:1,arrows:!1,interval:18e3,pauseOnHover:!1,gap:0,pauseOnFocus:!1,autoplay:"pause",intersection:{inView:{autoplay:!0},outView:{autoplay:!1}},classes:{progress:"splide__progress__bar advantages__progress"}});t.on("mounted move",(function(){var e=t.Components.Elements.slides[t.index];document.querySelectorAll(".splide__slide video").forEach((function(t){t.pause(),t.currentTime=0}));var n=e.querySelector("video");n&&t.options.autoplay&&n.pause(),t.on("autoplay:playing",(function(){var e=t.Components.Elements.slides[t.index].querySelector("video");e&&e.play()})),t.on("autoplay:pause",(function(){var e=t.Components.Elements.slides[t.index].querySelector("video");e&&(e.pause(),e.currentTime=0)}))})),t.mount({Intersection:p})}}])&&y(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}(),_=function(t,e){return _=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},_(t,e)};function b(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}_(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function w(t,e){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(a){return function(c){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,a[0]&&(s=0)),s;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,r=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){s.label=a[1];break}if(6===a[0]&&s.label<i[1]){s.label=i[1],i=a;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(a);break}i[2]&&s.ops.pop(),s.trys.pop();continue}a=e.call(t,s)}catch(t){a=[6,t],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}}function C(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function E(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s}function S(t,e,n){if(n||2===arguments.length)for(var r,i=0,o=e.length;i<o;i++)!r&&i in e||(r||(r=Array.prototype.slice.call(e,0,i)),r[i]=e[i]);return t.concat(r||Array.prototype.slice.call(e))}function k(t){return this instanceof k?(this.v=t,this):new k(t)}Object.create,Object.create,"function"==typeof SuppressedError&&SuppressedError;var I=function(t){return t&&"number"==typeof t.length&&"function"!=typeof t};function T(t){return"function"==typeof t}var x,P=((x=function(t){var e;e=this,Error.call(e),e.stack=(new Error).stack,this.message=t?t.length+" errors occurred during unsubscription:\n"+t.map((function(t,e){return e+1+") "+t.toString()})).join("\n  "):"",this.name="UnsubscriptionError",this.errors=t}).prototype=Object.create(Error.prototype),x.prototype.constructor=x,x);function L(t,e){if(t){var n=t.indexOf(e);0<=n&&t.splice(n,1)}}var N=function(){function t(t){this.initialTeardown=t,this.closed=!1,this._parentage=null,this._finalizers=null}return t.prototype.unsubscribe=function(){var t,e,n,r,i;if(!this.closed){this.closed=!0;var o=this._parentage;if(o)if(this._parentage=null,Array.isArray(o))try{for(var s=C(o),a=s.next();!a.done;a=s.next())a.value.remove(this)}catch(e){t={error:e}}finally{try{a&&!a.done&&(e=s.return)&&e.call(s)}finally{if(t)throw t.error}}else o.remove(this);var c=this.initialTeardown;if(T(c))try{c()}catch(t){i=t instanceof P?t.errors:[t]}var u=this._finalizers;if(u){this._finalizers=null;try{for(var l=C(u),h=l.next();!h.done;h=l.next()){var d=h.value;try{D(d)}catch(t){i=null!=i?i:[],t instanceof P?i=S(S([],E(i)),E(t.errors)):i.push(t)}}}catch(t){n={error:t}}finally{try{h&&!h.done&&(r=l.return)&&r.call(l)}finally{if(n)throw n.error}}}if(i)throw new P(i)}},t.prototype.add=function(e){var n;if(e&&e!==this)if(this.closed)D(e);else{if(e instanceof t){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=null!==(n=this._finalizers)&&void 0!==n?n:[]).push(e)}},t.prototype._hasParent=function(t){var e=this._parentage;return e===t||Array.isArray(e)&&e.includes(t)},t.prototype._addParent=function(t){var e=this._parentage;this._parentage=Array.isArray(e)?(e.push(t),e):e?[e,t]:t},t.prototype._removeParent=function(t){var e=this._parentage;e===t?this._parentage=null:Array.isArray(e)&&L(e,t)},t.prototype.remove=function(e){var n=this._finalizers;n&&L(n,e),e instanceof t&&e._removeParent(this)},t.EMPTY=((e=new t).closed=!0,e),t;var e}();function O(t){return t instanceof N||t&&"closed"in t&&T(t.remove)&&T(t.add)&&T(t.unsubscribe)}function D(t){T(t)?t():t.unsubscribe()}N.EMPTY;var A={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},R={setTimeout:function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var i=R.delegate;return(null==i?void 0:i.setTimeout)?i.setTimeout.apply(i,S([t,e],E(n))):setTimeout.apply(void 0,S([t,e],E(n)))},clearTimeout:function(t){var e=R.delegate;return((null==e?void 0:e.clearTimeout)||clearTimeout)(t)},delegate:void 0};function M(t){R.setTimeout((function(){var e=A.onUnhandledError;if(!e)throw t;e(t)}))}function j(){}var F=q("C",void 0,void 0);function q(t,e,n){return{kind:t,value:e,error:n}}var z=null,B=function(t){function e(e){var n=t.call(this)||this;return n.isStopped=!1,e?(n.destination=e,O(e)&&e.add(n)):n.destination=Y,n}return b(e,t),e.create=function(t,e,n){return new V(t,e,n)},e.prototype.next=function(t){this.isStopped?$(function(t){return q("N",t,void 0)}(t),this):this._next(t)},e.prototype.error=function(t){this.isStopped?$(function(t){return q("E",void 0,t)}(t),this):(this.isStopped=!0,this._error(t))},e.prototype.complete=function(){this.isStopped?$(F,this):(this.isStopped=!0,this._complete())},e.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,t.prototype.unsubscribe.call(this),this.destination=null)},e.prototype._next=function(t){this.destination.next(t)},e.prototype._error=function(t){try{this.destination.error(t)}finally{this.unsubscribe()}},e.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},e}(N),U=Function.prototype.bind;function W(t,e){return U.call(t,e)}var H=function(){function t(t){this.partialObserver=t}return t.prototype.next=function(t){var e=this.partialObserver;if(e.next)try{e.next(t)}catch(t){G(t)}},t.prototype.error=function(t){var e=this.partialObserver;if(e.error)try{e.error(t)}catch(t){G(t)}else G(t)},t.prototype.complete=function(){var t=this.partialObserver;if(t.complete)try{t.complete()}catch(t){G(t)}},t}(),V=function(t){function e(e,n,r){var i,o,s=t.call(this)||this;return T(e)||!e?i={next:null!=e?e:void 0,error:null!=n?n:void 0,complete:null!=r?r:void 0}:s&&A.useDeprecatedNextContext?((o=Object.create(e)).unsubscribe=function(){return s.unsubscribe()},i={next:e.next&&W(e.next,o),error:e.error&&W(e.error,o),complete:e.complete&&W(e.complete,o)}):i=e,s.destination=new H(i),s}return b(e,t),e}(B);function G(t){var e;A.useDeprecatedSynchronousErrorHandling?(e=t,A.useDeprecatedSynchronousErrorHandling&&z&&(z.errorThrown=!0,z.error=e)):M(t)}function $(t,e){var n=A.onStoppedNotification;n&&R.setTimeout((function(){return n(t,e)}))}var Y={closed:!0,next:j,error:function(t){throw t},complete:j},K="function"==typeof Symbol&&Symbol.observable||"@@observable";function Q(t){return t}var J=function(){function t(t){t&&(this._subscribe=t)}return t.prototype.lift=function(e){var n=new t;return n.source=this,n.operator=e,n},t.prototype.subscribe=function(t,e,n){var r,i=this,o=(r=t)&&r instanceof B||function(t){return t&&T(t.next)&&T(t.error)&&T(t.complete)}(r)&&O(r)?t:new V(t,e,n);return function(t){if(A.useDeprecatedSynchronousErrorHandling){var e=!z;if(e&&(z={errorThrown:!1,error:null}),t(),e){var n=z,r=n.errorThrown,i=n.error;if(z=null,r)throw i}}else t()}((function(){var t=i,e=t.operator,n=t.source;o.add(e?e.call(o,n):n?i._subscribe(o):i._trySubscribe(o))})),o},t.prototype._trySubscribe=function(t){try{return this._subscribe(t)}catch(e){t.error(e)}},t.prototype.forEach=function(t,e){var n=this;return new(e=X(e))((function(e,r){var i=new V({next:function(e){try{t(e)}catch(t){r(t),i.unsubscribe()}},error:r,complete:e});n.subscribe(i)}))},t.prototype._subscribe=function(t){var e;return null===(e=this.source)||void 0===e?void 0:e.subscribe(t)},t.prototype[K]=function(){return this},t.prototype.pipe=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return(0===(n=t).length?Q:1===n.length?n[0]:function(t){return n.reduce((function(t,e){return e(t)}),t)})(this);var n},t.prototype.toPromise=function(t){var e=this;return new(t=X(t))((function(t,n){var r;e.subscribe((function(t){return r=t}),(function(t){return n(t)}),(function(){return t(r)}))}))},t.create=function(e){return new t(e)},t}();function X(t){var e;return null!==(e=null!=t?t:A.Promise)&&void 0!==e?e:Promise}var Z="function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator";function tt(t){if(t instanceof J)return t;if(null!=t){if(function(t){return T(t[K])}(t))return o=t,new J((function(t){var e=o[K]();if(T(e.subscribe))return e.subscribe(t);throw new TypeError("Provided object does not correctly implement Symbol.observable")}));if(I(t))return i=t,new J((function(t){for(var e=0;e<i.length&&!t.closed;e++)t.next(i[e]);t.complete()}));if(T(null==(r=t)?void 0:r.then))return n=t,new J((function(t){n.then((function(e){t.closed||(t.next(e),t.complete())}),(function(e){return t.error(e)})).then(null,M)}));if(function(t){return Symbol.asyncIterator&&T(null==t?void 0:t[Symbol.asyncIterator])}(t))return et(t);if(function(t){return T(null==t?void 0:t[Z])}(t))return e=t,new J((function(t){var n,r;try{for(var i=C(e),o=i.next();!o.done;o=i.next()){var s=o.value;if(t.next(s),t.closed)return}}catch(t){n={error:t}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}t.complete()}));if(function(t){return T(null==t?void 0:t.getReader)}(t))return et(function(t){return function(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=n.apply(t,e||[]),o=[];return r={},s("next"),s("throw"),s("return"),r[Symbol.asyncIterator]=function(){return this},r;function s(t){i[t]&&(r[t]=function(e){return new Promise((function(n,r){o.push([t,e,n,r])>1||a(t,e)}))})}function a(t,e){try{(n=i[t](e)).value instanceof k?Promise.resolve(n.value.v).then(c,u):l(o[0][2],n)}catch(t){l(o[0][3],t)}var n}function c(t){a("next",t)}function u(t){a("throw",t)}function l(t,e){t(e),o.shift(),o.length&&a(o[0][0],o[0][1])}}(this,arguments,(function(){var e,n,r;return w(this,(function(i){switch(i.label){case 0:e=t.getReader(),i.label=1;case 1:i.trys.push([1,,9,10]),i.label=2;case 2:return[4,k(e.read())];case 3:return n=i.sent(),r=n.value,n.done?[4,k(void 0)]:[3,5];case 4:return[2,i.sent()];case 5:return[4,k(r)];case 6:return[4,i.sent()];case 7:return i.sent(),[3,2];case 8:return[3,10];case 9:return e.releaseLock(),[7];case 10:return[2]}}))}))}(t))}var e,n,r,i,o;throw function(t){return new TypeError("You provided "+(null!==t&&"object"==typeof t?"an invalid object":"'"+t+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}(t)}function et(t){return new J((function(e){(function(t,e){var n,r,i,o,s,a,c,u;return s=this,a=void 0,u=function(){var s,a;return w(this,(function(c){switch(c.label){case 0:c.trys.push([0,5,6,11]),n=function(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,n=t[Symbol.asyncIterator];return n?n.call(t):(t=C(t),e={},r("next"),r("throw"),r("return"),e[Symbol.asyncIterator]=function(){return this},e);function r(n){e[n]=t[n]&&function(e){return new Promise((function(r,i){!function(t,e,n,r){Promise.resolve(r).then((function(e){t({value:e,done:n})}),e)}(r,i,(e=t[n](e)).done,e.value)}))}}}(t),c.label=1;case 1:return[4,n.next()];case 2:if((r=c.sent()).done)return[3,4];if(s=r.value,e.next(s),e.closed)return[2];c.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return a=c.sent(),i={error:a},[3,11];case 6:return c.trys.push([6,,9,10]),r&&!r.done&&(o=n.return)?[4,o.call(n)]:[3,8];case 7:c.sent(),c.label=8;case 8:return[3,10];case 9:if(i)throw i.error;return[7];case 10:return[7];case 11:return e.complete(),[2]}}))},new((c=void 0)||(c=Promise))((function(t,e){function n(t){try{i(u.next(t))}catch(t){e(t)}}function r(t){try{i(u.throw(t))}catch(t){e(t)}}function i(e){var i;e.done?t(e.value):(i=e.value,i instanceof c?i:new c((function(t){t(i)}))).then(n,r)}i((u=u.apply(s,a||[])).next())}))})(t,e).catch((function(t){return e.error(t)}))}))}function nt(t){return function(e){if(function(t){return T(null==t?void 0:t.lift)}(e))return e.lift((function(e){try{return t(e,this)}catch(t){this.error(t)}}));throw new TypeError("Unable to lift unknown Observable type")}}function rt(t,e,n,r,i){return new it(t,e,n,r,i)}var it=function(t){function e(e,n,r,i,o,s){var a=t.call(this,e)||this;return a.onFinalize=o,a.shouldUnsubscribe=s,a._next=n?function(t){try{n(t)}catch(t){e.error(t)}}:t.prototype._next,a._error=i?function(t){try{i(t)}catch(t){e.error(t)}finally{this.unsubscribe()}}:t.prototype._error,a._complete=r?function(){try{r()}catch(t){e.error(t)}finally{this.unsubscribe()}}:t.prototype._complete,a}return b(e,t),e.prototype.unsubscribe=function(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var n=this.closed;t.prototype.unsubscribe.call(this),!n&&(null===(e=this.onFinalize)||void 0===e||e.call(this))}},e}(B);function ot(t,e){return nt((function(n,r){var i=0;n.subscribe(rt(r,(function(n){r.next(t.call(e,n,i++))})))}))}function st(t,e,n){return void 0===n&&(n=1/0),T(e)?st((function(n,r){return ot((function(t,i){return e(n,t,r,i)}))(tt(t(n,r)))}),n):("number"==typeof e&&(n=e),nt((function(e,r){return function(t,e,n,r,i,o,s,a){var c=[],u=0,l=0,h=!1,d=function(){!h||c.length||u||e.complete()},f=function(t){return u<r?p(t):c.push(t)},p=function(t){u++;var i=!1;tt(n(t,l++)).subscribe(rt(e,(function(t){e.next(t)}),(function(){i=!0}),void 0,(function(){if(i)try{u--;for(var t=function(){var t=c.shift();p(t)};c.length&&u<r;)t();d()}catch(t){e.error(t)}})))};return t.subscribe(rt(e,f,(function(){h=!0,d()}))),function(){}}(e,r,t,n)})))}var at=Array.isArray;var ct=["addListener","removeListener"],ut=["addEventListener","removeEventListener"],lt=["on","off"];function ht(t,e,n,r){if(T(n)&&(r=n,n=void 0),r)return ht(t,e,n).pipe((i=r,ot((function(t){return function(t,e){return at(e)?t.apply(void 0,S([],E(e))):t(e)}(i,t)}))));var i,o=E(function(t){return T(t.addEventListener)&&T(t.removeEventListener)}(t)?ut.map((function(r){return function(i){return t[r](e,i,n)}})):function(t){return T(t.addListener)&&T(t.removeListener)}(t)?ct.map(dt(t,e)):function(t){return T(t.on)&&T(t.off)}(t)?lt.map(dt(t,e)):[],2),s=o[0],a=o[1];if(!s&&I(t))return st((function(t){return ht(t,e,n)}))(tt(t));if(!s)throw new TypeError("Invalid event target");return new J((function(t){var e=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return t.next(1<e.length?e:e[0])};return s(e),function(){return a(e)}}))}function dt(t,e){return function(n){return function(r){return t[n](e,r)}}}function ft(t){return ft="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ft(t)}function pt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,mt(r.key),r)}}function mt(t){var e=function(t,e){if("object"!=ft(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!=ft(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==ft(e)?e:e+""}var yt=function(){return t=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.splideContainers=e.parentNode,this.init()},(e=[{key:"init",value:function(){var t=this.splideContainers.querySelectorAll(".splide__slide").length>4,e=t?"loop":"slide";new Splide(this.splideContainers,{type:e,arrows:!1,gap:8,perPage:4,pagination:!1,classes:{pagination:"splide__pagination pagination",page:"splide__pagination__page pagination__button"},breakpoints:{600:{perPage:1,pagination:!0},768:{perPage:2,pagination:!0},992:{perPage:3,pagination:!0},1280:{perPage:4,pagination:t}}}).mount()}}])&&pt(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function vt(t){return vt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vt(t)}function gt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,_t(r.key),r)}}function _t(t){var e=function(t,e){if("object"!=vt(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!=vt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==vt(e)?e:e+""}var bt=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.basketFab=document.querySelector("#basket"),this.basket=[]},(e=[{key:"addProductToBasket",value:function(t,e,n,r,i,o){this.basketFab.style.display="flex";var s=this.basket.findIndex((function(t){return t.code===n&&t.size===i}));-1!==s?this.basket[s].quantity+=o:this.basket.push({img:t,name:e,code:n,price:r,size:i,quantity:o})}},{key:"renderBasket",value:function(){var t=document.querySelector(".basket");t.innerHTML="",this.basket.map((function(e){var n=document.createElement("article");n.classList.add("basket__item"),n.innerHTML="\n        <div class='basket__info'>\n          <div class='basket__description'>\n            <img class='basket__img' src='".concat(e.img,"' alt='").concat(e.name,"'>\n            <div class='basket__text'>\n            <h3 class='basket__name'>").concat(e.name,"</h3>\n              ").concat(e.size?"<p class='basket__options'>".concat(e.size,"</p>"):"","\n              <p class='basket__options'>").concat(e.code,"</p>\n            </div>\n          </div>\n          <div class='basket__settings'>\n            <div class='basket__counter'>\n              <button class='basket__plus-minus basket-minus' type='button'>-</button>\n              <label for='order-counter' class='visually-hidden'></label>\n              <input type='number' name='order-counter' class='basket__value' min='1' step='1' size='4' max='999' maxlength='3'\n                 value='").concat(e.quantity,"'>\n              <button class='basket__plus-minus basket-plus' type='button'>+</button>\n            </div>\n            <div>\n              <p class='basket__price'></p>\n            </div>\n          </div>\n        </div>\n        <button class='basket__delete' id='delete' type='button'>\n          <svg width='30' height='30'>\n            <use href='public/images/icons.svg#icon-close'></use>\n          </svg>\n        </button>\n      "),t.appendChild(n)}))}},{key:"getSumProduct",value:function(t){return this.basket[t].price*this.basket[t].quantity}},{key:"getSumBasket",value:function(){var t=0;return this.basket.forEach((function(e){var n=e.price*e.quantity;t+=n})),t}},{key:"changeQuantity",value:function(t,e){this.basket[t].quantity=e>=1?e:1}},{key:"getQuantity",value:function(){var t=0;return this.basket.forEach((function(e){t+=e.quantity})),t}},{key:"getBasket",value:function(){return this.basket}},{key:"clearBasket",value:function(){this.basketFab.style.display="none",this.basket=[]}},{key:"deleteProduct",value:function(t){this.basket.splice(t,1)}}])&&gt(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function wt(t,e,n){var r=T(t)||e||n?{next:t,error:e,complete:n}:t;return r?nt((function(t,e){var n;null===(n=r.subscribe)||void 0===n||n.call(r);var i=!0;t.subscribe(rt(e,(function(t){var n;null===(n=r.next)||void 0===n||n.call(r,t),e.next(t)}),(function(){var t;i=!1,null===(t=r.complete)||void 0===t||t.call(r),e.complete()}),(function(t){var n;i=!1,null===(n=r.error)||void 0===n||n.call(r,t),e.error(t)}),(function(){var t,e;i&&(null===(t=r.unsubscribe)||void 0===t||t.call(r)),null===(e=r.finalize)||void 0===e||e.call(r)})))})):Q}function Ct(t){return Ct="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ct(t)}function Et(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,St(r.key),r)}}function St(t){var e=function(t,e){if("object"!=Ct(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!=Ct(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Ct(e)?e:e+""}var kt=function(){return t=function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.backdrop=document.querySelector(e),this.closeBtn=document.querySelector(n)},(e=[{key:"setupEventListeners",value:function(){var t=this;ht(this.closeBtn,"click").subscribe((function(){return t.close()})),ht(this.backdrop,"click").pipe(wt((function(e){e.target===t.backdrop&&t.close()}))).subscribe()}},{key:"open",value:function(){this.backdrop.classList.remove("is-hidden"),document.body.classList.add("is-scroll-disable")}},{key:"close",value:function(){this.backdrop.classList.add("is-hidden"),document.body.classList.remove("is-scroll-disable")}}])&&Et(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function It(t){return It="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},It(t)}function Tt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,xt(r.key),r)}}function xt(t){var e=function(t,e){if("object"!=It(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!=It(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==It(e)?e:e+""}var Pt=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)},e=[{key:"isPhoneNumber",value:function(t){return/^\+380\d{9}$/.test(t.replace(/\s/g,""))}},{key:"isNameValid",value:function(t){return/^[A-Z\u0401\u0404\u0406\u0407\u0410-\u042F\u0490][\t-\r \x2Da-z\xA0\u0430-\u044F\u0451\u0454\u0456\u0457\u0491\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]{2,}$/.test(t)}},{key:"isEmpty",value:function(t){return!!t}}],null&&Tt(t.prototype,null),e&&Tt(t,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function Lt(t){return Lt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Lt(t)}function Nt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Ot(r.key),r)}}function Ot(t){var e=function(t,e){if("object"!=Lt(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!=Lt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Lt(e)?e:e+""}var Dt=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.selected=document.querySelector(".select__wrapper"),this.optionsAll=document.querySelectorAll(".select__option"),this.selectedValue=this.selected.querySelector("span").textContent},(e=[{key:"init",value:function(){var t=this;this.selected.addEventListener("click",(function(){return t.handleSelectClick()})),this.optionsAll.forEach((function(e){e.addEventListener("click",(function(){return t.handleOptionsClick(e)}))}))}},{key:"handleSelectClick",value:function(){var t=this.selected.parentNode.querySelector(".arrow"),e=this.selected.previousSibling;if(e.classList.contains("active"))e.classList.remove("active"),t.classList.add("rotated");else{var n=document.querySelector(".select__options-container.active");n&&(n.classList.remove(".active"),n.parentNode.querySelector(".arrow").classList.add("rotated")),t.classList.remove("rotated"),e.classList.add("active")}}},{key:"handleOptionsClick",value:function(t){this.selected&&(this.selected.querySelector("span").textContent=t.textContent,this.selectedValue=t.textContent,t.parentNode.querySelector(".select__option--active").classList.remove("select__option--active"),t.classList.add("select__option--active")),this.closeDropdown()}},{key:"closeDropdown",value:function(){var t=this.selected.previousSibling,e=this.selected.parentNode.querySelector(".arrow");t&&t.classList.remove("active"),e&&e.classList.add("rotated")}}])&&Nt(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function At(t){return At="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},At(t)}function Rt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Mt(r.key),r)}}function Mt(t){var e=function(t,e){if("object"!=At(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!=At(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==At(e)?e:e+""}var jt=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)},e=[{key:"createAlert",value:function(t,e){var n=document.querySelector("main"),r=document.createElement("div");r.className="alert alert__".concat(t),r.innerHTML="\n      <svg class='alert__icon' width='24' height='24'>\n        <use href='public/images/icons.svg#icon-".concat(t,"'></use>\n      </svg>\n      <p class='alert__text'>").concat(e,"</p>"),n.appendChild(r),setTimeout((function(){r.classList.remove("opacity-0"),r.classList.add("opacity-1")}),1),setTimeout((function(){r.classList.remove("opacity-1"),r.classList.add("opacity-0"),r.style.margin=0,r.style.padding=0}),2e3),setTimeout((function(){r.style.setProperty("height","0","important")}),2100),setTimeout((function(){n.removeChild(r)}),2700)}}],null&&Rt(t.prototype,null),e&&Rt(t,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function Ft(t){0===window.scrollY?t.style.display="none":t.style.display="flex"}function qt(t,e){var n="".concat(t,"\n ").concat(e),r="".concat("https://api.telegram.org/bot6783193870:AAFErAKaDxaMZtLxgs6vMkGdr9bP_NvigEA/sendMessage","?chat_id=").concat("516789573","&text=").concat(n),i=new XMLHttpRequest;i.open("GET",r),i.send()}function zt(t){return zt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zt(t)}function Bt(){Bt=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,i=Object.defineProperty||function(t,e,n){t[e]=n.value},o="function"==typeof Symbol?Symbol:{},s=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function u(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,n){return t[e]=n}}function l(t,e,n,r){var o=e&&e.prototype instanceof v?e:v,s=Object.create(o.prototype),a=new L(r||[]);return i(s,"_invoke",{value:I(t,n,a)}),s}function h(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var d="suspendedStart",f="suspendedYield",p="executing",m="completed",y={};function v(){}function g(){}function _(){}var b={};u(b,s,(function(){return this}));var w=Object.getPrototypeOf,C=w&&w(w(N([])));C&&C!==n&&r.call(C,s)&&(b=C);var E=_.prototype=v.prototype=Object.create(b);function S(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function k(t,e){function n(i,o,s,a){var c=h(t[i],t,o);if("throw"!==c.type){var u=c.arg,l=u.value;return l&&"object"==zt(l)&&r.call(l,"__await")?e.resolve(l.__await).then((function(t){n("next",t,s,a)}),(function(t){n("throw",t,s,a)})):e.resolve(l).then((function(t){u.value=t,s(u)}),(function(t){return n("throw",t,s,a)}))}a(c.arg)}var o;i(this,"_invoke",{value:function(t,r){function i(){return new e((function(e,i){n(t,r,e,i)}))}return o=o?o.then(i,i):i()}})}function I(e,n,r){var i=d;return function(o,s){if(i===p)throw Error("Generator is already running");if(i===m){if("throw"===o)throw s;return{value:t,done:!0}}for(r.method=o,r.arg=s;;){var a=r.delegate;if(a){var c=T(a,r);if(c){if(c===y)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(i===d)throw i=m,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i=p;var u=h(e,n,r);if("normal"===u.type){if(i=r.done?m:f,u.arg===y)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(i=m,r.method="throw",r.arg=u.arg)}}}function T(e,n){var r=n.method,i=e.iterator[r];if(i===t)return n.delegate=null,"throw"===r&&e.iterator.return&&(n.method="return",n.arg=t,T(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),y;var o=h(i,e.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,y;var s=o.arg;return s?s.done?(n[e.resultName]=s.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,y):s:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,y)}function x(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function P(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function L(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(x,this),this.reset(!0)}function N(e){if(e||""===e){var n=e[s];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,o=function n(){for(;++i<e.length;)if(r.call(e,i))return n.value=e[i],n.done=!1,n;return n.value=t,n.done=!0,n};return o.next=o}}throw new TypeError(zt(e)+" is not iterable")}return g.prototype=_,i(E,"constructor",{value:_,configurable:!0}),i(_,"constructor",{value:g,configurable:!0}),g.displayName=u(_,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,_):(t.__proto__=_,u(t,c,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},S(k.prototype),u(k.prototype,a,(function(){return this})),e.AsyncIterator=k,e.async=function(t,n,r,i,o){void 0===o&&(o=Promise);var s=new k(l(t,n,r,i),o);return e.isGeneratorFunction(n)?s:s.next().then((function(t){return t.done?t.value:s.next()}))},S(E),u(E,c,"Generator"),u(E,s,(function(){return this})),u(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},e.values=N,L.prototype={constructor:L,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(P),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function i(r,i){return a.type="throw",a.arg=e,n.next=r,i&&(n.method="next",n.arg=t),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var s=this.tryEntries[o],a=s.completion;if("root"===s.tryLoc)return i("end");if(s.tryLoc<=this.prev){var c=r.call(s,"catchLoc"),u=r.call(s,"finallyLoc");if(c&&u){if(this.prev<s.catchLoc)return i(s.catchLoc,!0);if(this.prev<s.finallyLoc)return i(s.finallyLoc)}else if(c){if(this.prev<s.catchLoc)return i(s.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return i(s.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=t,s.arg=e,o?(this.method="next",this.next=o.finallyLoc,y):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),P(n),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;P(n)}return i}}throw Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:N(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),y}},e}function Ut(t,e,n,r,i,o,s){try{var a=t[o](s),c=a.value}catch(t){return void n(t)}a.done?e(c):Promise.resolve(c).then(r,i)}function Wt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Ht(r.key),r)}}function Ht(t){var e=function(t,e){if("object"!=zt(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!=zt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==zt(e)?e:e+""}var Vt=function(){return t=function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.form=e,this.modal=n,this.selected=new Dt,this.inputs=this.form.querySelectorAll("input"),this.btnSubmit=this.form.querySelector("button"),this.error=this.form.querySelector(".error"),this.setupEventListeners()},e=[{key:"setupEventListeners",value:function(){var t=this;this.inputs.forEach((function(e){e.addEventListener("input",(function(){return t.handleInput(e)}))})),this.btnSubmit.addEventListener("click",(function(e){return t.handleSubmit(e)}))}},{key:"handleInput",value:function(t){"tel"===t.type&&this.handleInputTel(t)}},{key:"handleInputTel",value:function(t){t.value=this.formatPhoneNumber(t.value),this.moveCursor(t)}},{key:"moveCursor",value:function(t){var e=t.selectionStart;t.setSelectionRange(e+1,e+1)}},{key:"formatPhoneNumber",value:function(t){var e=t.replace(/\D/g,"").match(/^(\d{0,2})?(\d{0,3})?(\d{0,2})?(\d{0,2})?(\d{0,3})?/);return[e[1]?"+":"",e[1],e[2]?" ":"",e[2],e[3]?" ":"",e[3],e[4]?" ":"",e[4],e[5]?" ":"",e[5]].join("")}},{key:"handleSubmit",value:function(t){t.preventDefault(),this.modal?this.handleModalOrder():this.handleNonModalOrder()}},{key:"handleModalOrder",value:function(){var t=this.getOrderData(),e=this.getBasketText(),n=this.generateOrderDataText(t),r="".concat(n,"\n ").concat(e);this.validateInputs()||(this.sendMessageTelegram(r),this.modal.close(),this.modal.clearBasket(),this.clearForm())}},{key:"handleNonModalOrder",value:function(){var t=this.validateInputs(),e=this.getContactData(),n="Заявка на дзвінок!\n Ім'я: ".concat(e.name,",\n Телефон: ").concat(e.phone);t||(this.sendMessageTelegram(n),this.clearForm())}},{key:"sendMessageTelegram",value:(n=Bt().mark((function t(e){var n;return Bt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,fetch("https://api.telegram.org/bot7032020880:AAHpDjhMn7lO69VbuLtisQZL0mzFA6eTwOM/sendMessage",{method:"POST",headers:{"Content-Type":"application/json;charset=utf-8"},body:JSON.stringify({chat_id:"-4234961860",text:e,disable_notification:!0})});case 3:if((n=t.sent).ok){t.next=6;break}throw new Error(n.statusText);case 6:jt.createAlert("ok","Дякуємо за вашу заявку!"),t.next=13;break;case 9:t.prev=9,t.t0=t.catch(0),qt(t.t0,"Заявка не відправлена!"),jt.createAlert("error","Заявка не відправлена! Спробуйте пізніше.");case 13:case"end":return t.stop()}}),t,null,[[0,9]])})),r=function(){var t=this,e=arguments;return new Promise((function(r,i){var o=n.apply(t,e);function s(t){Ut(o,r,i,s,a,"next",t)}function a(t){Ut(o,r,i,s,a,"throw",t)}s(void 0)}))},function(t){return r.apply(this,arguments)})},{key:"getOrderData",value:function(){return{firstName:this.inputs[0].value,name:this.inputs[1].value,phone:this.inputs[2].value,delivery:this.getSelectedRadioValue(),address:this.inputs[6].value,payment:this.getPaymentValue()}}},{key:"getPaymentValue",value:function(){return this.selected.selectedValue}},{key:"getContactData",value:function(){return{name:this.inputs[0].value,phone:this.inputs[1].value}}},{key:"getBasketText",value:function(){return(this.modal?this.modal.basket.getBasket():[]).map((function(t,e){return"\n        Товар ".concat(e+1,":\n        Назва: ").concat(t.name,",\n        Код товара: ").concat(t.code,",\n        Розмір: ").concat(t.size,",\n        Кількість: ").concat(t.quantity,",\n        Сума за товар ").concat(e+1,": ").concat(t.price*t.quantity," грн.\n      ")})).join("")}},{key:"getSelectedRadioValue",value:function(){var t=this.form.querySelector('input[type="radio"]:checked');return t?t.value:""}},{key:"generateOrderDataText",value:function(t){return"\n      Замовлення! \n      ".concat(t.firstName," ").concat(t.name,",\n      телефон: ").concat(t.phone,", \n      спосіб доставки: ").concat(t.delivery,",\n      адрес: ").concat(t.address,",\n      спосіб оплати: ").concat(t.payment,".\n    ")}},{key:"validateInputs",value:function(){var t=this,e=!1;return this.inputs.forEach((function(n){Pt.isEmpty(n.value)?n.classList.contains("phone")?Pt.isPhoneNumber(n.value)||(t.handleInputError(n,"Будь ласка введіть дійсний номер телефону!"),e=!0):n.classList.contains("first-name")?Pt.isNameValid(n.value)||(t.handleInputError(n,"Введіть коректне призвіще!"),e=!0):n.classList.contains("name")&&(Pt.isNameValid(n.value)||(t.handleInputError(n,"Введіть коректне ім’я!"),e=!0)):(t.handleInputError(n,"Заповніть всі поля!"),e=!0)})),e}},{key:"handleInputError",value:function(t,e){var n,r,i=this,o=t.getAttribute("id");n=o,(r=document.getElementById(n))&&r.classList.add("bounce"),this.error.innerText=e,setTimeout((function(){!function(t,e){var n=document.getElementById(t);n&&n.classList.remove("bounce")}(o),i.error.innerText=""}),2e3)}},{key:"clearForm",value:function(){var t=this;this.inputs.forEach((function(e){"radio"===e.type?e.value===t.form.querySelector('input[type="radio"]:checked')&&(e.checked=!0):e.value=""}))}}],e&&Wt(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n,r}();function Gt(t){return Gt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Gt(t)}function $t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Yt(r.key),r)}}function Yt(t){var e=function(t,e){if("object"!=Gt(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!=Gt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Gt(e)?e:e+""}function Kt(t,e,n){return e=Xt(e),function(t,e){if(e&&("object"===Gt(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Qt()?Reflect.construct(e,n||[],Xt(t).constructor):e.apply(t,n))}function Qt(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(Qt=function(){return!!t})()}function Jt(){return Jt="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Xt(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Jt.apply(this,arguments)}function Xt(t){return Xt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Xt(t)}function Zt(t,e){return Zt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Zt(t,e)}var te=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=Kt(this,e,["#modal-basket","#close-basket"])).counterFab=document.getElementById("basket-count"),n.sumElement=document.querySelectorAll(".sum"),n.modalContent=document.getElementById("modal-basket").childNodes,n.basket=t,n.setupEventListeners(),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Zt(t,e)}(e,t),n=e,(r=[{key:"openWithBasket",value:function(t,e,n,r,i,o){this.basket.addProductToBasket(t,e,n,r,i,o),this.updateFabCounter(),this.openBasket()}},{key:"setupEventListeners",value:function(){Jt(Xt(e.prototype),"setupEventListeners",this).call(this),this.setupBasketButtonListeners()}},{key:"setupBasketButtonListeners",value:function(){var t=this;ht(this.modalContent,"click").pipe(wt((function(t){t.stopPropagation()}))).subscribe(),ht(document.querySelector("#basket"),"click").subscribe((function(){return t.handleClickFab()}))}},{key:"setupBasketItemListeners",value:function(){var t=this;document.querySelectorAll(".basket__value").forEach((function(e,n){e.addEventListener("blur",(function(){""!==e.value.trim()&&"0"!==e.value.trim()||(e.value="1")})),e.addEventListener("input",(function(){e.value.length>3&&(e.value=e.value.slice(0,3)),t.handleInputValue(event,n,e.value)}))})),document.querySelectorAll(".basket-plus").forEach((function(e,n){e.addEventListener("click",(function(e){return t.handleIncrement(e,n)}))})),document.querySelectorAll(".basket-minus").forEach((function(e,n){e.addEventListener("click",(function(e){return t.handleDecrement(e,n)}))})),document.querySelectorAll(".basket__delete").forEach((function(e,n){e.addEventListener("click",(function(e){return t.handleDeleteProduct(e,n)}))}))}},{key:"handleClickFab",value:function(){this.openBasket()}},{key:"openBasket",value:function(){this.updateTotalSum(),this.open(),this.basket.renderBasket(),this.updateProductSums(),this.setupBasketItemListeners(),new Vt(document.querySelector(".order"),this)}},{key:"updateTotalSum",value:function(){var t=this;this.sumElement.forEach((function(e){e.textContent=" ".concat(t.basket.getSumBasket()," грн")}))}},{key:"updateProductSums",value:function(){var t=this;document.querySelectorAll(".basket__item").forEach((function(e,n){t.updateProductSum(n,e)}))}},{key:"updateProductSum",value:function(t,e){e.querySelector(".basket__price").innerText="".concat(this.basket.getSumProduct(t)," грн")}},{key:"handleInputValue",value:function(t,e,n){var r=t.target.parentNode;this.basket.changeQuantity(e,parseInt(n)),this.updateProductSum(e,r.parentNode),this.updateTotalSum(),this.updateFabCounter()}},{key:"handleIncrement",value:function(t,e){var n=t.target.parentNode,r=n.querySelector(".basket__value"),i=this.basket.basket[e].quantity+=1;i=Math.min(i,999),this.basket.changeQuantity(e,i),r.value=i,this.updateProductSum(e,n.parentNode),this.updateTotalSum(),this.updateFabCounter()}},{key:"handleDecrement",value:function(t,e){var n=t.target.parentNode,r=n.querySelector(".basket__value"),i=this.basket.basket[e].quantity-=1;i=Math.max(i,1),this.basket.changeQuantity(e,i),r.value=i,this.updateProductSum(e,n.parentNode),this.updateTotalSum(),this.updateFabCounter()}},{key:"handleDeleteProduct",value:function(t,e){this.basket.deleteProduct(e),this.removeItemProduct(e),0===this.basket.basket.length?(this.close(),this.updateFabCounter(),this.basket.basketFab.style.display="none"):this.updateBasketUI()}},{key:"removeItemProduct",value:function(t){var e=document.querySelector(".basket__item:nth-child(".concat(t+1,")"));e?(e.classList.add("fade-out"),setTimeout((function(){e.remove()}),500)):this.close()}},{key:"clearBasket",value:function(){this.basket.clearBasket()}},{key:"updateFabCounter",value:function(){this.counterFab.innerText=this.basket.getQuantity()}},{key:"updateBasketUI",value:function(){this.updateTotalSum(),this.updateFabCounter()}}])&&$t(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r}(kt);function ee(t){return ee="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ee(t)}function ne(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,re(r.key),r)}}function re(t){var e=function(t,e){if("object"!=ee(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!=ee(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==ee(e)?e:e+""}var ie=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.counterInput=document.getElementById("order-counter"),this.incrementBtn=document.querySelector(".product-plus"),this.decrementBtn=document.querySelector(".product-minus"),this.counterInputValue=1},(e=[{key:"setupEventListeners",value:function(){var t=this;this.counterInput.addEventListener("blur",(function(){""!==t.counterInput.value.trim()&&"0"!==t.counterInput.value.trim()||(t.counterInput.value="1")})),this.counterInput.addEventListener("input",(function(){t.counterInput.value.length>3&&(t.counterInput.value=t.counterInput.value.slice(0,3)),t.handleInputValue(parseInt(t.counterInput.value)),t.counterInputValue=parseInt(t.counterInput.value)})),ht(this.incrementBtn,"click").subscribe((function(){return t.incrementCounter()})),ht(this.decrementBtn,"click").subscribe((function(){return t.decrementCounter()}))}},{key:"handleInputValue",value:function(t){""===t||t<1?(this.counterInput.value=1,this.counterInputValue=1):t>999&&(this.counterInput.value=999,this.counterInputValue=999)}},{key:"incrementCounter",value:function(){this.counterInputValue=Math.min(this.counterInputValue+1,999),this.counterInput.value=this.counterInputValue}},{key:"decrementCounter",value:function(){this.counterInputValue=Math.max(this.counterInputValue-1,1),this.counterInput.value=this.counterInputValue}},{key:"resetCounter",value:function(){this.counterInput.value=1,this.counterInputValue=1}}])&&ne(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function oe(t){return oe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},oe(t)}function se(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,ae(r.key),r)}}function ae(t){var e=function(t,e){if("object"!=oe(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!=oe(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==oe(e)?e:e+""}var ce=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.description=null},(e=[{key:"render",value:function(t){this.remove();var e=this.createDescription(t);document.querySelector(".modal__description").appendChild(e)}},{key:"createDescription",value:function(t){var e=this.createDescriptionElement();return this.description=e,this.renderCompectationContent(e,t.description),e}},{key:"createDescriptionElement",value:function(){var t=document.createElement("div");return t.classList.add("product"),t}},{key:"renderCompectationContent",value:function(t,e){e&&(this.appendTitle(t,e.title),this.appendText(t,e.text),this.appendFeatures(t,e.features),this.appendComplectation(t,e.accessories),this.appendDescriptionElement(t,e.matter,"Матеріал основи"),this.appendDescriptionElement(t,e.secondMatter,"Матеріал тарілок і ковпака"),this.appendDescriptionElement(t,e.color,"Колір"),this.appendDescriptionElement(t,e.application,"Застосування"),this.appendAdvantages(t,e.advantages),this.appendList(t,e.size),this.appendInstruction(t,e.instruction),this.appendCharacteristics(t,e.dimensionsFolded,"Габаритні розміри в складеному стані"),this.appendCharacteristics(t,e.dimensionsLaidOut,"Габаритні розміри в розкладеному стані"),this.appendText(t,e.secondText),this.appendCharacteristics(t,e.characteristics,"ХАРАКТЕРИСТИКИ"),this.appendTable(t,e.general))}},{key:"appendFeatures",value:function(t,e){if(e){var n=document.createElement("div"),r=document.createElement("p");r.classList.add("margin","accent"),r.innerText="Особливості:",n.appendChild(r);var i=document.createElement("ul");e.forEach((function(t){var e=document.createElement("li");e.innerText="".concat(t),i.appendChild(e)})),n.appendChild(i),t.appendChild(n)}}},{key:"appendComplectation",value:function(t,e){if(e){var n=document.createElement("p");n.classList.add("margin","accent"),n.textContent="Комплектація:",t.appendChild(n);var r=document.createElement("ul");r.classList.add("list-style","margin--left"),e.forEach((function(t){var e=document.createElement("li");e.textContent=t,r.appendChild(e)})),t.appendChild(r)}}},{key:"appendInstruction",value:function(t,e){if(e){var n=document.createElement("p");n.classList.add("margin","accent"),n.innerText="Інструкція з використання:",t.appendChild(n);var r=document.createElement("ol");r.classList.add("margin"),e.forEach((function(t){var e=document.createElement("li");e.innerText="".concat(t),r.appendChild(e)})),t.appendChild(r)}}},{key:"appendList",value:function(t,e){if(e){var n=document.createElement("ul");e.forEach((function(t){var e=document.createElement("li");e.innerHTML="<p class='margin'><span class='accent'>".concat(t.name,": </span>").concat(t.value,"</p>"),n.appendChild(e)})),t.appendChild(n)}}},{key:"appendDescriptionElement",value:function(t,e,n){if(e){var r=document.createElement("p");r.classList.add("margin"),r.innerHTML="<span class='accent'>".concat(n,": </span>").concat(e),t.appendChild(r)}}},{key:"appendTitle",value:function(t,e){if(e){var n=document.createElement("p");n.classList.add("margin"),e.length>1?n.innerHTML=" <span class='accent'>".concat(e[0],"</span> ").concat(e[1]):(n.classList.add("accent"),n.innerText=e),t.appendChild(n)}}},{key:"appendAdvantages",value:function(t,e){if(e){var n=document.createElement("p");n.classList.add("margin"),n.innerHTML="<span class='accent'>Переваги: </span>".concat(e," "),t.appendChild(n)}}},{key:"appendText",value:function(t,e){var n=this;if(e){var r=document.createElement("div");e.forEach((function(t){var e=document.createElement("p");e.classList.add("margin"),e.innerHTML=n.highlightAttention(t),r.appendChild(e)})),t.appendChild(r)}}},{key:"highlightAttention",value:function(t){return t.includes("Є можливість")?'<span class="accent accent--color-green">'.concat(t,"</span>"):t.split(" ").map((function(t){return"Увага!"===t?'<span class="accent accent--color-red">'.concat(t,"</span>"):t})).join(" ")}},{key:"appendCharacteristics",value:function(t,e,n){if(e){var r=document.createElement("div"),i=document.createElement("p");i.classList.add("accent","margin"),i.innerText="".concat(n,":"),r.appendChild(i);var o=document.createElement("ul");e.forEach((function(t){var e=document.createElement("li");e.innerHTML="<p class='margin'><span class='accent'>".concat(t.name,": </span>").concat(t.value,"</p>"),o.appendChild(e)})),r.appendChild(o),t.appendChild(r)}}},{key:"appendTable",value:function(t,e){if(e){var n=document.createElement("table"),r=document.createElement("tr");["Формат - Об'єм","Діаметр верхній","Діаметр нижній","Вага"].forEach((function(t){var e=document.createElement("th");e.innerText=t,r.appendChild(e)})),n.appendChild(r),e.forEach((function(t){var e=document.createElement("tr");e.innerHTML="\n          <td>".concat(t.format,"</td>\n          <td>").concat(t.diameterTop,"</td>\n          <td>").concat(t.diameterBottom,"</td>\n          <td>").concat(t.weight,"</td>\n        "),n.appendChild(e)})),t.appendChild(n)}}},{key:"remove",value:function(){this.description&&this.description.remove()}}])&&se(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function ue(t){return ue="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ue(t)}function le(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,he(r.key),r)}}function he(t){var e=function(t,e){if("object"!=ue(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!=ue(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==ue(e)?e:e+""}var de=function(){return t=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.gallery=e,this.imagesUrl=[]},(e=[{key:"renderGallery",value:function(t){var e=this,n=this.createContainerSlides("main-carousel"),r=this.createContainerSlides("thumbnail-carousel");return t.imgsUrl.forEach((function(i){e.imagesUrl.push(i),e.createGallerySlide(i,t.name,n.querySelector(".splide__list")),e.createGallerySlide(i,t.name,r.querySelector(".splide__list"))})),this.gallery.appendChild(n),this.gallery.appendChild(r),{splideContainer:n,thumbnailsContainer:r}}},{key:"createContainerSlides",value:function(t){var e=document.createElement("div");e.classList.add("gallery__splide"),e.classList.add("splide"),e.setAttribute("id",t);var n=document.createElement("div");n.classList.add("splide__track");var r=document.createElement("ul");return r.classList.add("splide__list"),n.appendChild(r),e.appendChild(n),e}},{key:"createGallerySlide",value:function(t,e,n){var r=document.createElement("li");r.classList.add("splide__slide"),"thumbnail-carousel"===n.parentNode.parentNode.getAttribute("id")&&r.classList.add("gallery__slide");var i=document.createElement("img");i.src=t,i.alt=e,i.loading="lazy",r.appendChild(i),n.appendChild(r)}}])&&le(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function fe(t){return fe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fe(t)}function pe(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,me(r.key),r)}}function me(t){var e=function(t,e){if("object"!=fe(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!=fe(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==fe(e)?e:e+""}var ye=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)},(e=[{key:"initSlide",value:function(t,e){var n=new Splide(t,{type:"fade",rewind:!0,pagination:!1,arrows:!0,classes:{arrows:"splide__arrows gallery__arrows",arrow:"splide__arrow gallery__arrow",prev:"splide__arrow--prev gallery__prev",next:"splide__arrow--next gallery__next"}}),r=new Splide(e,{fixedWidth:100,gap:10,rewind:!0,pagination:!1,isNavigation:!0,arrows:!1,breakpoints:{600:{fixedWidth:60}}});n.sync(r),n.mount(),r.mount()}}])&&pe(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function ve(t){return ve="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ve(t)}function ge(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,_e(r.key),r)}}function _e(t){var e=function(t,e){if("object"!=ve(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!=ve(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==ve(e)?e:e+""}var be=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.gallery=document.querySelector(".gallery"),this.splideManager=new ye,this.galleryRenderer=new de(this.gallery),this.modalImg=this.galleryRenderer.imagesUrl},(e=[{key:"renderGallery",value:function(t){var e=this.galleryRenderer.renderGallery(t),n=e.splideContainer,r=e.thumbnailsContainer;this.splideManager.initSlide(n,r)}},{key:"removeGallery",value:function(){if(this.gallery){var t=this.gallery.querySelector("#main-carousel"),e=this.gallery.querySelector("#thumbnail-carousel");t&&t.remove(),e&&e.remove(),this.galleryRenderer.imagesUrl=[]}}}])&&ge(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function we(t){return we="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},we(t)}function Ce(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Ee(r.key),r)}}function Ee(t){var e=function(t,e){if("object"!=we(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!=we(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==we(e)?e:e+""}var Se=function(){return t=function t(e,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.modalCodeElement=e,this.modalPriceElement=n,this.onSizeChange=r},(e=[{key:"render",value:function(t){this.remove();var e=this.createSizeListElement(t);document.querySelector(".modal__description").appendChild(e)}},{key:"createSizeListElement",value:function(t){var e=this,n=document.createElement("fieldset");n.classList.add("modal__size-list");var r=document.createElement("legend");return r.classList.add("modal__size-title"),r.textContent=t[0].code.includes("Kaz")?"Об'єм":"Розмір",n.appendChild(r),t.forEach((function(t,r){var i=e.createSizeItemElement(t,r);n.appendChild(i)})),n.addEventListener("change",(function(t){"radio"===t.target.type&&e.handleSizeChange(t)})),n}},{key:"createSizeItemElement",value:function(t,e){var n=document.createElement("div");n.classList.add("modal__size-item","input","input__control");var r=document.createElement("input");r.classList.add("input__radio"),r.type="radio",r.dataset.code=t.code,r.id=t.code,r.dataset.newCost=t.newCost,t.oldCost&&(r.dataset.oldCost=t.oldCost),r.value=t.name,r.name="size";var i=document.createElement("label");return i.setAttribute("for",t.code),i.classList.add("modal__size-item--label"),i.innerText=t.name,n.appendChild(r),n.appendChild(i),0===e&&(r.checked=!0),n}},{key:"handleSizeChange",value:function(t){if("radio"===t.target.type){var e=t.target;this.modalPriceElement.innerHTML='\n        <p class="price__new price__new--modal margin--bottom">'.concat(e.dataset.newCost," грн</p>\n        ").concat(e.dataset.oldCost?'<p class="price__old price__old--modal margin--bottom">'.concat(e.dataset.oldCost," грн</p>"):"","\n      "),this.onSizeChange({code:e.dataset.code,newCost:e.dataset.newCost,oldCost:e.dataset.oldCost,name:e.value})}}},{key:"remove",value:function(){var t=document.querySelector(".modal__size-list");t&&t.remove()}}])&&Ce(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();const ke=function(t,e){if(!t)throw Ie(e)},Ie=function(t){return new Error("Firebase Database (${JSCORE_VERSION}) INTERNAL ASSERT FAILED: "+t)},Te=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=63&i|128):55296==(64512&i)&&r+1<t.length&&56320==(64512&t.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&t.charCodeAt(++r)),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=63&i|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=63&i|128)}return e},xe={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let e=0;e<t.length;e+=3){const i=t[e],o=e+1<t.length,s=o?t[e+1]:0,a=e+2<t.length,c=a?t[e+2]:0,u=i>>2,l=(3&i)<<4|s>>4;let h=(15&s)<<2|c>>6,d=63&c;a||(d=64,o||(h=64)),r.push(n[u],n[l],n[h],n[d])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(Te(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):function(t){const e=[];let n=0,r=0;for(;n<t.length;){const i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){const o=t[n++];e[r++]=String.fromCharCode((31&i)<<6|63&o)}else if(i>239&&i<365){const o=((7&i)<<18|(63&t[n++])<<12|(63&t[n++])<<6|63&t[n++])-65536;e[r++]=String.fromCharCode(55296+(o>>10)),e[r++]=String.fromCharCode(56320+(1023&o))}else{const o=t[n++],s=t[n++];e[r++]=String.fromCharCode((15&i)<<12|(63&o)<<6|63&s)}}return e.join("")}(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let e=0;e<t.length;){const i=n[t.charAt(e++)],o=e<t.length?n[t.charAt(e)]:0;++e;const s=e<t.length?n[t.charAt(e)]:64;++e;const a=e<t.length?n[t.charAt(e)]:64;if(++e,null==i||null==o||null==s||null==a)throw new Pe;const c=i<<2|o>>4;if(r.push(c),64!==s){const t=o<<4&240|s>>2;if(r.push(t),64!==a){const t=s<<6&192|a;r.push(t)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class Pe extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const Le=function(t){const e=Te(t);return xe.encodeByteArray(e,!0)},Ne=function(t){return Le(t).replace(/\./g,"")},Oe=function(t){try{return xe.decodeString(t,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};function De(t){return Ae(void 0,t)}function Ae(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:return new Date(e.getTime());case Object:void 0===t&&(t={});break;case Array:t=[];break;default:return e}for(const n in e)e.hasOwnProperty(n)&&"__proto__"!==n&&(t[n]=Ae(t[n],e[n]));return t}const Re=()=>{try{return function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==t.g)return t.g;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__||(()=>{if("undefined"==typeof document)return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(t){return}const e=t&&Oe(t[1]);return e&&JSON.parse(e)})()}catch(t){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`)}},Me=()=>{var t;return null===(t=Re())||void 0===t?void 0:t.config};class je{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise(((t,e)=>{this.resolve=t,this.reject=e}))}wrapCallback(t){return(e,n)=>{e?this.reject(e):this.resolve(n),"function"==typeof t&&(this.promise.catch((()=>{})),1===t.length?t(e):t(e,n))}}}function Fe(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test("undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:"")}function qe(){try{return"object"==typeof indexedDB}catch(t){return!1}}function ze(){return new Promise(((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var t;e((null===(t=i.error)||void 0===t?void 0:t.message)||"")}}catch(t){e(t)}}))}class Be extends Error{constructor(t,e,n){super(e),this.code=t,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,Be.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Ue.prototype.create)}}class Ue{constructor(t,e,n){this.service=t,this.serviceName=e,this.errors=n}create(t,...e){const n=e[0]||{},r=`${this.service}/${t}`,i=this.errors[t],o=i?function(t,e){return t.replace(We,((t,n)=>{const r=e[n];return null!=r?String(r):`<${n}?>`}))}(i,n):"Error",s=`${this.serviceName}: ${o} (${r}).`;return new Be(r,s,n)}}const We=/\{\$([^}]+)}/g;function He(t){return JSON.parse(t)}function Ve(t){return JSON.stringify(t)}const Ge=function(t){let e={},n={},r={},i="";try{const o=t.split(".");e=He(Oe(o[0])||""),n=He(Oe(o[1])||""),i=o[2],r=n.d||{},delete n.d}catch(t){}return{header:e,claims:n,data:r,signature:i}};function $e(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function Ye(t,e){return Object.prototype.hasOwnProperty.call(t,e)?t[e]:void 0}function Ke(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Qe(t,e,n){const r={};for(const i in t)Object.prototype.hasOwnProperty.call(t,i)&&(r[i]=e.call(n,t[i],i,t));return r}function Je(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const i of n){if(!r.includes(i))return!1;const n=t[i],o=e[i];if(Xe(n)&&Xe(o)){if(!Je(n,o))return!1}else if(n!==o)return!1}for(const t of r)if(!n.includes(t))return!1;return!0}function Xe(t){return null!==t&&"object"==typeof t}class Ze{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(let t=1;t<this.blockSize;++t)this.pad_[t]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(t,e){e||(e=0);const n=this.W_;if("string"==typeof t)for(let r=0;r<16;r++)n[r]=t.charCodeAt(e)<<24|t.charCodeAt(e+1)<<16|t.charCodeAt(e+2)<<8|t.charCodeAt(e+3),e+=4;else for(let r=0;r<16;r++)n[r]=t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3],e+=4;for(let t=16;t<80;t++){const e=n[t-3]^n[t-8]^n[t-14]^n[t-16];n[t]=4294967295&(e<<1|e>>>31)}let r,i,o=this.chain_[0],s=this.chain_[1],a=this.chain_[2],c=this.chain_[3],u=this.chain_[4];for(let t=0;t<80;t++){t<40?t<20?(r=c^s&(a^c),i=1518500249):(r=s^a^c,i=1859775393):t<60?(r=s&a|c&(s|a),i=2400959708):(r=s^a^c,i=3395469782);const e=(o<<5|o>>>27)+r+u+i+n[t]&4294967295;u=c,c=a,a=4294967295&(s<<30|s>>>2),s=o,o=e}this.chain_[0]=this.chain_[0]+o&4294967295,this.chain_[1]=this.chain_[1]+s&4294967295,this.chain_[2]=this.chain_[2]+a&4294967295,this.chain_[3]=this.chain_[3]+c&4294967295,this.chain_[4]=this.chain_[4]+u&4294967295}update(t,e){if(null==t)return;void 0===e&&(e=t.length);const n=e-this.blockSize;let r=0;const i=this.buf_;let o=this.inbuf_;for(;r<e;){if(0===o)for(;r<=n;)this.compress_(t,r),r+=this.blockSize;if("string"==typeof t){for(;r<e;)if(i[o]=t.charCodeAt(r),++o,++r,o===this.blockSize){this.compress_(i),o=0;break}}else for(;r<e;)if(i[o]=t[r],++o,++r,o===this.blockSize){this.compress_(i),o=0;break}}this.inbuf_=o,this.total_+=e}digest(){const t=[];let e=8*this.total_;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let t=this.blockSize-1;t>=56;t--)this.buf_[t]=255&e,e/=256;this.compress_(this.buf_);let n=0;for(let e=0;e<5;e++)for(let r=24;r>=0;r-=8)t[n]=this.chain_[e]>>r&255,++n;return t}}function tn(t,e){return`${t} failed: ${e} argument `}const en=function(t){let e=0;for(let n=0;n<t.length;n++){const r=t.charCodeAt(n);r<128?e++:r<2048?e+=2:r>=55296&&r<=56319?(e+=4,n++):e+=3}return e},nn=1e3,rn=2,on=144e5,sn=.5;function an(t,e=nn,n=rn){const r=e*Math.pow(n,t),i=Math.round(sn*r*(Math.random()-.5)*2);return Math.min(on,r+i)}function cn(t){return t&&t._delegate?t._delegate:t}class un{constructor(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}}const ln="[DEFAULT]";class hn{constructor(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(t){const e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){const t=new je;if(this.instancesDeferred.set(e,t),this.isInitialized(e)||this.shouldAutoInitialize())try{const n=this.getOrInitializeService({instanceIdentifier:e});n&&t.resolve(n)}catch(t){}}return this.instancesDeferred.get(e).promise}getImmediate(t){var e;const n=this.normalizeInstanceIdentifier(null==t?void 0:t.identifier),r=null!==(e=null==t?void 0:t.optional)&&void 0!==e&&e;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(r)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(t){if(r)return null;throw t}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error(`Mismatching Component ${t.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=t,this.shouldAutoInitialize()){if(function(t){return"EAGER"===t.instantiationMode}(t))try{this.getOrInitializeService({instanceIdentifier:ln})}catch(t){}for(const[t,e]of this.instancesDeferred.entries()){const n=this.normalizeInstanceIdentifier(t);try{const t=this.getOrInitializeService({instanceIdentifier:n});e.resolve(t)}catch(t){}}}}clearInstance(t=ln){this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}async delete(){const t=Array.from(this.instances.values());await Promise.all([...t.filter((t=>"INTERNAL"in t)).map((t=>t.INTERNAL.delete())),...t.filter((t=>"_delete"in t)).map((t=>t._delete()))])}isComponentSet(){return null!=this.component}isInitialized(t=ln){return this.instances.has(t)}getOptions(t=ln){return this.instancesOptions.get(t)||{}}initialize(t={}){const{options:e={}}=t,n=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:n,options:e});for(const[t,e]of this.instancesDeferred.entries())n===this.normalizeInstanceIdentifier(t)&&e.resolve(r);return r}onInit(t,e){var n;const r=this.normalizeInstanceIdentifier(e),i=null!==(n=this.onInitCallbacks.get(r))&&void 0!==n?n:new Set;i.add(t),this.onInitCallbacks.set(r,i);const o=this.instances.get(r);return o&&t(o,r),()=>{i.delete(t)}}invokeOnInitCallbacks(t,e){const n=this.onInitCallbacks.get(e);if(n)for(const r of n)try{r(t,e)}catch(t){}}getOrInitializeService({instanceIdentifier:t,options:e={}}){let n=this.instances.get(t);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:(r=t,r===ln?void 0:r),options:e}),this.instances.set(t,n),this.instancesOptions.set(t,e),this.invokeOnInitCallbacks(n,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,n)}catch(t){}var r;return n||null}normalizeInstanceIdentifier(t=ln){return this.component?this.component.multipleInstances?t:ln:t}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class dn{constructor(t){this.name=t,this.providers=new Map}addComponent(t){const e=this.getProvider(t.name);if(e.isComponentSet())throw new Error(`Component ${t.name} has already been registered with ${this.name}`);e.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);const e=new hn(t,this);return this.providers.set(t,e),e}getProviders(){return Array.from(this.providers.values())}}const fn=[];var pn;!function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"}(pn||(pn={}));const mn={debug:pn.DEBUG,verbose:pn.VERBOSE,info:pn.INFO,warn:pn.WARN,error:pn.ERROR,silent:pn.SILENT},yn=pn.INFO,vn={[pn.DEBUG]:"log",[pn.VERBOSE]:"log",[pn.INFO]:"info",[pn.WARN]:"warn",[pn.ERROR]:"error"},gn=(t,e,...n)=>{if(e<t.logLevel)return;const r=(new Date).toISOString(),i=vn[e];if(!i)throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`);console[i](`[${r}]  ${t.name}:`,...n)};class _n{constructor(t){this.name=t,this._logLevel=yn,this._logHandler=gn,this._userLogHandler=null,fn.push(this)}get logLevel(){return this._logLevel}set logLevel(t){if(!(t in pn))throw new TypeError(`Invalid value "${t}" assigned to \`logLevel\``);this._logLevel=t}setLogLevel(t){this._logLevel="string"==typeof t?mn[t]:t}get logHandler(){return this._logHandler}set logHandler(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t}get userLogHandler(){return this._userLogHandler}set userLogHandler(t){this._userLogHandler=t}debug(...t){this._userLogHandler&&this._userLogHandler(this,pn.DEBUG,...t),this._logHandler(this,pn.DEBUG,...t)}log(...t){this._userLogHandler&&this._userLogHandler(this,pn.VERBOSE,...t),this._logHandler(this,pn.VERBOSE,...t)}info(...t){this._userLogHandler&&this._userLogHandler(this,pn.INFO,...t),this._logHandler(this,pn.INFO,...t)}warn(...t){this._userLogHandler&&this._userLogHandler(this,pn.WARN,...t),this._logHandler(this,pn.WARN,...t)}error(...t){this._userLogHandler&&this._userLogHandler(this,pn.ERROR,...t),this._logHandler(this,pn.ERROR,...t)}}const bn=(t,e)=>e.some((e=>t instanceof e));let wn,Cn;const En=new WeakMap,Sn=new WeakMap,kn=new WeakMap,In=new WeakMap,Tn=new WeakMap;let xn={get(t,e,n){if(t instanceof IDBTransaction){if("done"===e)return Sn.get(t);if("objectStoreNames"===e)return t.objectStoreNames||kn.get(t);if("store"===e)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Ln(t[e])},set:(t,e,n)=>(t[e]=n,!0),has:(t,e)=>t instanceof IDBTransaction&&("done"===e||"store"===e)||e in t};function Pn(t){return"function"==typeof t?(e=t)!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(Cn||(Cn=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(...t){return e.apply(Nn(this),t),Ln(En.get(this))}:function(...t){return Ln(e.apply(Nn(this),t))}:function(t,...n){const r=e.call(Nn(this),t,...n);return kn.set(r,t.sort?t.sort():[t]),Ln(r)}:(t instanceof IDBTransaction&&function(t){if(Sn.has(t))return;const e=new Promise(((e,n)=>{const r=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",o),t.removeEventListener("abort",o)},i=()=>{e(),r()},o=()=>{n(t.error||new DOMException("AbortError","AbortError")),r()};t.addEventListener("complete",i),t.addEventListener("error",o),t.addEventListener("abort",o)}));Sn.set(t,e)}(t),bn(t,wn||(wn=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(t,xn):t);var e}function Ln(t){if(t instanceof IDBRequest)return function(t){const e=new Promise(((e,n)=>{const r=()=>{t.removeEventListener("success",i),t.removeEventListener("error",o)},i=()=>{e(Ln(t.result)),r()},o=()=>{n(t.error),r()};t.addEventListener("success",i),t.addEventListener("error",o)}));return e.then((e=>{e instanceof IDBCursor&&En.set(e,t)})).catch((()=>{})),Tn.set(e,t),e}(t);if(In.has(t))return In.get(t);const e=Pn(t);return e!==t&&(In.set(t,e),Tn.set(e,t)),e}const Nn=t=>Tn.get(t);function On(t,e,{blocked:n,upgrade:r,blocking:i,terminated:o}={}){const s=indexedDB.open(t,e),a=Ln(s);return r&&s.addEventListener("upgradeneeded",(t=>{r(Ln(s.result),t.oldVersion,t.newVersion,Ln(s.transaction),t)})),n&&s.addEventListener("blocked",(t=>n(t.oldVersion,t.newVersion,t))),a.then((t=>{o&&t.addEventListener("close",(()=>o())),i&&t.addEventListener("versionchange",(t=>i(t.oldVersion,t.newVersion,t)))})).catch((()=>{})),a}const Dn=["get","getKey","getAll","getAllKeys","count"],An=["put","add","delete","clear"],Rn=new Map;function Mn(t,e){if(!(t instanceof IDBDatabase)||e in t||"string"!=typeof e)return;if(Rn.get(e))return Rn.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,i=An.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!i&&!Dn.includes(n))return;const o=async function(t,...e){const o=this.transaction(t,i?"readwrite":"readonly");let s=o.store;return r&&(s=s.index(e.shift())),(await Promise.all([s[n](...e),i&&o.done]))[0]};return Rn.set(e,o),o}var jn;jn=xn,xn={...jn,get:(t,e,n)=>Mn(t,e)||jn.get(t,e,n),has:(t,e)=>!!Mn(t,e)||jn.has(t,e)};class Fn{constructor(t){this.container=t}getPlatformInfoString(){return this.container.getProviders().map((t=>{if(function(t){const e=t.getComponent();return"VERSION"===(null==e?void 0:e.type)}(t)){const e=t.getImmediate();return`${e.library}/${e.version}`}return null})).filter((t=>t)).join(" ")}}const qn="@firebase/app",zn="0.10.5",Bn=new _n("@firebase/app"),Un="@firebase/app-compat",Wn="@firebase/analytics-compat",Hn="@firebase/analytics",Vn="@firebase/app-check-compat",Gn="@firebase/app-check",$n="@firebase/auth",Yn="@firebase/auth-compat",Kn="@firebase/database",Qn="@firebase/database-compat",Jn="@firebase/functions",Xn="@firebase/functions-compat",Zn="@firebase/installations",tr="@firebase/installations-compat",er="@firebase/messaging",nr="@firebase/messaging-compat",rr="@firebase/performance",ir="@firebase/performance-compat",or="@firebase/remote-config",sr="@firebase/remote-config-compat",ar="@firebase/storage",cr="@firebase/storage-compat",ur="@firebase/firestore",lr="@firebase/vertexai-preview",hr="@firebase/firestore-compat",dr="firebase",fr="[DEFAULT]",pr={[qn]:"fire-core",[Un]:"fire-core-compat",[Hn]:"fire-analytics",[Wn]:"fire-analytics-compat",[Gn]:"fire-app-check",[Vn]:"fire-app-check-compat",[$n]:"fire-auth",[Yn]:"fire-auth-compat",[Kn]:"fire-rtdb",[Qn]:"fire-rtdb-compat",[Jn]:"fire-fn",[Xn]:"fire-fn-compat",[Zn]:"fire-iid",[tr]:"fire-iid-compat",[er]:"fire-fcm",[nr]:"fire-fcm-compat",[rr]:"fire-perf",[ir]:"fire-perf-compat",[or]:"fire-rc",[sr]:"fire-rc-compat",[ar]:"fire-gcs",[cr]:"fire-gcs-compat",[ur]:"fire-fst",[hr]:"fire-fst-compat",[lr]:"fire-vertex","fire-js":"fire-js",[dr]:"fire-js-all"},mr=new Map,yr=new Map,vr=new Map;function gr(t,e){try{t.container.addComponent(e)}catch(n){Bn.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function _r(t){const e=t.name;if(vr.has(e))return Bn.debug(`There were multiple attempts to register component ${e}.`),!1;vr.set(e,t);for(const e of mr.values())gr(e,t);for(const e of yr.values())gr(e,t);return!0}function br(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}const wr=new Ue("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."});class Cr{constructor(t,e,n){this._isDeleted=!1,this._options=Object.assign({},t),this._config=Object.assign({},e),this._name=e.name,this._automaticDataCollectionEnabled=e.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new un("app",(()=>this),"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(t){this._isDeleted=t}checkDestroyed(){if(this.isDeleted)throw wr.create("app-deleted",{appName:this._name})}}function Er(t,e={}){let n=t;"object"!=typeof e&&(e={name:e});const r=Object.assign({name:fr,automaticDataCollectionEnabled:!1},e),i=r.name;if("string"!=typeof i||!i)throw wr.create("bad-app-name",{appName:String(i)});if(n||(n=Me()),!n)throw wr.create("no-options");const o=mr.get(i);if(o){if(Je(n,o.options)&&Je(r,o.config))return o;throw wr.create("duplicate-app",{appName:i})}const s=new dn(i);for(const t of vr.values())s.addComponent(t);const a=new Cr(n,r,s);return mr.set(i,a),a}function Sr(t=fr){const e=mr.get(t);if(!e&&t===fr&&Me())return Er();if(!e)throw wr.create("no-app",{appName:t});return e}function kr(t,e,n){var r;let i=null!==(r=pr[t])&&void 0!==r?r:t;n&&(i+=`-${n}`);const o=i.match(/\s|\//),s=e.match(/\s|\//);if(o||s){const t=[`Unable to register library "${i}" with version "${e}":`];return o&&t.push(`library name "${i}" contains illegal characters (whitespace or "/")`),o&&s&&t.push("and"),s&&t.push(`version name "${e}" contains illegal characters (whitespace or "/")`),void Bn.warn(t.join(" "))}_r(new un(`${i}-version`,(()=>({library:i,version:e})),"VERSION"))}const Ir="firebase-heartbeat-database",Tr=1,xr="firebase-heartbeat-store";let Pr=null;function Lr(){return Pr||(Pr=On(Ir,Tr,{upgrade:(t,e)=>{if(0===e)try{t.createObjectStore(xr)}catch(t){console.warn(t)}}}).catch((t=>{throw wr.create("idb-open",{originalErrorMessage:t.message})}))),Pr}async function Nr(t,e){try{const n=(await Lr()).transaction(xr,"readwrite"),r=n.objectStore(xr);await r.put(e,Or(t)),await n.done}catch(t){if(t instanceof Be)Bn.warn(t.message);else{const e=wr.create("idb-set",{originalErrorMessage:null==t?void 0:t.message});Bn.warn(e.message)}}}function Or(t){return`${t.name}!${t.options.appId}`}class Dr{constructor(t){this.container=t,this._heartbeatsCache=null;const e=this.container.getProvider("app").getImmediate();this._storage=new Rr(e),this._heartbeatsCachePromise=this._storage.read().then((t=>(this._heartbeatsCache=t,t)))}async triggerHeartbeat(){var t,e;const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=Ar();if((null!=(null===(t=this._heartbeatsCache)||void 0===t?void 0:t.heartbeats)||(this._heartbeatsCache=await this._heartbeatsCachePromise,null!=(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)))&&this._heartbeatsCache.lastSentHeartbeatDate!==r&&!this._heartbeatsCache.heartbeats.some((t=>t.date===r)))return this._heartbeatsCache.heartbeats.push({date:r,agent:n}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter((t=>{const e=new Date(t.date).valueOf();return Date.now()-e<=2592e6})),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){var t;if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,null==(null===(t=this._heartbeatsCache)||void 0===t?void 0:t.heartbeats)||0===this._heartbeatsCache.heartbeats.length)return"";const e=Ar(),{heartbeatsToSend:n,unsentEntries:r}=function(t,e=1024){const n=[];let r=t.slice();for(const i of t){const t=n.find((t=>t.agent===i.agent));if(t){if(t.dates.push(i.date),Mr(n)>e){t.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),Mr(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}(this._heartbeatsCache.heartbeats),i=Ne(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=e,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}}function Ar(){return(new Date).toISOString().substring(0,10)}class Rr{constructor(t){this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!qe()&&ze().then((()=>!0)).catch((()=>!1))}async read(){if(await this._canUseIndexedDBPromise){const t=await async function(t){try{const e=(await Lr()).transaction(xr),n=await e.objectStore(xr).get(Or(t));return await e.done,n}catch(t){if(t instanceof Be)Bn.warn(t.message);else{const e=wr.create("idb-get",{originalErrorMessage:null==t?void 0:t.message});Bn.warn(e.message)}}}(this.app);return(null==t?void 0:t.heartbeats)?t:{heartbeats:[]}}return{heartbeats:[]}}async overwrite(t){var e;if(await this._canUseIndexedDBPromise){const n=await this.read();return Nr(this.app,{lastSentHeartbeatDate:null!==(e=t.lastSentHeartbeatDate)&&void 0!==e?e:n.lastSentHeartbeatDate,heartbeats:t.heartbeats})}}async add(t){var e;if(await this._canUseIndexedDBPromise){const n=await this.read();return Nr(this.app,{lastSentHeartbeatDate:null!==(e=t.lastSentHeartbeatDate)&&void 0!==e?e:n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...t.heartbeats]})}}}function Mr(t){return Ne(JSON.stringify({version:2,heartbeats:t})).length}_r(new un("platform-logger",(t=>new Fn(t)),"PRIVATE")),_r(new un("heartbeat",(t=>new Dr(t)),"PRIVATE")),kr(qn,zn,""),kr(qn,zn,"esm2017"),kr("fire-js","");const jr="@firebase/database",Fr="1.0.5";let qr="";class zr{constructor(t){this.domStorage_=t,this.prefix_="firebase:"}set(t,e){null==e?this.domStorage_.removeItem(this.prefixedName_(t)):this.domStorage_.setItem(this.prefixedName_(t),Ve(e))}get(t){const e=this.domStorage_.getItem(this.prefixedName_(t));return null==e?null:He(e)}remove(t){this.domStorage_.removeItem(this.prefixedName_(t))}prefixedName_(t){return this.prefix_+t}toString(){return this.domStorage_.toString()}}class Br{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(t,e){null==e?delete this.cache_[t]:this.cache_[t]=e}get(t){return $e(this.cache_,t)?this.cache_[t]:null}remove(t){delete this.cache_[t]}}const Ur=function(t){try{if("undefined"!=typeof window&&void 0!==window[t]){const e=window[t];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new zr(e)}}catch(t){}return new Br},Wr=Ur("localStorage"),Hr=Ur("sessionStorage"),Vr=new _n("@firebase/database"),Gr=function(){let t=1;return function(){return t++}}(),$r=function(t){const e=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let i=t.charCodeAt(r);if(i>=55296&&i<=56319){const e=i-55296;r++,ke(r<t.length,"Surrogate pair missing trail surrogate."),i=65536+(e<<10)+(t.charCodeAt(r)-56320)}i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=63&i|128):i<65536?(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=63&i|128):(e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=63&i|128)}return e}(t),n=new Ze;n.update(e);const r=n.digest();return xe.encodeByteArray(r)},Yr=function(...t){let e="";for(let n=0;n<t.length;n++){const r=t[n];Array.isArray(r)||r&&"object"==typeof r&&"number"==typeof r.length?e+=Yr.apply(null,r):e+="object"==typeof r?Ve(r):r,e+=" "}return e};let Kr=null,Qr=!0;const Jr=function(...t){if(!0===Qr&&(Qr=!1,null===Kr&&!0===Hr.get("logging_enabled")&&(e=!0,ke(!n||!0===e||!1===e,"Can't turn on custom loggers persistently."),!0===e?(Vr.logLevel=pn.VERBOSE,Kr=Vr.log.bind(Vr),n&&Hr.set("logging_enabled",!0)):"function"==typeof e?Kr=e:(Kr=null,Hr.remove("logging_enabled")))),Kr){const e=Yr.apply(null,t);Kr(e)}var e,n},Xr=function(t){return function(...e){Jr(t,...e)}},Zr=function(...t){const e="FIREBASE INTERNAL ERROR: "+Yr(...t);Vr.error(e)},ti=function(...t){const e=`FIREBASE FATAL ERROR: ${Yr(...t)}`;throw Vr.error(e),new Error(e)},ei=function(...t){const e="FIREBASE WARNING: "+Yr(...t);Vr.warn(e)},ni=function(t){return"number"==typeof t&&(t!=t||t===Number.POSITIVE_INFINITY||t===Number.NEGATIVE_INFINITY)},ri="[MIN_NAME]",ii="[MAX_NAME]",oi=function(t,e){if(t===e)return 0;if(t===ri||e===ii)return-1;if(e===ri||t===ii)return 1;{const n=fi(t),r=fi(e);return null!==n?null!==r?n-r==0?t.length-e.length:n-r:-1:null!==r?1:t<e?-1:1}},si=function(t,e){return t===e?0:t<e?-1:1},ai=function(t,e){if(e&&t in e)return e[t];throw new Error("Missing required key ("+t+") in object: "+Ve(e))},ci=function(t){if("object"!=typeof t||null===t)return Ve(t);const e=[];for(const n in t)e.push(n);e.sort();let n="{";for(let r=0;r<e.length;r++)0!==r&&(n+=","),n+=Ve(e[r]),n+=":",n+=ci(t[e[r]]);return n+="}",n},ui=function(t,e){const n=t.length;if(n<=e)return[t];const r=[];for(let i=0;i<n;i+=e)i+e>n?r.push(t.substring(i,n)):r.push(t.substring(i,i+e));return r};function li(t,e){for(const n in t)t.hasOwnProperty(n)&&e(n,t[n])}const hi=function(t){ke(!ni(t),"Invalid JSON number");let e,n,r,i,o;0===t?(n=0,r=0,e=1/t==-1/0?1:0):(e=t<0,(t=Math.abs(t))>=Math.pow(2,-1022)?(i=Math.min(Math.floor(Math.log(t)/Math.LN2),1023),n=i+1023,r=Math.round(t*Math.pow(2,52-i)-Math.pow(2,52))):(n=0,r=Math.round(t/Math.pow(2,-1074))));const s=[];for(o=52;o;o-=1)s.push(r%2?1:0),r=Math.floor(r/2);for(o=11;o;o-=1)s.push(n%2?1:0),n=Math.floor(n/2);s.push(e?1:0),s.reverse();const a=s.join("");let c="";for(o=0;o<64;o+=8){let t=parseInt(a.substr(o,8),2).toString(16);1===t.length&&(t="0"+t),c+=t}return c.toLowerCase()},di=new RegExp("^-?(0*)\\d{1,10}$"),fi=function(t){if(di.test(t)){const e=Number(t);if(e>=-2147483648&&e<=2147483647)return e}return null},pi=function(t){try{t()}catch(t){setTimeout((()=>{const e=t.stack||"";throw ei("Exception was thrown by user callback.",e),t}),Math.floor(0))}},mi=function(t,e){const n=setTimeout(t,e);return"number"==typeof n&&"undefined"!=typeof Deno&&Deno.unrefTimer?Deno.unrefTimer(n):"object"==typeof n&&n.unref&&n.unref(),n};class yi{constructor(t,e){this.appName_=t,this.appCheckProvider=e,this.appCheck=null==e?void 0:e.getImmediate({optional:!0}),this.appCheck||null==e||e.get().then((t=>this.appCheck=t))}getToken(t){return this.appCheck?this.appCheck.getToken(t):new Promise(((e,n)=>{setTimeout((()=>{this.appCheck?this.getToken(t).then(e,n):e(null)}),0)}))}addTokenChangeListener(t){var e;null===(e=this.appCheckProvider)||void 0===e||e.get().then((e=>e.addTokenListener(t)))}notifyForInvalidToken(){ei(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}}class vi{constructor(t,e,n){this.appName_=t,this.firebaseOptions_=e,this.authProvider_=n,this.auth_=null,this.auth_=n.getImmediate({optional:!0}),this.auth_||n.onInit((t=>this.auth_=t))}getToken(t){return this.auth_?this.auth_.getToken(t).catch((t=>t&&"auth/token-not-initialized"===t.code?(Jr("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(t))):new Promise(((e,n)=>{setTimeout((()=>{this.auth_?this.getToken(t).then(e,n):e(null)}),0)}))}addTokenChangeListener(t){this.auth_?this.auth_.addAuthTokenListener(t):this.authProvider_.get().then((e=>e.addAuthTokenListener(t)))}removeTokenChangeListener(t){this.authProvider_.get().then((e=>e.removeAuthTokenListener(t)))}notifyForInvalidToken(){let t='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?t+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?t+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':t+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',ei(t)}}class gi{constructor(t){this.accessToken=t}getToken(t){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(t){t(this.accessToken)}removeTokenChangeListener(t){}notifyForInvalidToken(){}}gi.OWNER="owner";const _i="5",bi=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,wi="ac",Ci="websocket",Ei="long_polling";class Si{constructor(t,e,n,r,i=!1,o="",s=!1,a=!1){this.secure=e,this.namespace=n,this.webSocketOnly=r,this.nodeAdmin=i,this.persistenceKey=o,this.includeNamespaceInQueryParams=s,this.isUsingEmulator=a,this._host=t.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=Wr.get("host:"+t)||this._host}isCacheableHost(){return"s-"===this.internalHost.substr(0,2)}isCustomHost(){return"firebaseio.com"!==this._domain&&"firebaseio-demo.com"!==this._domain}get host(){return this._host}set host(t){t!==this.internalHost&&(this.internalHost=t,this.isCacheableHost()&&Wr.set("host:"+this._host,this.internalHost))}toString(){let t=this.toURLString();return this.persistenceKey&&(t+="<"+this.persistenceKey+">"),t}toURLString(){const t=this.secure?"https://":"http://",e=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${t}${this.host}/${e}`}}function ki(t,e,n){let r;if(ke("string"==typeof e,"typeof type must == string"),ke("object"==typeof n,"typeof params must == object"),e===Ci)r=(t.secure?"wss://":"ws://")+t.internalHost+"/.ws?";else{if(e!==Ei)throw new Error("Unknown connection type: "+e);r=(t.secure?"https://":"http://")+t.internalHost+"/.lp?"}(function(t){return t.host!==t.internalHost||t.isCustomHost()||t.includeNamespaceInQueryParams})(t)&&(n.ns=t.namespace);const i=[];return li(n,((t,e)=>{i.push(t+"="+e)})),r+i.join("&")}class Ii{constructor(){this.counters_={}}incrementCounter(t,e=1){$e(this.counters_,t)||(this.counters_[t]=0),this.counters_[t]+=e}get(){return De(this.counters_)}}const Ti={},xi={};function Pi(t){const e=t.toString();return Ti[e]||(Ti[e]=new Ii),Ti[e]}class Li{constructor(t){this.onMessage_=t,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(t,e){this.closeAfterResponse=t,this.onClose=e,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(t,e){for(this.pendingResponses[t]=e;this.pendingResponses[this.currentResponseNum];){const t=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let e=0;e<t.length;++e)t[e]&&pi((()=>{this.onMessage_(t[e])}));if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}const Ni="start";class Oi{constructor(t,e,n,r,i,o,s){this.connId=t,this.repoInfo=e,this.applicationId=n,this.appCheckToken=r,this.authToken=i,this.transportSessionId=o,this.lastSessionId=s,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=Xr(t),this.stats_=Pi(e),this.urlFn=t=>(this.appCheckToken&&(t[wi]=this.appCheckToken),ki(e,Ei,t))}open(t,e){this.curSegmentNum=0,this.onDisconnect_=e,this.myPacketOrderer=new Li(t),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout((()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null}),Math.floor(3e4)),function(t){if("complete"===document.readyState)t();else{let e=!1;const n=function(){document.body?e||(e=!0,t()):setTimeout(n,Math.floor(10))};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",(()=>{"complete"===document.readyState&&n()})),window.attachEvent("onload",n))}}((()=>{if(this.isClosed_)return;this.scriptTagHolder=new Di(((...t)=>{const[e,n,r,i,o]=t;if(this.incrementIncomingBytes_(t),this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,e===Ni)this.id=n,this.password=r;else{if("close"!==e)throw new Error("Unrecognized command received: "+e);n?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(n,(()=>{this.onClosed_()}))):this.onClosed_()}}),((...t)=>{const[e,n]=t;this.incrementIncomingBytes_(t),this.myPacketOrderer.handleResponse(e,n)}),(()=>{this.onClosed_()}),this.urlFn);const t={};t[Ni]="t",t.ser=Math.floor(1e8*Math.random()),this.scriptTagHolder.uniqueCallbackIdentifier&&(t.cb=this.scriptTagHolder.uniqueCallbackIdentifier),t.v=_i,this.transportSessionId&&(t.s=this.transportSessionId),this.lastSessionId&&(t.ls=this.lastSessionId),this.applicationId&&(t.p=this.applicationId),this.appCheckToken&&(t[wi]=this.appCheckToken),"undefined"!=typeof location&&location.hostname&&bi.test(location.hostname)&&(t.r="f");const e=this.urlFn(t);this.log_("Connecting via long-poll to "+e),this.scriptTagHolder.addTag(e,(()=>{}))}))}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){Oi.forceAllow_=!0}static forceDisallow(){Oi.forceDisallow_=!0}static isAvailable(){return!(!Oi.forceAllow_&&(Oi.forceDisallow_||"undefined"==typeof document||null==document.createElement||"object"==typeof window&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href)||"object"==typeof Windows&&"object"==typeof Windows.UI))}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(t){const e=Ve(t);this.bytesSent+=e.length,this.stats_.incrementCounter("bytes_sent",e.length);const n=Le(e),r=ui(n,1840);for(let t=0;t<r.length;t++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,r.length,r[t]),this.curSegmentNum++}addDisconnectPingFrame(t,e){this.myDisconnFrame=document.createElement("iframe");const n={dframe:"t"};n.id=t,n.pw=e,this.myDisconnFrame.src=this.urlFn(n),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(t){const e=Ve(t).length;this.bytesReceived+=e,this.stats_.incrementCounter("bytes_received",e)}}class Di{constructor(t,e,n,r){this.onDisconnect=n,this.urlFn=r,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0;{this.uniqueCallbackIdentifier=Gr(),window["pLPCommand"+this.uniqueCallbackIdentifier]=t,window["pRTLPCB"+this.uniqueCallbackIdentifier]=e,this.myIFrame=Di.createIFrame_();let n="";this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,11)&&(n='<script>document.domain="'+document.domain+'";<\/script>');const r="<html><body>"+n+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(r),this.myIFrame.doc.close()}catch(t){Jr("frame writing exception"),t.stack&&Jr(t.stack),Jr(t)}}}static createIFrame_(){const t=document.createElement("iframe");if(t.style.display="none",!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(t);try{t.contentWindow.document||Jr("No IE domain setting required")}catch(e){const n=document.domain;t.src="javascript:void((function(){document.open();document.domain='"+n+"';document.close();})())"}return t.contentDocument?t.doc=t.contentDocument:t.contentWindow?t.doc=t.contentWindow.document:t.document&&(t.doc=t.document),t}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout((()=>{null!==this.myIFrame&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)}),Math.floor(0)));const t=this.onDisconnect;t&&(this.onDisconnect=null,t())}startLongPoll(t,e){for(this.myID=t,this.myPW=e,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const t={};t.id=this.myID,t.pw=this.myPW,t.ser=this.currentSerial;let e=this.urlFn(t),n="",r=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+30+n.length<=1870;){const t=this.pendingSegs.shift();n=n+"&seg"+r+"="+t.seg+"&ts"+r+"="+t.ts+"&d"+r+"="+t.d,r++}return e+=n,this.addLongPollTag_(e,this.currentSerial),!0}return!1}enqueueSegment(t,e,n){this.pendingSegs.push({seg:t,ts:e,d:n}),this.alive&&this.newRequest_()}addLongPollTag_(t,e){this.outstandingRequests.add(e);const n=()=>{this.outstandingRequests.delete(e),this.newRequest_()},r=setTimeout(n,Math.floor(25e3));this.addTag(t,(()=>{clearTimeout(r),n()}))}addTag(t,e){setTimeout((()=>{try{if(!this.sendNewPolls)return;const n=this.myIFrame.doc.createElement("script");n.type="text/javascript",n.async=!0,n.src=t,n.onload=n.onreadystatechange=function(){const t=n.readyState;t&&"loaded"!==t&&"complete"!==t||(n.onload=n.onreadystatechange=null,n.parentNode&&n.parentNode.removeChild(n),e())},n.onerror=()=>{Jr("Long-poll script failed to load: "+t),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(n)}catch(t){}}),Math.floor(1))}}let Ai=null;"undefined"!=typeof MozWebSocket?Ai=MozWebSocket:"undefined"!=typeof WebSocket&&(Ai=WebSocket);class Ri{constructor(t,e,n,r,i,o,s){this.connId=t,this.applicationId=n,this.appCheckToken=r,this.authToken=i,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=Xr(this.connId),this.stats_=Pi(e),this.connURL=Ri.connectionURL_(e,o,s,r,n),this.nodeAdmin=e.nodeAdmin}static connectionURL_(t,e,n,r,i){const o={};return o.v=_i,"undefined"!=typeof location&&location.hostname&&bi.test(location.hostname)&&(o.r="f"),e&&(o.s=e),n&&(o.ls=n),r&&(o[wi]=r),i&&(o.p=i),ki(t,Ci,o)}open(t,e){this.onDisconnect=e,this.onMessage=t,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,Wr.set("previous_websocket_failure",!0);try{let t;0,this.mySock=new Ai(this.connURL,[],t)}catch(t){this.log_("Error instantiating WebSocket.");const e=t.message||t.data;return e&&this.log_(e),void this.onClosed_()}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=t=>{this.handleIncomingFrame(t)},this.mySock.onerror=t=>{this.log_("WebSocket error.  Closing connection.");const e=t.message||t.data;e&&this.log_(e),this.onClosed_()}}start(){}static forceDisallow(){Ri.forceDisallow_=!0}static isAvailable(){let t=!1;if("undefined"!=typeof navigator&&navigator.userAgent){const e=/Android ([0-9]{0,}\.[0-9]{0,})/,n=navigator.userAgent.match(e);n&&n.length>1&&parseFloat(n[1])<4.4&&(t=!0)}return!t&&null!==Ai&&!Ri.forceDisallow_}static previouslyFailed(){return Wr.isInMemoryStorage||!0===Wr.get("previous_websocket_failure")}markConnectionHealthy(){Wr.remove("previous_websocket_failure")}appendFrame_(t){if(this.frames.push(t),this.frames.length===this.totalFrames){const t=this.frames.join("");this.frames=null;const e=He(t);this.onMessage(e)}}handleNewFrameCount_(t){this.totalFrames=t,this.frames=[]}extractFrameCount_(t){if(ke(null===this.frames,"We already have a frame buffer"),t.length<=6){const e=Number(t);if(!isNaN(e))return this.handleNewFrameCount_(e),null}return this.handleNewFrameCount_(1),t}handleIncomingFrame(t){if(null===this.mySock)return;const e=t.data;if(this.bytesReceived+=e.length,this.stats_.incrementCounter("bytes_received",e.length),this.resetKeepAlive(),null!==this.frames)this.appendFrame_(e);else{const t=this.extractFrameCount_(e);null!==t&&this.appendFrame_(t)}}send(t){this.resetKeepAlive();const e=Ve(t);this.bytesSent+=e.length,this.stats_.incrementCounter("bytes_sent",e.length);const n=ui(e,16384);n.length>1&&this.sendString_(String(n.length));for(let t=0;t<n.length;t++)this.sendString_(n[t])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval((()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()}),Math.floor(45e3))}sendString_(t){try{this.mySock.send(t)}catch(t){this.log_("Exception thrown from WebSocket.send():",t.message||t.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}Ri.responsesRequiredToBeHealthy=2,Ri.healthyTimeout=3e4;class Mi{constructor(t){this.initTransports_(t)}static get ALL_TRANSPORTS(){return[Oi,Ri]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(t){const e=Ri&&Ri.isAvailable();let n=e&&!Ri.previouslyFailed();if(t.webSocketOnly&&(e||ei("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),n=!0),n)this.transports_=[Ri];else{const t=this.transports_=[];for(const e of Mi.ALL_TRANSPORTS)e&&e.isAvailable()&&t.push(e);Mi.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}Mi.globalTransportInitialized_=!1;class ji{constructor(t,e,n,r,i,o,s,a,c,u){this.id=t,this.repoInfo_=e,this.applicationId_=n,this.appCheckToken_=r,this.authToken_=i,this.onMessage_=o,this.onReady_=s,this.onDisconnect_=a,this.onKill_=c,this.lastSessionId=u,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=Xr("c:"+this.id+":"),this.transportManager_=new Mi(e),this.log_("Connection created"),this.start_()}start_(){const t=this.transportManager_.initialTransport();this.conn_=new t(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=t.responsesRequiredToBeHealthy||0;const e=this.connReceiver_(this.conn_),n=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout((()=>{this.conn_&&this.conn_.open(e,n)}),Math.floor(0));const r=t.healthyTimeout||0;r>0&&(this.healthyTimeout_=mi((()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>102400?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>10240?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))}),Math.floor(r)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(t){return e=>{t===this.conn_?this.onConnectionLost_(e):t===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(t){return e=>{2!==this.state_&&(t===this.rx_?this.onPrimaryMessageReceived_(e):t===this.secondaryConn_?this.onSecondaryMessageReceived_(e):this.log_("message on old connection"))}}sendRequest(t){const e={t:"d",d:t};this.sendData_(e)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(t){if("t"in t){const e=t.t;"a"===e?this.upgradeIfSecondaryHealthy_():"r"===e?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),this.tx_!==this.secondaryConn_&&this.rx_!==this.secondaryConn_||this.close()):"o"===e&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(t){const e=ai("t",t),n=ai("d",t);if("c"===e)this.onSecondaryControl_(n);else{if("d"!==e)throw new Error("Unknown protocol layer: "+e);this.pendingDataMessages.push(n)}}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:"p",d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:"a",d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:"n",d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(t){const e=ai("t",t),n=ai("d",t);"c"===e?this.onControl_(n):"d"===e&&this.onDataMessage_(n)}onDataMessage_(t){this.onPrimaryResponse_(),this.onMessage_(t)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(t){const e=ai("t",t);if("d"in t){const n=t.d;if("h"===e){const t=Object.assign({},n);this.repoInfo_.isUsingEmulator&&(t.h=this.repoInfo_.host),this.onHandshake_(t)}else if("n"===e){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let t=0;t<this.pendingDataMessages.length;++t)this.onDataMessage_(this.pendingDataMessages[t]);this.pendingDataMessages=[],this.tryCleanupConnection()}else"s"===e?this.onConnectionShutdown_(n):"r"===e?this.onReset_(n):"e"===e?Zr("Server Error: "+n):"o"===e?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):Zr("Unknown control packet command: "+e)}}onHandshake_(t){const e=t.ts,n=t.v,r=t.h;this.sessionId=t.s,this.repoInfo_.host=r,0===this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,e),_i!==n&&ei("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const t=this.transportManager_.upgradeTransport();t&&this.startUpgrade_(t)}startUpgrade_(t){this.secondaryConn_=new t(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=t.responsesRequiredToBeHealthy||0;const e=this.connReceiver_(this.secondaryConn_),n=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(e,n),mi((()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())}),Math.floor(6e4))}onReset_(t){this.log_("Reset packet received.  New host: "+t),this.repoInfo_.host=t,1===this.state_?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(t,e){this.log_("Realtime connection established."),this.conn_=t,this.state_=1,this.onReady_&&(this.onReady_(e,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):mi((()=>{this.sendPingOnPrimaryIfNecessary_()}),Math.floor(5e3))}sendPingOnPrimaryIfNecessary_(){this.isHealthy_||1!==this.state_||(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:"p",d:{}}}))}onSecondaryConnectionLost_(){const t=this.secondaryConn_;this.secondaryConn_=null,this.tx_!==t&&this.rx_!==t||this.close()}onConnectionLost_(t){this.conn_=null,t||0!==this.state_?1===this.state_&&this.log_("Realtime connection lost."):(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(Wr.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()}onConnectionShutdown_(t){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(t),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(t){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(t)}close(){2!==this.state_&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}class Fi{put(t,e,n,r){}merge(t,e,n,r){}refreshAuthToken(t){}refreshAppCheckToken(t){}onDisconnectPut(t,e,n){}onDisconnectMerge(t,e,n){}onDisconnectCancel(t,e){}reportStats(t){}}class qi{constructor(t){this.allowedEvents_=t,this.listeners_={},ke(Array.isArray(t)&&t.length>0,"Requires a non-empty array")}trigger(t,...e){if(Array.isArray(this.listeners_[t])){const n=[...this.listeners_[t]];for(let t=0;t<n.length;t++)n[t].callback.apply(n[t].context,e)}}on(t,e,n){this.validateEventType_(t),this.listeners_[t]=this.listeners_[t]||[],this.listeners_[t].push({callback:e,context:n});const r=this.getInitialEvent(t);r&&e.apply(n,r)}off(t,e,n){this.validateEventType_(t);const r=this.listeners_[t]||[];for(let t=0;t<r.length;t++)if(r[t].callback===e&&(!n||n===r[t].context))return void r.splice(t,1)}validateEventType_(t){ke(this.allowedEvents_.find((e=>e===t)),"Unknown event: "+t)}}class zi extends qi{constructor(){super(["online"]),this.online_=!0,"undefined"==typeof window||void 0===window.addEventListener||Fe()||(window.addEventListener("online",(()=>{this.online_||(this.online_=!0,this.trigger("online",!0))}),!1),window.addEventListener("offline",(()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))}),!1))}static getInstance(){return new zi}getInitialEvent(t){return ke("online"===t,"Unknown event type: "+t),[this.online_]}currentlyOnline(){return this.online_}}class Bi{constructor(t,e){if(void 0===e){this.pieces_=t.split("/");let e=0;for(let t=0;t<this.pieces_.length;t++)this.pieces_[t].length>0&&(this.pieces_[e]=this.pieces_[t],e++);this.pieces_.length=e,this.pieceNum_=0}else this.pieces_=t,this.pieceNum_=e}toString(){let t="";for(let e=this.pieceNum_;e<this.pieces_.length;e++)""!==this.pieces_[e]&&(t+="/"+this.pieces_[e]);return t||"/"}}function Ui(){return new Bi("")}function Wi(t){return t.pieceNum_>=t.pieces_.length?null:t.pieces_[t.pieceNum_]}function Hi(t){return t.pieces_.length-t.pieceNum_}function Vi(t){let e=t.pieceNum_;return e<t.pieces_.length&&e++,new Bi(t.pieces_,e)}function Gi(t){return t.pieceNum_<t.pieces_.length?t.pieces_[t.pieces_.length-1]:null}function $i(t,e=0){return t.pieces_.slice(t.pieceNum_+e)}function Yi(t){if(t.pieceNum_>=t.pieces_.length)return null;const e=[];for(let n=t.pieceNum_;n<t.pieces_.length-1;n++)e.push(t.pieces_[n]);return new Bi(e,0)}function Ki(t,e){const n=[];for(let e=t.pieceNum_;e<t.pieces_.length;e++)n.push(t.pieces_[e]);if(e instanceof Bi)for(let t=e.pieceNum_;t<e.pieces_.length;t++)n.push(e.pieces_[t]);else{const t=e.split("/");for(let e=0;e<t.length;e++)t[e].length>0&&n.push(t[e])}return new Bi(n,0)}function Qi(t){return t.pieceNum_>=t.pieces_.length}function Ji(t,e){const n=Wi(t),r=Wi(e);if(null===n)return e;if(n===r)return Ji(Vi(t),Vi(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+t+")")}function Xi(t,e){if(Hi(t)!==Hi(e))return!1;for(let n=t.pieceNum_,r=e.pieceNum_;n<=t.pieces_.length;n++,r++)if(t.pieces_[n]!==e.pieces_[r])return!1;return!0}function Zi(t,e){let n=t.pieceNum_,r=e.pieceNum_;if(Hi(t)>Hi(e))return!1;for(;n<t.pieces_.length;){if(t.pieces_[n]!==e.pieces_[r])return!1;++n,++r}return!0}class to{constructor(t,e){this.errorPrefix_=e,this.parts_=$i(t,0),this.byteLength_=Math.max(1,this.parts_.length);for(let t=0;t<this.parts_.length;t++)this.byteLength_+=en(this.parts_[t]);eo(this)}}function eo(t){if(t.byteLength_>768)throw new Error(t.errorPrefix_+"has a key path longer than 768 bytes ("+t.byteLength_+").");if(t.parts_.length>32)throw new Error(t.errorPrefix_+"path specified exceeds the maximum depth that can be written (32) or object contains a cycle "+no(t))}function no(t){return 0===t.parts_.length?"":"in property '"+t.parts_.join(".")+"'"}class ro extends qi{constructor(){let t,e;super(["visible"]),"undefined"!=typeof document&&void 0!==document.addEventListener&&(void 0!==document.hidden?(e="visibilitychange",t="hidden"):void 0!==document.mozHidden?(e="mozvisibilitychange",t="mozHidden"):void 0!==document.msHidden?(e="msvisibilitychange",t="msHidden"):void 0!==document.webkitHidden&&(e="webkitvisibilitychange",t="webkitHidden")),this.visible_=!0,e&&document.addEventListener(e,(()=>{const e=!document[t];e!==this.visible_&&(this.visible_=e,this.trigger("visible",e))}),!1)}static getInstance(){return new ro}getInitialEvent(t){return ke("visible"===t,"Unknown event type: "+t),[this.visible_]}}const io=1e3;class oo extends Fi{constructor(t,e,n,r,i,o,s,a){if(super(),this.repoInfo_=t,this.applicationId_=e,this.onDataUpdate_=n,this.onConnectStatus_=r,this.onServerInfoUpdate_=i,this.authTokenProvider_=o,this.appCheckTokenProvider_=s,this.authOverride_=a,this.id=oo.nextPersistentConnectionId_++,this.log_=Xr("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=io,this.maxReconnectDelay_=3e5,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,a)throw new Error("Auth override specified in options, but not supported on non Node.js platforms");ro.getInstance().on("visible",this.onVisible_,this),-1===t.host.indexOf("fblocal")&&zi.getInstance().on("online",this.onOnline_,this)}sendRequest(t,e,n){const r=++this.requestNumber_,i={r,a:t,b:e};this.log_(Ve(i)),ke(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(i),n&&(this.requestCBHash_[r]=n)}get(t){this.initConnection_();const e=new je,n={action:"g",request:{p:t._path.toString(),q:t._queryObject},onComplete:t=>{const n=t.d;"ok"===t.s?e.resolve(n):e.reject(n)}};this.outstandingGets_.push(n),this.outstandingGetCount_++;const r=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(r),e.promise}listen(t,e,n,r){this.initConnection_();const i=t._queryIdentifier,o=t._path.toString();this.log_("Listen called for "+o+" "+i),this.listens.has(o)||this.listens.set(o,new Map),ke(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"listen() called for non-default but complete query"),ke(!this.listens.get(o).has(i),"listen() called twice for same path/queryId.");const s={onComplete:r,hashFn:e,query:t,tag:n};this.listens.get(o).set(i,s),this.connected_&&this.sendListen_(s)}sendGet_(t){const e=this.outstandingGets_[t];this.sendRequest("g",e.request,(n=>{delete this.outstandingGets_[t],this.outstandingGetCount_--,0===this.outstandingGetCount_&&(this.outstandingGets_=[]),e.onComplete&&e.onComplete(n)}))}sendListen_(t){const e=t.query,n=e._path.toString(),r=e._queryIdentifier;this.log_("Listen on "+n+" for "+r);const i={p:n};t.tag&&(i.q=e._queryObject,i.t=t.tag),i.h=t.hashFn(),this.sendRequest("q",i,(i=>{const o=i.d,s=i.s;oo.warnOnListenWarnings_(o,e),(this.listens.get(n)&&this.listens.get(n).get(r))===t&&(this.log_("listen response",i),"ok"!==s&&this.removeListen_(n,r),t.onComplete&&t.onComplete(s,o))}))}static warnOnListenWarnings_(t,e){if(t&&"object"==typeof t&&$e(t,"w")){const n=Ye(t,"w");if(Array.isArray(n)&&~n.indexOf("no_index")){const t='".indexOn": "'+e._queryParams.getIndex().toString()+'"',n=e._path.toString();ei(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${t} at ${n} to your security rules for better performance.`)}}}refreshAuthToken(t){this.authToken_=t,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},(()=>{})),this.reduceReconnectDelayIfAdminCredential_(t)}reduceReconnectDelayIfAdminCredential_(t){(t&&40===t.length||function(t){const e=Ge(t).claims;return"object"==typeof e&&!0===e.admin}(t))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=3e4)}refreshAppCheckToken(t){this.appCheckToken_=t,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},(()=>{}))}tryAuth(){if(this.connected_&&this.authToken_){const t=this.authToken_,e=function(t){const e=Ge(t).claims;return!!e&&"object"==typeof e&&e.hasOwnProperty("iat")}(t)?"auth":"gauth",n={cred:t};null===this.authOverride_?n.noauth=!0:"object"==typeof this.authOverride_&&(n.authvar=this.authOverride_),this.sendRequest(e,n,(e=>{const n=e.s,r=e.d||"error";this.authToken_===t&&("ok"===n?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(n,r))}))}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},(t=>{const e=t.s,n=t.d||"error";"ok"===e?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(e,n)}))}unlisten(t,e){const n=t._path.toString(),r=t._queryIdentifier;this.log_("Unlisten called for "+n+" "+r),ke(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(n,r)&&this.connected_&&this.sendUnlisten_(n,r,t._queryObject,e)}sendUnlisten_(t,e,n,r){this.log_("Unlisten on "+t+" for "+e);const i={p:t};r&&(i.q=n,i.t=r),this.sendRequest("n",i)}onDisconnectPut(t,e,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",t,e,n):this.onDisconnectRequestQueue_.push({pathString:t,action:"o",data:e,onComplete:n})}onDisconnectMerge(t,e,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",t,e,n):this.onDisconnectRequestQueue_.push({pathString:t,action:"om",data:e,onComplete:n})}onDisconnectCancel(t,e){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",t,null,e):this.onDisconnectRequestQueue_.push({pathString:t,action:"oc",data:null,onComplete:e})}sendOnDisconnect_(t,e,n,r){const i={p:e,d:n};this.log_("onDisconnect "+t,i),this.sendRequest(t,i,(t=>{r&&setTimeout((()=>{r(t.s,t.d)}),Math.floor(0))}))}put(t,e,n,r){this.putInternal("p",t,e,n,r)}merge(t,e,n,r){this.putInternal("m",t,e,n,r)}putInternal(t,e,n,r,i){this.initConnection_();const o={p:e,d:n};void 0!==i&&(o.h=i),this.outstandingPuts_.push({action:t,request:o,onComplete:r}),this.outstandingPutCount_++;const s=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(s):this.log_("Buffering put: "+e)}sendPut_(t){const e=this.outstandingPuts_[t].action,n=this.outstandingPuts_[t].request,r=this.outstandingPuts_[t].onComplete;this.outstandingPuts_[t].queued=this.connected_,this.sendRequest(e,n,(n=>{this.log_(e+" response",n),delete this.outstandingPuts_[t],this.outstandingPutCount_--,0===this.outstandingPutCount_&&(this.outstandingPuts_=[]),r&&r(n.s,n.d)}))}reportStats(t){if(this.connected_){const e={c:t};this.log_("reportStats",e),this.sendRequest("s",e,(t=>{if("ok"!==t.s){const e=t.d;this.log_("reportStats","Error sending stats: "+e)}}))}}onDataMessage_(t){if("r"in t){this.log_("from server: "+Ve(t));const e=t.r,n=this.requestCBHash_[e];n&&(delete this.requestCBHash_[e],n(t.b))}else{if("error"in t)throw"A server-side error has occurred: "+t.error;"a"in t&&this.onDataPush_(t.a,t.b)}}onDataPush_(t,e){this.log_("handleServerMessage",t,e),"d"===t?this.onDataUpdate_(e.p,e.d,!1,e.t):"m"===t?this.onDataUpdate_(e.p,e.d,!0,e.t):"c"===t?this.onListenRevoked_(e.p,e.q):"ac"===t?this.onAuthRevoked_(e.s,e.d):"apc"===t?this.onAppCheckRevoked_(e.s,e.d):"sd"===t?this.onSecurityDebugPacket_(e):Zr("Unrecognized action received from server: "+Ve(t)+"\nAre you using the latest client?")}onReady_(t,e){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=(new Date).getTime(),this.handleTimestamp_(t),this.lastSessionId=e,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(t){ke(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout((()=>{this.establishConnectionTimer_=null,this.establishConnection_()}),Math.floor(t))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(t){t&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=io,this.realtime_||this.scheduleConnect_(0)),this.visible_=t}onOnline_(t){t?(this.log_("Browser went online."),this.reconnectDelay_=io,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&((new Date).getTime()-this.lastConnectionEstablishedTime_>3e4&&(this.reconnectDelay_=io),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=(new Date).getTime());const t=(new Date).getTime()-this.lastConnectionAttemptTime_;let e=Math.max(0,this.reconnectDelay_-t);e=Math.random()*e,this.log_("Trying to reconnect in "+e+"ms"),this.scheduleConnect_(e),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,1.3*this.reconnectDelay_)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=(new Date).getTime(),this.lastConnectionEstablishedTime_=null;const t=this.onDataMessage_.bind(this),e=this.onReady_.bind(this),n=this.onRealtimeDisconnect_.bind(this),r=this.id+":"+oo.nextConnectionId_++,i=this.lastSessionId;let o=!1,s=null;const a=function(){s?s.close():(o=!0,n())},c=function(t){ke(s,"sendRequest call when we're not connected not allowed."),s.sendRequest(t)};this.realtime_={close:a,sendRequest:c};const u=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[a,c]=await Promise.all([this.authTokenProvider_.getToken(u),this.appCheckTokenProvider_.getToken(u)]);o?Jr("getToken() completed but was canceled"):(Jr("getToken() completed. Creating connection."),this.authToken_=a&&a.accessToken,this.appCheckToken_=c&&c.token,s=new ji(r,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,t,e,n,(t=>{ei(t+" ("+this.repoInfo_.toString()+")"),this.interrupt("server_kill")}),i))}catch(t){this.log_("Failed to get token: "+t),o||(this.repoInfo_.nodeAdmin&&ei(t),a())}}}interrupt(t){Jr("Interrupting connection for reason: "+t),this.interruptReasons_[t]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(t){Jr("Resuming connection for reason: "+t),delete this.interruptReasons_[t],Ke(this.interruptReasons_)&&(this.reconnectDelay_=io,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(t){const e=t-(new Date).getTime();this.onServerInfoUpdate_({serverTimeOffset:e})}cancelSentTransactions_(){for(let t=0;t<this.outstandingPuts_.length;t++){const e=this.outstandingPuts_[t];e&&"h"in e.request&&e.queued&&(e.onComplete&&e.onComplete("disconnect"),delete this.outstandingPuts_[t],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])}onListenRevoked_(t,e){let n;n=e?e.map((t=>ci(t))).join("$"):"default";const r=this.removeListen_(t,n);r&&r.onComplete&&r.onComplete("permission_denied")}removeListen_(t,e){const n=new Bi(t).toString();let r;if(this.listens.has(n)){const t=this.listens.get(n);r=t.get(e),t.delete(e),0===t.size&&this.listens.delete(n)}else r=void 0;return r}onAuthRevoked_(t,e){Jr("Auth token revoked: "+t+"/"+e),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),"invalid_token"!==t&&"permission_denied"!==t||(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=3&&(this.reconnectDelay_=3e4,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(t,e){Jr("App check token revoked: "+t+"/"+e),this.appCheckToken_=null,this.forceTokenRefresh_=!0,"invalid_token"!==t&&"permission_denied"!==t||(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=3&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(t){this.securityDebugCallback_?this.securityDebugCallback_(t):"msg"in t&&console.log("FIREBASE: "+t.msg.replace("\n","\nFIREBASE: "))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const t of this.listens.values())for(const e of t.values())this.sendListen_(e);for(let t=0;t<this.outstandingPuts_.length;t++)this.outstandingPuts_[t]&&this.sendPut_(t);for(;this.onDisconnectRequestQueue_.length;){const t=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(t.action,t.pathString,t.data,t.onComplete)}for(let t=0;t<this.outstandingGets_.length;t++)this.outstandingGets_[t]&&this.sendGet_(t)}sendConnectStats_(){const t={};let e="js";t["sdk."+e+"."+qr.replace(/\./g,"-")]=1,Fe()?t["framework.cordova"]=1:"object"==typeof navigator&&"ReactNative"===navigator.product&&(t["framework.reactnative"]=1),this.reportStats(t)}shouldReconnect_(){const t=zi.getInstance().currentlyOnline();return Ke(this.interruptReasons_)&&t}}oo.nextPersistentConnectionId_=0,oo.nextConnectionId_=0;class so{constructor(t,e){this.name=t,this.node=e}static Wrap(t,e){return new so(t,e)}}class ao{getCompare(){return this.compare.bind(this)}indexedValueChanged(t,e){const n=new so(ri,t),r=new so(ri,e);return 0!==this.compare(n,r)}minPost(){return so.MIN}}let co;class uo extends ao{static get __EMPTY_NODE(){return co}static set __EMPTY_NODE(t){co=t}compare(t,e){return oi(t.name,e.name)}isDefinedOn(t){throw Ie("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(t,e){return!1}minPost(){return so.MIN}maxPost(){return new so(ii,co)}makePost(t,e){return ke("string"==typeof t,"KeyIndex indexValue must always be a string."),new so(t,co)}toString(){return".key"}}const lo=new uo;class ho{constructor(t,e,n,r,i=null){this.isReverse_=r,this.resultGenerator_=i,this.nodeStack_=[];let o=1;for(;!t.isEmpty();)if(o=e?n(t.key,e):1,r&&(o*=-1),o<0)t=this.isReverse_?t.left:t.right;else{if(0===o){this.nodeStack_.push(t);break}this.nodeStack_.push(t),t=this.isReverse_?t.right:t.left}}getNext(){if(0===this.nodeStack_.length)return null;let t,e=this.nodeStack_.pop();if(t=this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return t}hasNext(){return this.nodeStack_.length>0}peek(){if(0===this.nodeStack_.length)return null;const t=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(t.key,t.value):{key:t.key,value:t.value}}}class fo{constructor(t,e,n,r,i){this.key=t,this.value=e,this.color=null!=n?n:fo.RED,this.left=null!=r?r:po.EMPTY_NODE,this.right=null!=i?i:po.EMPTY_NODE}copy(t,e,n,r,i){return new fo(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||!!t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,e,n){let r=this;const i=n(t,r.key);return r=i<0?r.copy(null,null,null,r.left.insert(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.insert(t,e,n)),r.fixUp_()}removeMin_(){if(this.left.isEmpty())return po.EMPTY_NODE;let t=this;return t.left.isRed_()||t.left.left.isRed_()||(t=t.moveRedLeft_()),t=t.copy(null,null,null,t.left.removeMin_(),null),t.fixUp_()}remove(t,e){let n,r;if(n=this,e(t,n.key)<0)n.left.isEmpty()||n.left.isRed_()||n.left.left.isRed_()||(n=n.moveRedLeft_()),n=n.copy(null,null,null,n.left.remove(t,e),null);else{if(n.left.isRed_()&&(n=n.rotateRight_()),n.right.isEmpty()||n.right.isRed_()||n.right.left.isRed_()||(n=n.moveRedRight_()),0===e(t,n.key)){if(n.right.isEmpty())return po.EMPTY_NODE;r=n.right.min_(),n=n.copy(r.key,r.value,null,null,n.right.removeMin_())}n=n.copy(null,null,null,null,n.right.remove(t,e))}return n.fixUp_()}isRed_(){return this.color}fixUp_(){let t=this;return t.right.isRed_()&&!t.left.isRed_()&&(t=t.rotateLeft_()),t.left.isRed_()&&t.left.left.isRed_()&&(t=t.rotateRight_()),t.left.isRed_()&&t.right.isRed_()&&(t=t.colorFlip_()),t}moveRedLeft_(){let t=this.colorFlip_();return t.right.left.isRed_()&&(t=t.copy(null,null,null,null,t.right.rotateRight_()),t=t.rotateLeft_(),t=t.colorFlip_()),t}moveRedRight_(){let t=this.colorFlip_();return t.left.left.isRed_()&&(t=t.rotateRight_(),t=t.colorFlip_()),t}rotateLeft_(){const t=this.copy(null,null,fo.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight_(){const t=this.copy(null,null,fo.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip_(){const t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)}checkMaxDepth_(){const t=this.check_();return Math.pow(2,t)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const t=this.left.check_();if(t!==this.right.check_())throw new Error("Black depths differ");return t+(this.isRed_()?0:1)}}fo.RED=!0,fo.BLACK=!1;class po{constructor(t,e=po.EMPTY_NODE){this.comparator_=t,this.root_=e}insert(t,e){return new po(this.comparator_,this.root_.insert(t,e,this.comparator_).copy(null,null,fo.BLACK,null,null))}remove(t){return new po(this.comparator_,this.root_.remove(t,this.comparator_).copy(null,null,fo.BLACK,null,null))}get(t){let e,n=this.root_;for(;!n.isEmpty();){if(e=this.comparator_(t,n.key),0===e)return n.value;e<0?n=n.left:e>0&&(n=n.right)}return null}getPredecessorKey(t){let e,n=this.root_,r=null;for(;!n.isEmpty();){if(e=this.comparator_(t,n.key),0===e){if(n.left.isEmpty())return r?r.key:null;for(n=n.left;!n.right.isEmpty();)n=n.right;return n.key}e<0?n=n.left:e>0&&(r=n,n=n.right)}throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(t){return this.root_.inorderTraversal(t)}reverseTraversal(t){return this.root_.reverseTraversal(t)}getIterator(t){return new ho(this.root_,null,this.comparator_,!1,t)}getIteratorFrom(t,e){return new ho(this.root_,t,this.comparator_,!1,e)}getReverseIteratorFrom(t,e){return new ho(this.root_,t,this.comparator_,!0,e)}getReverseIterator(t){return new ho(this.root_,null,this.comparator_,!0,t)}}function mo(t,e){return oi(t.name,e.name)}function yo(t,e){return oi(t,e)}let vo;po.EMPTY_NODE=new class{copy(t,e,n,r,i){return this}insert(t,e,n){return new fo(t,e,null)}remove(t,e){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}};const go=function(t){return"number"==typeof t?"number:"+hi(t):"string:"+t},_o=function(t){if(t.isLeafNode()){const e=t.val();ke("string"==typeof e||"number"==typeof e||"object"==typeof e&&$e(e,".sv"),"Priority must be a string or number.")}else ke(t===vo||t.isEmpty(),"priority of unexpected type.");ke(t===vo||t.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};let bo,wo,Co;class Eo{constructor(t,e=Eo.__childrenNodeConstructor.EMPTY_NODE){this.value_=t,this.priorityNode_=e,this.lazyHash_=null,ke(void 0!==this.value_&&null!==this.value_,"LeafNode shouldn't be created with null/undefined value."),_o(this.priorityNode_)}static set __childrenNodeConstructor(t){bo=t}static get __childrenNodeConstructor(){return bo}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(t){return new Eo(this.value_,t)}getImmediateChild(t){return".priority"===t?this.priorityNode_:Eo.__childrenNodeConstructor.EMPTY_NODE}getChild(t){return Qi(t)?this:".priority"===Wi(t)?this.priorityNode_:Eo.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(t,e){return null}updateImmediateChild(t,e){return".priority"===t?this.updatePriority(e):e.isEmpty()&&".priority"!==t?this:Eo.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(t,e).updatePriority(this.priorityNode_)}updateChild(t,e){const n=Wi(t);return null===n?e:e.isEmpty()&&".priority"!==n?this:(ke(".priority"!==n||1===Hi(t),".priority must be the last token in a path"),this.updateImmediateChild(n,Eo.__childrenNodeConstructor.EMPTY_NODE.updateChild(Vi(t),e)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(t,e){return!1}val(t){return t&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(null===this.lazyHash_){let t="";this.priorityNode_.isEmpty()||(t+="priority:"+go(this.priorityNode_.val())+":");const e=typeof this.value_;t+=e+":",t+="number"===e?hi(this.value_):this.value_,this.lazyHash_=$r(t)}return this.lazyHash_}getValue(){return this.value_}compareTo(t){return t===Eo.__childrenNodeConstructor.EMPTY_NODE?1:t instanceof Eo.__childrenNodeConstructor?-1:(ke(t.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(t))}compareToLeafNode_(t){const e=typeof t.value_,n=typeof this.value_,r=Eo.VALUE_TYPE_ORDER.indexOf(e),i=Eo.VALUE_TYPE_ORDER.indexOf(n);return ke(r>=0,"Unknown leaf type: "+e),ke(i>=0,"Unknown leaf type: "+n),r===i?"object"===n?0:this.value_<t.value_?-1:this.value_===t.value_?0:1:i-r}withIndex(){return this}isIndexed(){return!0}equals(t){if(t===this)return!0;if(t.isLeafNode()){const e=t;return this.value_===e.value_&&this.priorityNode_.equals(e.priorityNode_)}return!1}}Eo.VALUE_TYPE_ORDER=["object","boolean","number","string"];const So=new class extends ao{compare(t,e){const n=t.node.getPriority(),r=e.node.getPriority(),i=n.compareTo(r);return 0===i?oi(t.name,e.name):i}isDefinedOn(t){return!t.getPriority().isEmpty()}indexedValueChanged(t,e){return!t.getPriority().equals(e.getPriority())}minPost(){return so.MIN}maxPost(){return new so(ii,new Eo("[PRIORITY-POST]",Co))}makePost(t,e){const n=wo(t);return new so(e,new Eo("[PRIORITY-POST]",n))}toString(){return".priority"}},ko=Math.log(2);class Io{constructor(t){var e;this.count=(e=t+1,parseInt(Math.log(e)/ko,10)),this.current_=this.count-1;const n=(r=this.count,parseInt(Array(r+1).join("1"),2));var r;this.bits_=t+1&n}nextBitIsOne(){const t=!(this.bits_&1<<this.current_);return this.current_--,t}}const To=function(t,e,n,r){t.sort(e);const i=function(e,r){const o=r-e;let s,a;if(0===o)return null;if(1===o)return s=t[e],a=n?n(s):s,new fo(a,s.node,fo.BLACK,null,null);{const c=parseInt(o/2,10)+e,u=i(e,c),l=i(c+1,r);return s=t[c],a=n?n(s):s,new fo(a,s.node,fo.BLACK,u,l)}},o=function(e){let r=null,o=null,s=t.length;const a=function(e,r){const o=s-e,a=s;s-=e;const u=i(o+1,a),l=t[o],h=n?n(l):l;c(new fo(h,l.node,r,null,u))},c=function(t){r?(r.left=t,r=t):(o=t,r=t)};for(let t=0;t<e.count;++t){const n=e.nextBitIsOne(),r=Math.pow(2,e.count-(t+1));n?a(r,fo.BLACK):(a(r,fo.BLACK),a(r,fo.RED))}return o}(new Io(t.length));return new po(r||e,o)};let xo;const Po={};class Lo{constructor(t,e){this.indexes_=t,this.indexSet_=e}static get Default(){return ke(Po&&So,"ChildrenNode.ts has not been loaded"),xo=xo||new Lo({".priority":Po},{".priority":So}),xo}get(t){const e=Ye(this.indexes_,t);if(!e)throw new Error("No index defined for "+t);return e instanceof po?e:null}hasIndex(t){return $e(this.indexSet_,t.toString())}addIndex(t,e){ke(t!==lo,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const n=[];let r=!1;const i=e.getIterator(so.Wrap);let o,s=i.getNext();for(;s;)r=r||t.isDefinedOn(s.node),n.push(s),s=i.getNext();o=r?To(n,t.getCompare()):Po;const a=t.toString(),c=Object.assign({},this.indexSet_);c[a]=t;const u=Object.assign({},this.indexes_);return u[a]=o,new Lo(u,c)}addToIndexes(t,e){const n=Qe(this.indexes_,((n,r)=>{const i=Ye(this.indexSet_,r);if(ke(i,"Missing index implementation for "+r),n===Po){if(i.isDefinedOn(t.node)){const n=[],r=e.getIterator(so.Wrap);let o=r.getNext();for(;o;)o.name!==t.name&&n.push(o),o=r.getNext();return n.push(t),To(n,i.getCompare())}return Po}{const r=e.get(t.name);let i=n;return r&&(i=i.remove(new so(t.name,r))),i.insert(t,t.node)}}));return new Lo(n,this.indexSet_)}removeFromIndexes(t,e){const n=Qe(this.indexes_,(n=>{if(n===Po)return n;{const r=e.get(t.name);return r?n.remove(new so(t.name,r)):n}}));return new Lo(n,this.indexSet_)}}let No;class Oo{constructor(t,e,n){this.children_=t,this.priorityNode_=e,this.indexMap_=n,this.lazyHash_=null,this.priorityNode_&&_o(this.priorityNode_),this.children_.isEmpty()&&ke(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return No||(No=new Oo(new po(yo),null,Lo.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||No}updatePriority(t){return this.children_.isEmpty()?this:new Oo(this.children_,t,this.indexMap_)}getImmediateChild(t){if(".priority"===t)return this.getPriority();{const e=this.children_.get(t);return null===e?No:e}}getChild(t){const e=Wi(t);return null===e?this:this.getImmediateChild(e).getChild(Vi(t))}hasChild(t){return null!==this.children_.get(t)}updateImmediateChild(t,e){if(ke(e,"We should always be passing snapshot nodes"),".priority"===t)return this.updatePriority(e);{const n=new so(t,e);let r,i;e.isEmpty()?(r=this.children_.remove(t),i=this.indexMap_.removeFromIndexes(n,this.children_)):(r=this.children_.insert(t,e),i=this.indexMap_.addToIndexes(n,this.children_));const o=r.isEmpty()?No:this.priorityNode_;return new Oo(r,o,i)}}updateChild(t,e){const n=Wi(t);if(null===n)return e;{ke(".priority"!==Wi(t)||1===Hi(t),".priority must be the last token in a path");const r=this.getImmediateChild(n).updateChild(Vi(t),e);return this.updateImmediateChild(n,r)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(t){if(this.isEmpty())return null;const e={};let n=0,r=0,i=!0;if(this.forEachChild(So,((o,s)=>{e[o]=s.val(t),n++,i&&Oo.INTEGER_REGEXP_.test(o)?r=Math.max(r,Number(o)):i=!1})),!t&&i&&r<2*n){const t=[];for(const n in e)t[n]=e[n];return t}return t&&!this.getPriority().isEmpty()&&(e[".priority"]=this.getPriority().val()),e}hash(){if(null===this.lazyHash_){let t="";this.getPriority().isEmpty()||(t+="priority:"+go(this.getPriority().val())+":"),this.forEachChild(So,((e,n)=>{const r=n.hash();""!==r&&(t+=":"+e+":"+r)})),this.lazyHash_=""===t?"":$r(t)}return this.lazyHash_}getPredecessorChildName(t,e,n){const r=this.resolveIndex_(n);if(r){const n=r.getPredecessorKey(new so(t,e));return n?n.name:null}return this.children_.getPredecessorKey(t)}getFirstChildName(t){const e=this.resolveIndex_(t);if(e){const t=e.minKey();return t&&t.name}return this.children_.minKey()}getFirstChild(t){const e=this.getFirstChildName(t);return e?new so(e,this.children_.get(e)):null}getLastChildName(t){const e=this.resolveIndex_(t);if(e){const t=e.maxKey();return t&&t.name}return this.children_.maxKey()}getLastChild(t){const e=this.getLastChildName(t);return e?new so(e,this.children_.get(e)):null}forEachChild(t,e){const n=this.resolveIndex_(t);return n?n.inorderTraversal((t=>e(t.name,t.node))):this.children_.inorderTraversal(e)}getIterator(t){return this.getIteratorFrom(t.minPost(),t)}getIteratorFrom(t,e){const n=this.resolveIndex_(e);if(n)return n.getIteratorFrom(t,(t=>t));{const n=this.children_.getIteratorFrom(t.name,so.Wrap);let r=n.peek();for(;null!=r&&e.compare(r,t)<0;)n.getNext(),r=n.peek();return n}}getReverseIterator(t){return this.getReverseIteratorFrom(t.maxPost(),t)}getReverseIteratorFrom(t,e){const n=this.resolveIndex_(e);if(n)return n.getReverseIteratorFrom(t,(t=>t));{const n=this.children_.getReverseIteratorFrom(t.name,so.Wrap);let r=n.peek();for(;null!=r&&e.compare(r,t)>0;)n.getNext(),r=n.peek();return n}}compareTo(t){return this.isEmpty()?t.isEmpty()?0:-1:t.isLeafNode()||t.isEmpty()?1:t===Do?-1:0}withIndex(t){if(t===lo||this.indexMap_.hasIndex(t))return this;{const e=this.indexMap_.addIndex(t,this.children_);return new Oo(this.children_,this.priorityNode_,e)}}isIndexed(t){return t===lo||this.indexMap_.hasIndex(t)}equals(t){if(t===this)return!0;if(t.isLeafNode())return!1;{const e=t;if(this.getPriority().equals(e.getPriority())){if(this.children_.count()===e.children_.count()){const t=this.getIterator(So),n=e.getIterator(So);let r=t.getNext(),i=n.getNext();for(;r&&i;){if(r.name!==i.name||!r.node.equals(i.node))return!1;r=t.getNext(),i=n.getNext()}return null===r&&null===i}return!1}return!1}}resolveIndex_(t){return t===lo?null:this.indexMap_.get(t.toString())}}Oo.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;const Do=new class extends Oo{constructor(){super(new po(yo),Oo.EMPTY_NODE,Lo.Default)}compareTo(t){return t===this?0:1}equals(t){return t===this}getPriority(){return this}getImmediateChild(t){return Oo.EMPTY_NODE}isEmpty(){return!1}};Object.defineProperties(so,{MIN:{value:new so(ri,Oo.EMPTY_NODE)},MAX:{value:new so(ii,Do)}}),uo.__EMPTY_NODE=Oo.EMPTY_NODE,Eo.__childrenNodeConstructor=Oo,vo=Do,Co=Do;const Ao=!0;function Ro(t,e=null){if(null===t)return Oo.EMPTY_NODE;if("object"==typeof t&&".priority"in t&&(e=t[".priority"]),ke(null===e||"string"==typeof e||"number"==typeof e||"object"==typeof e&&".sv"in e,"Invalid priority type found: "+typeof e),"object"==typeof t&&".value"in t&&null!==t[".value"]&&(t=t[".value"]),"object"!=typeof t||".sv"in t)return new Eo(t,Ro(e));if(t instanceof Array||!Ao){let n=Oo.EMPTY_NODE;return li(t,((e,r)=>{if($e(t,e)&&"."!==e.substring(0,1)){const t=Ro(r);!t.isLeafNode()&&t.isEmpty()||(n=n.updateImmediateChild(e,t))}})),n.updatePriority(Ro(e))}{const n=[];let r=!1;if(li(t,((t,e)=>{if("."!==t.substring(0,1)){const i=Ro(e);i.isEmpty()||(r=r||!i.getPriority().isEmpty(),n.push(new so(t,i)))}})),0===n.length)return Oo.EMPTY_NODE;const i=To(n,mo,(t=>t.name),yo);if(r){const t=To(n,So.getCompare());return new Oo(i,Ro(e),new Lo({".priority":t},{".priority":So}))}return new Oo(i,Ro(e),Lo.Default)}}!function(t){wo=t}(Ro);class Mo extends ao{constructor(t){super(),this.indexPath_=t,ke(!Qi(t)&&".priority"!==Wi(t),"Can't create PathIndex with empty path or .priority key")}extractChild(t){return t.getChild(this.indexPath_)}isDefinedOn(t){return!t.getChild(this.indexPath_).isEmpty()}compare(t,e){const n=this.extractChild(t.node),r=this.extractChild(e.node),i=n.compareTo(r);return 0===i?oi(t.name,e.name):i}makePost(t,e){const n=Ro(t),r=Oo.EMPTY_NODE.updateChild(this.indexPath_,n);return new so(e,r)}maxPost(){const t=Oo.EMPTY_NODE.updateChild(this.indexPath_,Do);return new so(ii,t)}toString(){return $i(this.indexPath_,0).join("/")}}const jo=new class extends ao{compare(t,e){const n=t.node.compareTo(e.node);return 0===n?oi(t.name,e.name):n}isDefinedOn(t){return!0}indexedValueChanged(t,e){return!t.equals(e)}minPost(){return so.MIN}maxPost(){return so.MAX}makePost(t,e){const n=Ro(t);return new so(e,n)}toString(){return".value"}};function Fo(t){return{type:"value",snapshotNode:t}}function qo(t,e){return{type:"child_added",snapshotNode:e,childName:t}}function zo(t,e){return{type:"child_removed",snapshotNode:e,childName:t}}function Bo(t,e,n){return{type:"child_changed",snapshotNode:e,childName:t,oldSnap:n}}class Uo{constructor(t){this.index_=t}updateChild(t,e,n,r,i,o){ke(t.isIndexed(this.index_),"A node must be indexed if only a child is updated");const s=t.getImmediateChild(e);return s.getChild(r).equals(n.getChild(r))&&s.isEmpty()===n.isEmpty()?t:(null!=o&&(n.isEmpty()?t.hasChild(e)?o.trackChildChange(zo(e,s)):ke(t.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):s.isEmpty()?o.trackChildChange(qo(e,n)):o.trackChildChange(Bo(e,n,s))),t.isLeafNode()&&n.isEmpty()?t:t.updateImmediateChild(e,n).withIndex(this.index_))}updateFullNode(t,e,n){return null!=n&&(t.isLeafNode()||t.forEachChild(So,((t,r)=>{e.hasChild(t)||n.trackChildChange(zo(t,r))})),e.isLeafNode()||e.forEachChild(So,((e,r)=>{if(t.hasChild(e)){const i=t.getImmediateChild(e);i.equals(r)||n.trackChildChange(Bo(e,r,i))}else n.trackChildChange(qo(e,r))}))),e.withIndex(this.index_)}updatePriority(t,e){return t.isEmpty()?Oo.EMPTY_NODE:t.updatePriority(e)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}class Wo{constructor(t){this.indexedFilter_=new Uo(t.getIndex()),this.index_=t.getIndex(),this.startPost_=Wo.getStartPost_(t),this.endPost_=Wo.getEndPost_(t),this.startIsInclusive_=!t.startAfterSet_,this.endIsInclusive_=!t.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(t){const e=this.startIsInclusive_?this.index_.compare(this.getStartPost(),t)<=0:this.index_.compare(this.getStartPost(),t)<0,n=this.endIsInclusive_?this.index_.compare(t,this.getEndPost())<=0:this.index_.compare(t,this.getEndPost())<0;return e&&n}updateChild(t,e,n,r,i,o){return this.matches(new so(e,n))||(n=Oo.EMPTY_NODE),this.indexedFilter_.updateChild(t,e,n,r,i,o)}updateFullNode(t,e,n){e.isLeafNode()&&(e=Oo.EMPTY_NODE);let r=e.withIndex(this.index_);r=r.updatePriority(Oo.EMPTY_NODE);const i=this;return e.forEachChild(So,((t,e)=>{i.matches(new so(t,e))||(r=r.updateImmediateChild(t,Oo.EMPTY_NODE))})),this.indexedFilter_.updateFullNode(t,r,n)}updatePriority(t,e){return t}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(t){if(t.hasStart()){const e=t.getIndexStartName();return t.getIndex().makePost(t.getIndexStartValue(),e)}return t.getIndex().minPost()}static getEndPost_(t){if(t.hasEnd()){const e=t.getIndexEndName();return t.getIndex().makePost(t.getIndexEndValue(),e)}return t.getIndex().maxPost()}}class Ho{constructor(t){this.withinDirectionalStart=t=>this.reverse_?this.withinEndPost(t):this.withinStartPost(t),this.withinDirectionalEnd=t=>this.reverse_?this.withinStartPost(t):this.withinEndPost(t),this.withinStartPost=t=>{const e=this.index_.compare(this.rangedFilter_.getStartPost(),t);return this.startIsInclusive_?e<=0:e<0},this.withinEndPost=t=>{const e=this.index_.compare(t,this.rangedFilter_.getEndPost());return this.endIsInclusive_?e<=0:e<0},this.rangedFilter_=new Wo(t),this.index_=t.getIndex(),this.limit_=t.getLimit(),this.reverse_=!t.isViewFromLeft(),this.startIsInclusive_=!t.startAfterSet_,this.endIsInclusive_=!t.endBeforeSet_}updateChild(t,e,n,r,i,o){return this.rangedFilter_.matches(new so(e,n))||(n=Oo.EMPTY_NODE),t.getImmediateChild(e).equals(n)?t:t.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(t,e,n,r,i,o):this.fullLimitUpdateChild_(t,e,n,i,o)}updateFullNode(t,e,n){let r;if(e.isLeafNode()||e.isEmpty())r=Oo.EMPTY_NODE.withIndex(this.index_);else if(2*this.limit_<e.numChildren()&&e.isIndexed(this.index_)){let t;r=Oo.EMPTY_NODE.withIndex(this.index_),t=this.reverse_?e.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):e.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let n=0;for(;t.hasNext()&&n<this.limit_;){const e=t.getNext();if(this.withinDirectionalStart(e)){if(!this.withinDirectionalEnd(e))break;r=r.updateImmediateChild(e.name,e.node),n++}}}else{let t;r=e.withIndex(this.index_),r=r.updatePriority(Oo.EMPTY_NODE),t=this.reverse_?r.getReverseIterator(this.index_):r.getIterator(this.index_);let n=0;for(;t.hasNext();){const e=t.getNext();n<this.limit_&&this.withinDirectionalStart(e)&&this.withinDirectionalEnd(e)?n++:r=r.updateImmediateChild(e.name,Oo.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(t,r,n)}updatePriority(t,e){return t}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(t,e,n,r,i){let o;if(this.reverse_){const t=this.index_.getCompare();o=(e,n)=>t(n,e)}else o=this.index_.getCompare();const s=t;ke(s.numChildren()===this.limit_,"");const a=new so(e,n),c=this.reverse_?s.getFirstChild(this.index_):s.getLastChild(this.index_),u=this.rangedFilter_.matches(a);if(s.hasChild(e)){const t=s.getImmediateChild(e);let l=r.getChildAfterChild(this.index_,c,this.reverse_);for(;null!=l&&(l.name===e||s.hasChild(l.name));)l=r.getChildAfterChild(this.index_,l,this.reverse_);const h=null==l?1:o(l,a);if(u&&!n.isEmpty()&&h>=0)return null!=i&&i.trackChildChange(Bo(e,n,t)),s.updateImmediateChild(e,n);{null!=i&&i.trackChildChange(zo(e,t));const n=s.updateImmediateChild(e,Oo.EMPTY_NODE);return null!=l&&this.rangedFilter_.matches(l)?(null!=i&&i.trackChildChange(qo(l.name,l.node)),n.updateImmediateChild(l.name,l.node)):n}}return n.isEmpty()?t:u&&o(c,a)>=0?(null!=i&&(i.trackChildChange(zo(c.name,c.node)),i.trackChildChange(qo(e,n))),s.updateImmediateChild(e,n).updateImmediateChild(c.name,Oo.EMPTY_NODE)):t}}class Vo{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=So}hasStart(){return this.startSet_}isViewFromLeft(){return""===this.viewFrom_?this.startSet_:"l"===this.viewFrom_}getIndexStartValue(){return ke(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return ke(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:ri}hasEnd(){return this.endSet_}getIndexEndValue(){return ke(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return ke(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:ii}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&""!==this.viewFrom_}getLimit(){return ke(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===So}copy(){const t=new Vo;return t.limitSet_=this.limitSet_,t.limit_=this.limit_,t.startSet_=this.startSet_,t.startAfterSet_=this.startAfterSet_,t.indexStartValue_=this.indexStartValue_,t.startNameSet_=this.startNameSet_,t.indexStartName_=this.indexStartName_,t.endSet_=this.endSet_,t.endBeforeSet_=this.endBeforeSet_,t.indexEndValue_=this.indexEndValue_,t.endNameSet_=this.endNameSet_,t.indexEndName_=this.indexEndName_,t.index_=this.index_,t.viewFrom_=this.viewFrom_,t}}function Go(t){const e={};if(t.isDefault())return e;let n;if(t.index_===So?n="$priority":t.index_===jo?n="$value":t.index_===lo?n="$key":(ke(t.index_ instanceof Mo,"Unrecognized index type!"),n=t.index_.toString()),e.orderBy=Ve(n),t.startSet_){const n=t.startAfterSet_?"startAfter":"startAt";e[n]=Ve(t.indexStartValue_),t.startNameSet_&&(e[n]+=","+Ve(t.indexStartName_))}if(t.endSet_){const n=t.endBeforeSet_?"endBefore":"endAt";e[n]=Ve(t.indexEndValue_),t.endNameSet_&&(e[n]+=","+Ve(t.indexEndName_))}return t.limitSet_&&(t.isViewFromLeft()?e.limitToFirst=t.limit_:e.limitToLast=t.limit_),e}function $o(t){const e={};if(t.startSet_&&(e.sp=t.indexStartValue_,t.startNameSet_&&(e.sn=t.indexStartName_),e.sin=!t.startAfterSet_),t.endSet_&&(e.ep=t.indexEndValue_,t.endNameSet_&&(e.en=t.indexEndName_),e.ein=!t.endBeforeSet_),t.limitSet_){e.l=t.limit_;let n=t.viewFrom_;""===n&&(n=t.isViewFromLeft()?"l":"r"),e.vf=n}return t.index_!==So&&(e.i=t.index_.toString()),e}class Yo extends Fi{constructor(t,e,n,r){super(),this.repoInfo_=t,this.onDataUpdate_=e,this.authTokenProvider_=n,this.appCheckTokenProvider_=r,this.log_=Xr("p:rest:"),this.listens_={}}reportStats(t){throw new Error("Method not implemented.")}static getListenId_(t,e){return void 0!==e?"tag$"+e:(ke(t._queryParams.isDefault(),"should have a tag if it's not a default query."),t._path.toString())}listen(t,e,n,r){const i=t._path.toString();this.log_("Listen called for "+i+" "+t._queryIdentifier);const o=Yo.getListenId_(t,n),s={};this.listens_[o]=s;const a=Go(t._queryParams);this.restRequest_(i+".json",a,((t,e)=>{let a=e;if(404===t&&(a=null,t=null),null===t&&this.onDataUpdate_(i,a,!1,n),Ye(this.listens_,o)===s){let e;e=t?401===t?"permission_denied":"rest_error:"+t:"ok",r(e,null)}}))}unlisten(t,e){const n=Yo.getListenId_(t,e);delete this.listens_[n]}get(t){const e=Go(t._queryParams),n=t._path.toString(),r=new je;return this.restRequest_(n+".json",e,((t,e)=>{let i=e;404===t&&(i=null,t=null),null===t?(this.onDataUpdate_(n,i,!1,null),r.resolve(i)):r.reject(new Error(i))})),r.promise}refreshAuthToken(t){}restRequest_(t,e={},n){return e.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then((([r,i])=>{r&&r.accessToken&&(e.auth=r.accessToken),i&&i.token&&(e.ac=i.token);const o=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+t+"?ns="+this.repoInfo_.namespace+function(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach((t=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(t))})):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}(e);this.log_("Sending REST request for "+o);const s=new XMLHttpRequest;s.onreadystatechange=()=>{if(n&&4===s.readyState){this.log_("REST Response for "+o+" received. status:",s.status,"response:",s.responseText);let t=null;if(s.status>=200&&s.status<300){try{t=He(s.responseText)}catch(t){ei("Failed to parse JSON response for "+o+": "+s.responseText)}n(null,t)}else 401!==s.status&&404!==s.status&&ei("Got unsuccessful REST response for "+o+" Status: "+s.status),n(s.status);n=null}},s.open("GET",o,!0),s.send()}))}}class Ko{constructor(){this.rootNode_=Oo.EMPTY_NODE}getNode(t){return this.rootNode_.getChild(t)}updateSnapshot(t,e){this.rootNode_=this.rootNode_.updateChild(t,e)}}function Qo(){return{value:null,children:new Map}}function Jo(t,e,n){if(Qi(e))t.value=n,t.children.clear();else if(null!==t.value)t.value=t.value.updateChild(e,n);else{const r=Wi(e);t.children.has(r)||t.children.set(r,Qo()),Jo(t.children.get(r),e=Vi(e),n)}}function Xo(t,e,n){null!==t.value?n(e,t.value):function(t,e){t.children.forEach(((t,n)=>{e(n,t)}))}(t,((t,r)=>{Xo(r,new Bi(e.toString()+"/"+t),n)}))}class Zo{constructor(t){this.collection_=t,this.last_=null}get(){const t=this.collection_.get(),e=Object.assign({},t);return this.last_&&li(this.last_,((t,n)=>{e[t]=e[t]-n})),this.last_=t,e}}class ts{constructor(t,e){this.server_=e,this.statsToReport_={},this.statsListener_=new Zo(t);const n=1e4+2e4*Math.random();mi(this.reportStats_.bind(this),Math.floor(n))}reportStats_(){const t=this.statsListener_.get(),e={};let n=!1;li(t,((t,r)=>{r>0&&$e(this.statsToReport_,t)&&(e[t]=r,n=!0)})),n&&this.server_.reportStats(e),mi(this.reportStats_.bind(this),Math.floor(2*Math.random()*3e5))}}var es;function ns(t){return{fromUser:!1,fromServer:!0,queryId:t,tagged:!0}}!function(t){t[t.OVERWRITE=0]="OVERWRITE",t[t.MERGE=1]="MERGE",t[t.ACK_USER_WRITE=2]="ACK_USER_WRITE",t[t.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"}(es||(es={}));class rs{constructor(t,e,n){this.path=t,this.affectedTree=e,this.revert=n,this.type=es.ACK_USER_WRITE,this.source={fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}operationForChild(t){if(Qi(this.path)){if(null!=this.affectedTree.value)return ke(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const e=this.affectedTree.subtree(new Bi(t));return new rs(Ui(),e,this.revert)}}return ke(Wi(this.path)===t,"operationForChild called for unrelated child."),new rs(Vi(this.path),this.affectedTree,this.revert)}}class is{constructor(t,e){this.source=t,this.path=e,this.type=es.LISTEN_COMPLETE}operationForChild(t){return Qi(this.path)?new is(this.source,Ui()):new is(this.source,Vi(this.path))}}class os{constructor(t,e,n){this.source=t,this.path=e,this.snap=n,this.type=es.OVERWRITE}operationForChild(t){return Qi(this.path)?new os(this.source,Ui(),this.snap.getImmediateChild(t)):new os(this.source,Vi(this.path),this.snap)}}class ss{constructor(t,e,n){this.source=t,this.path=e,this.children=n,this.type=es.MERGE}operationForChild(t){if(Qi(this.path)){const e=this.children.subtree(new Bi(t));return e.isEmpty()?null:e.value?new os(this.source,Ui(),e.value):new ss(this.source,Ui(),e)}return ke(Wi(this.path)===t,"Can't get a merge for a child not on the path of the operation"),new ss(this.source,Vi(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}class as{constructor(t,e,n){this.node_=t,this.fullyInitialized_=e,this.filtered_=n}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(t){if(Qi(t))return this.isFullyInitialized()&&!this.filtered_;const e=Wi(t);return this.isCompleteForChild(e)}isCompleteForChild(t){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(t)}getNode(){return this.node_}}class cs{constructor(t){this.query_=t,this.index_=this.query_._queryParams.getIndex()}}function us(t,e,n,r,i,o){const s=r.filter((t=>t.type===n));s.sort(((e,n)=>function(t,e,n){if(null==e.childName||null==n.childName)throw Ie("Should only compare child_ events.");const r=new so(e.childName,e.snapshotNode),i=new so(n.childName,n.snapshotNode);return t.index_.compare(r,i)}(t,e,n))),s.forEach((n=>{const r=function(t,e,n){return"value"===e.type||"child_removed"===e.type||(e.prevName=n.getPredecessorChildName(e.childName,e.snapshotNode,t.index_)),e}(t,n,o);i.forEach((i=>{i.respondsTo(n.type)&&e.push(i.createEvent(r,t.query_))}))}))}function ls(t,e){return{eventCache:t,serverCache:e}}function hs(t,e,n,r){return ls(new as(e,n,r),t.serverCache)}function ds(t,e,n,r){return ls(t.eventCache,new as(e,n,r))}function fs(t){return t.eventCache.isFullyInitialized()?t.eventCache.getNode():null}function ps(t){return t.serverCache.isFullyInitialized()?t.serverCache.getNode():null}let ms;class ys{constructor(t,e=(()=>(ms||(ms=new po(si)),ms))()){this.value=t,this.children=e}static fromObject(t){let e=new ys(null);return li(t,((t,n)=>{e=e.set(new Bi(t),n)})),e}isEmpty(){return null===this.value&&this.children.isEmpty()}findRootMostMatchingPathAndValue(t,e){if(null!=this.value&&e(this.value))return{path:Ui(),value:this.value};if(Qi(t))return null;{const n=Wi(t),r=this.children.get(n);if(null!==r){const i=r.findRootMostMatchingPathAndValue(Vi(t),e);return null!=i?{path:Ki(new Bi(n),i.path),value:i.value}:null}return null}}findRootMostValueAndPath(t){return this.findRootMostMatchingPathAndValue(t,(()=>!0))}subtree(t){if(Qi(t))return this;{const e=Wi(t),n=this.children.get(e);return null!==n?n.subtree(Vi(t)):new ys(null)}}set(t,e){if(Qi(t))return new ys(e,this.children);{const n=Wi(t),r=(this.children.get(n)||new ys(null)).set(Vi(t),e),i=this.children.insert(n,r);return new ys(this.value,i)}}remove(t){if(Qi(t))return this.children.isEmpty()?new ys(null):new ys(null,this.children);{const e=Wi(t),n=this.children.get(e);if(n){const r=n.remove(Vi(t));let i;return i=r.isEmpty()?this.children.remove(e):this.children.insert(e,r),null===this.value&&i.isEmpty()?new ys(null):new ys(this.value,i)}return this}}get(t){if(Qi(t))return this.value;{const e=Wi(t),n=this.children.get(e);return n?n.get(Vi(t)):null}}setTree(t,e){if(Qi(t))return e;{const n=Wi(t),r=(this.children.get(n)||new ys(null)).setTree(Vi(t),e);let i;return i=r.isEmpty()?this.children.remove(n):this.children.insert(n,r),new ys(this.value,i)}}fold(t){return this.fold_(Ui(),t)}fold_(t,e){const n={};return this.children.inorderTraversal(((r,i)=>{n[r]=i.fold_(Ki(t,r),e)})),e(t,this.value,n)}findOnPath(t,e){return this.findOnPath_(t,Ui(),e)}findOnPath_(t,e,n){const r=!!this.value&&n(e,this.value);if(r)return r;if(Qi(t))return null;{const r=Wi(t),i=this.children.get(r);return i?i.findOnPath_(Vi(t),Ki(e,r),n):null}}foreachOnPath(t,e){return this.foreachOnPath_(t,Ui(),e)}foreachOnPath_(t,e,n){if(Qi(t))return this;{this.value&&n(e,this.value);const r=Wi(t),i=this.children.get(r);return i?i.foreachOnPath_(Vi(t),Ki(e,r),n):new ys(null)}}foreach(t){this.foreach_(Ui(),t)}foreach_(t,e){this.children.inorderTraversal(((n,r)=>{r.foreach_(Ki(t,n),e)})),this.value&&e(t,this.value)}foreachChild(t){this.children.inorderTraversal(((e,n)=>{n.value&&t(e,n.value)}))}}class vs{constructor(t){this.writeTree_=t}static empty(){return new vs(new ys(null))}}function gs(t,e,n){if(Qi(e))return new vs(new ys(n));{const r=t.writeTree_.findRootMostValueAndPath(e);if(null!=r){const i=r.path;let o=r.value;const s=Ji(i,e);return o=o.updateChild(s,n),new vs(t.writeTree_.set(i,o))}{const r=new ys(n),i=t.writeTree_.setTree(e,r);return new vs(i)}}}function _s(t,e,n){let r=t;return li(n,((t,n)=>{r=gs(r,Ki(e,t),n)})),r}function bs(t,e){if(Qi(e))return vs.empty();{const n=t.writeTree_.setTree(e,new ys(null));return new vs(n)}}function ws(t,e){return null!=Cs(t,e)}function Cs(t,e){const n=t.writeTree_.findRootMostValueAndPath(e);return null!=n?t.writeTree_.get(n.path).getChild(Ji(n.path,e)):null}function Es(t){const e=[],n=t.writeTree_.value;return null!=n?n.isLeafNode()||n.forEachChild(So,((t,n)=>{e.push(new so(t,n))})):t.writeTree_.children.inorderTraversal(((t,n)=>{null!=n.value&&e.push(new so(t,n.value))})),e}function Ss(t,e){if(Qi(e))return t;{const n=Cs(t,e);return new vs(null!=n?new ys(n):t.writeTree_.subtree(e))}}function ks(t){return t.writeTree_.isEmpty()}function Is(t,e){return Ts(Ui(),t.writeTree_,e)}function Ts(t,e,n){if(null!=e.value)return n.updateChild(t,e.value);{let r=null;return e.children.inorderTraversal(((e,i)=>{".priority"===e?(ke(null!==i.value,"Priority writes must always be leaf nodes"),r=i.value):n=Ts(Ki(t,e),i,n)})),n.getChild(t).isEmpty()||null===r||(n=n.updateChild(Ki(t,".priority"),r)),n}}function xs(t,e){return qs(e,t)}function Ps(t,e){if(t.snap)return Zi(t.path,e);for(const n in t.children)if(t.children.hasOwnProperty(n)&&Zi(Ki(t.path,n),e))return!0;return!1}function Ls(t){return t.visible}function Ns(t,e,n){let r=vs.empty();for(let i=0;i<t.length;++i){const o=t[i];if(e(o)){const t=o.path;let e;if(o.snap)Zi(n,t)?(e=Ji(n,t),r=gs(r,e,o.snap)):Zi(t,n)&&(e=Ji(t,n),r=gs(r,Ui(),o.snap.getChild(e)));else{if(!o.children)throw Ie("WriteRecord should have .snap or .children");if(Zi(n,t))e=Ji(n,t),r=_s(r,e,o.children);else if(Zi(t,n))if(e=Ji(t,n),Qi(e))r=_s(r,Ui(),o.children);else{const t=Ye(o.children,Wi(e));if(t){const n=t.getChild(Vi(e));r=gs(r,Ui(),n)}}}}}return r}function Os(t,e,n,r,i){if(r||i){const o=Ss(t.visibleWrites,e);if(!i&&ks(o))return n;if(i||null!=n||ws(o,Ui())){const o=function(t){return(t.visible||i)&&(!r||!~r.indexOf(t.writeId))&&(Zi(t.path,e)||Zi(e,t.path))};return Is(Ns(t.allWrites,o,e),n||Oo.EMPTY_NODE)}return null}{const r=Cs(t.visibleWrites,e);if(null!=r)return r;{const r=Ss(t.visibleWrites,e);return ks(r)?n:null!=n||ws(r,Ui())?Is(r,n||Oo.EMPTY_NODE):null}}}function Ds(t,e,n,r){return Os(t.writeTree,t.treePath,e,n,r)}function As(t,e){return function(t,e,n){let r=Oo.EMPTY_NODE;const i=Cs(t.visibleWrites,e);if(i)return i.isLeafNode()||i.forEachChild(So,((t,e)=>{r=r.updateImmediateChild(t,e)})),r;if(n){const i=Ss(t.visibleWrites,e);return n.forEachChild(So,((t,e)=>{const n=Is(Ss(i,new Bi(t)),e);r=r.updateImmediateChild(t,n)})),Es(i).forEach((t=>{r=r.updateImmediateChild(t.name,t.node)})),r}return Es(Ss(t.visibleWrites,e)).forEach((t=>{r=r.updateImmediateChild(t.name,t.node)})),r}(t.writeTree,t.treePath,e)}function Rs(t,e,n,r){return function(t,e,n,r,i){ke(r||i,"Either existingEventSnap or existingServerSnap must exist");const o=Ki(e,n);if(ws(t.visibleWrites,o))return null;{const e=Ss(t.visibleWrites,o);return ks(e)?i.getChild(n):Is(e,i.getChild(n))}}(t.writeTree,t.treePath,e,n,r)}function Ms(t,e){return function(t,e){return Cs(t.visibleWrites,e)}(t.writeTree,Ki(t.treePath,e))}function js(t,e,n){return function(t,e,n,r){const i=Ki(e,n),o=Cs(t.visibleWrites,i);return null!=o?o:r.isCompleteForChild(n)?Is(Ss(t.visibleWrites,i),r.getNode().getImmediateChild(n)):null}(t.writeTree,t.treePath,e,n)}function Fs(t,e){return qs(Ki(t.treePath,e),t.writeTree)}function qs(t,e){return{treePath:t,writeTree:e}}class zs{constructor(){this.changeMap=new Map}trackChildChange(t){const e=t.type,n=t.childName;ke("child_added"===e||"child_changed"===e||"child_removed"===e,"Only child changes supported for tracking"),ke(".priority"!==n,"Only non-priority child changes can be tracked.");const r=this.changeMap.get(n);if(r){const i=r.type;if("child_added"===e&&"child_removed"===i)this.changeMap.set(n,Bo(n,t.snapshotNode,r.snapshotNode));else if("child_removed"===e&&"child_added"===i)this.changeMap.delete(n);else if("child_removed"===e&&"child_changed"===i)this.changeMap.set(n,zo(n,r.oldSnap));else if("child_changed"===e&&"child_added"===i)this.changeMap.set(n,qo(n,t.snapshotNode));else{if("child_changed"!==e||"child_changed"!==i)throw Ie("Illegal combination of changes: "+t+" occurred after "+r);this.changeMap.set(n,Bo(n,t.snapshotNode,r.oldSnap))}}else this.changeMap.set(n,t)}getChanges(){return Array.from(this.changeMap.values())}}const Bs=new class{getCompleteChild(t){return null}getChildAfterChild(t,e,n){return null}};class Us{constructor(t,e,n=null){this.writes_=t,this.viewCache_=e,this.optCompleteServerCache_=n}getCompleteChild(t){const e=this.viewCache_.eventCache;if(e.isCompleteForChild(t))return e.getNode().getImmediateChild(t);{const e=null!=this.optCompleteServerCache_?new as(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return js(this.writes_,t,e)}}getChildAfterChild(t,e,n){const r=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:ps(this.viewCache_),i=function(t,e,n,r,i,o){return function(t,e,n,r,i,o,s){let a;const c=Ss(t.visibleWrites,e),u=Cs(c,Ui());if(null!=u)a=u;else{if(null==n)return[];a=Is(c,n)}if(a=a.withIndex(s),a.isEmpty()||a.isLeafNode())return[];{const t=[],e=s.getCompare(),n=o?a.getReverseIteratorFrom(r,s):a.getIteratorFrom(r,s);let c=n.getNext();for(;c&&t.length<i;)0!==e(c,r)&&t.push(c),c=n.getNext();return t}}(t.writeTree,t.treePath,e,n,r,i,o)}(this.writes_,r,e,1,n,t);return 0===i.length?null:i[0]}}function Ws(t,e,n,r,i,o){const s=e.eventCache;if(null!=Ms(r,n))return e;{let a,c;if(Qi(n))if(ke(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){const n=ps(e),i=As(r,n instanceof Oo?n:Oo.EMPTY_NODE);a=t.filter.updateFullNode(e.eventCache.getNode(),i,o)}else{const n=Ds(r,ps(e));a=t.filter.updateFullNode(e.eventCache.getNode(),n,o)}else{const u=Wi(n);if(".priority"===u){ke(1===Hi(n),"Can't have a priority with additional path components");const i=s.getNode();c=e.serverCache.getNode();const o=Rs(r,n,i,c);a=null!=o?t.filter.updatePriority(i,o):s.getNode()}else{const l=Vi(n);let h;if(s.isCompleteForChild(u)){c=e.serverCache.getNode();const t=Rs(r,n,s.getNode(),c);h=null!=t?s.getNode().getImmediateChild(u).updateChild(l,t):s.getNode().getImmediateChild(u)}else h=js(r,u,e.serverCache);a=null!=h?t.filter.updateChild(s.getNode(),u,h,l,i,o):s.getNode()}}return hs(e,a,s.isFullyInitialized()||Qi(n),t.filter.filtersNodes())}}function Hs(t,e,n,r,i,o,s,a){const c=e.serverCache;let u;const l=s?t.filter:t.filter.getIndexedFilter();if(Qi(n))u=l.updateFullNode(c.getNode(),r,null);else if(l.filtersNodes()&&!c.isFiltered()){const t=c.getNode().updateChild(n,r);u=l.updateFullNode(c.getNode(),t,null)}else{const t=Wi(n);if(!c.isCompleteForPath(n)&&Hi(n)>1)return e;const i=Vi(n),o=c.getNode().getImmediateChild(t).updateChild(i,r);u=".priority"===t?l.updatePriority(c.getNode(),o):l.updateChild(c.getNode(),t,o,i,Bs,null)}const h=ds(e,u,c.isFullyInitialized()||Qi(n),l.filtersNodes());return Ws(t,h,n,i,new Us(i,h,o),a)}function Vs(t,e,n,r,i,o,s){const a=e.eventCache;let c,u;const l=new Us(i,e,o);if(Qi(n))u=t.filter.updateFullNode(e.eventCache.getNode(),r,s),c=hs(e,u,!0,t.filter.filtersNodes());else{const i=Wi(n);if(".priority"===i)u=t.filter.updatePriority(e.eventCache.getNode(),r),c=hs(e,u,a.isFullyInitialized(),a.isFiltered());else{const o=Vi(n),u=a.getNode().getImmediateChild(i);let h;if(Qi(o))h=r;else{const t=l.getCompleteChild(i);h=null!=t?".priority"===Gi(o)&&t.getChild(Yi(o)).isEmpty()?t:t.updateChild(o,r):Oo.EMPTY_NODE}c=u.equals(h)?e:hs(e,t.filter.updateChild(a.getNode(),i,h,o,l,s),a.isFullyInitialized(),t.filter.filtersNodes())}}return c}function Gs(t,e){return t.eventCache.isCompleteForChild(e)}function $s(t,e,n){return n.foreach(((t,n)=>{e=e.updateChild(t,n)})),e}function Ys(t,e,n,r,i,o,s,a){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let c,u=e;c=Qi(n)?r:new ys(null).setTree(n,r);const l=e.serverCache.getNode();return c.children.inorderTraversal(((n,r)=>{if(l.hasChild(n)){const c=$s(0,e.serverCache.getNode().getImmediateChild(n),r);u=Hs(t,u,new Bi(n),c,i,o,s,a)}})),c.children.inorderTraversal(((n,r)=>{const c=!e.serverCache.isCompleteForChild(n)&&null===r.value;if(!l.hasChild(n)&&!c){const c=$s(0,e.serverCache.getNode().getImmediateChild(n),r);u=Hs(t,u,new Bi(n),c,i,o,s,a)}})),u}class Ks{constructor(t,e){this.query_=t,this.eventRegistrations_=[];const n=this.query_._queryParams,r=new Uo(n.getIndex()),i=(o=n).loadsAllData()?new Uo(o.getIndex()):o.hasLimit()?new Ho(o):new Wo(o);var o;this.processor_=function(t){return{filter:t}}(i);const s=e.serverCache,a=e.eventCache,c=r.updateFullNode(Oo.EMPTY_NODE,s.getNode(),null),u=i.updateFullNode(Oo.EMPTY_NODE,a.getNode(),null),l=new as(c,s.isFullyInitialized(),r.filtersNodes()),h=new as(u,a.isFullyInitialized(),i.filtersNodes());this.viewCache_=ls(h,l),this.eventGenerator_=new cs(this.query_)}get query(){return this.query_}}function Qs(t,e){const n=ps(t.viewCache_);return n&&(t.query._queryParams.loadsAllData()||!Qi(e)&&!n.getImmediateChild(Wi(e)).isEmpty())?n.getChild(e):null}function Js(t){return 0===t.eventRegistrations_.length}function Xs(t,e,n){const r=[];if(n){ke(null==e,"A cancel should cancel all event registrations.");const i=t.query._path;t.eventRegistrations_.forEach((t=>{const e=t.createCancelEvent(n,i);e&&r.push(e)}))}if(e){let n=[];for(let r=0;r<t.eventRegistrations_.length;++r){const i=t.eventRegistrations_[r];if(i.matches(e)){if(e.hasAnyCallback()){n=n.concat(t.eventRegistrations_.slice(r+1));break}}else n.push(i)}t.eventRegistrations_=n}else t.eventRegistrations_=[];return r}function Zs(t,e,n,r){e.type===es.MERGE&&null!==e.source.queryId&&(ke(ps(t.viewCache_),"We should always have a full cache before handling merges"),ke(fs(t.viewCache_),"Missing event cache, even though we have a server cache"));const i=t.viewCache_,o=function(t,e,n,r,i){const o=new zs;let s,a;if(n.type===es.OVERWRITE){const c=n;c.source.fromUser?s=Vs(t,e,c.path,c.snap,r,i,o):(ke(c.source.fromServer,"Unknown source."),a=c.source.tagged||e.serverCache.isFiltered()&&!Qi(c.path),s=Hs(t,e,c.path,c.snap,r,i,a,o))}else if(n.type===es.MERGE){const c=n;c.source.fromUser?s=function(t,e,n,r,i,o,s){let a=e;return r.foreach(((r,c)=>{const u=Ki(n,r);Gs(e,Wi(u))&&(a=Vs(t,a,u,c,i,o,s))})),r.foreach(((r,c)=>{const u=Ki(n,r);Gs(e,Wi(u))||(a=Vs(t,a,u,c,i,o,s))})),a}(t,e,c.path,c.children,r,i,o):(ke(c.source.fromServer,"Unknown source."),a=c.source.tagged||e.serverCache.isFiltered(),s=Ys(t,e,c.path,c.children,r,i,a,o))}else if(n.type===es.ACK_USER_WRITE){const a=n;s=a.revert?function(t,e,n,r,i,o){let s;if(null!=Ms(r,n))return e;{const a=new Us(r,e,i),c=e.eventCache.getNode();let u;if(Qi(n)||".priority"===Wi(n)){let n;if(e.serverCache.isFullyInitialized())n=Ds(r,ps(e));else{const t=e.serverCache.getNode();ke(t instanceof Oo,"serverChildren would be complete if leaf node"),n=As(r,t)}u=t.filter.updateFullNode(c,n,o)}else{const i=Wi(n);let l=js(r,i,e.serverCache);null==l&&e.serverCache.isCompleteForChild(i)&&(l=c.getImmediateChild(i)),u=null!=l?t.filter.updateChild(c,i,l,Vi(n),a,o):e.eventCache.getNode().hasChild(i)?t.filter.updateChild(c,i,Oo.EMPTY_NODE,Vi(n),a,o):c,u.isEmpty()&&e.serverCache.isFullyInitialized()&&(s=Ds(r,ps(e)),s.isLeafNode()&&(u=t.filter.updateFullNode(u,s,o)))}return s=e.serverCache.isFullyInitialized()||null!=Ms(r,Ui()),hs(e,u,s,t.filter.filtersNodes())}}(t,e,a.path,r,i,o):function(t,e,n,r,i,o,s){if(null!=Ms(i,n))return e;const a=e.serverCache.isFiltered(),c=e.serverCache;if(null!=r.value){if(Qi(n)&&c.isFullyInitialized()||c.isCompleteForPath(n))return Hs(t,e,n,c.getNode().getChild(n),i,o,a,s);if(Qi(n)){let r=new ys(null);return c.getNode().forEachChild(lo,((t,e)=>{r=r.set(new Bi(t),e)})),Ys(t,e,n,r,i,o,a,s)}return e}{let u=new ys(null);return r.foreach(((t,e)=>{const r=Ki(n,t);c.isCompleteForPath(r)&&(u=u.set(t,c.getNode().getChild(r)))})),Ys(t,e,n,u,i,o,a,s)}}(t,e,a.path,a.affectedTree,r,i,o)}else{if(n.type!==es.LISTEN_COMPLETE)throw Ie("Unknown operation type: "+n.type);s=function(t,e,n,r,i){const o=e.serverCache;return Ws(t,ds(e,o.getNode(),o.isFullyInitialized()||Qi(n),o.isFiltered()),n,r,Bs,i)}(t,e,n.path,r,o)}const c=o.getChanges();return function(t,e,n){const r=e.eventCache;if(r.isFullyInitialized()){const i=r.getNode().isLeafNode()||r.getNode().isEmpty(),o=fs(t);(n.length>0||!t.eventCache.isFullyInitialized()||i&&!r.getNode().equals(o)||!r.getNode().getPriority().equals(o.getPriority()))&&n.push(Fo(fs(e)))}}(e,s,c),{viewCache:s,changes:c}}(t.processor_,i,e,n,r);var s,a;return s=t.processor_,a=o.viewCache,ke(a.eventCache.getNode().isIndexed(s.filter.getIndex()),"Event snap not indexed"),ke(a.serverCache.getNode().isIndexed(s.filter.getIndex()),"Server snap not indexed"),ke(o.viewCache.serverCache.isFullyInitialized()||!i.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),t.viewCache_=o.viewCache,ta(t,o.changes,o.viewCache.eventCache.getNode(),null)}function ta(t,e,n,r){const i=r?[r]:t.eventRegistrations_;return function(t,e,n,r){const i=[],o=[];return e.forEach((e=>{var n;"child_changed"===e.type&&t.index_.indexedValueChanged(e.oldSnap,e.snapshotNode)&&o.push((n=e.childName,{type:"child_moved",snapshotNode:e.snapshotNode,childName:n}))})),us(t,i,"child_removed",e,r,n),us(t,i,"child_added",e,r,n),us(t,i,"child_moved",o,r,n),us(t,i,"child_changed",e,r,n),us(t,i,"value",e,r,n),i}(t.eventGenerator_,e,n,i)}let ea,na;class ra{constructor(){this.views=new Map}}function ia(t,e,n,r){const i=e.source.queryId;if(null!==i){const o=t.views.get(i);return ke(null!=o,"SyncTree gave us an op for an invalid query."),Zs(o,e,n,r)}{let i=[];for(const o of t.views.values())i=i.concat(Zs(o,e,n,r));return i}}function oa(t,e,n,r,i){const o=e._queryIdentifier,s=t.views.get(o);if(!s){let t=Ds(n,i?r:null),o=!1;t?o=!0:r instanceof Oo?(t=As(n,r),o=!1):(t=Oo.EMPTY_NODE,o=!1);const s=ls(new as(t,o,!1),new as(r,i,!1));return new Ks(e,s)}return s}function sa(t){const e=[];for(const n of t.views.values())n.query._queryParams.loadsAllData()||e.push(n);return e}function aa(t,e){let n=null;for(const r of t.views.values())n=n||Qs(r,e);return n}function ca(t,e){if(e._queryParams.loadsAllData())return ha(t);{const n=e._queryIdentifier;return t.views.get(n)}}function ua(t,e){return null!=ca(t,e)}function la(t){return null!=ha(t)}function ha(t){for(const e of t.views.values())if(e.query._queryParams.loadsAllData())return e;return null}let da=1;class fa{constructor(t){this.listenProvider_=t,this.syncPointTree_=new ys(null),this.pendingWriteTree_={visibleWrites:vs.empty(),allWrites:[],lastWriteId:-1},this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function pa(t,e,n,r,i){return function(t,e,n,r,i){ke(r>t.lastWriteId,"Stacking an older write on top of newer ones"),void 0===i&&(i=!0),t.allWrites.push({path:e,snap:n,writeId:r,visible:i}),i&&(t.visibleWrites=gs(t.visibleWrites,e,n)),t.lastWriteId=r}(t.pendingWriteTree_,e,n,r,i),i?wa(t,new os({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},e,n)):[]}function ma(t,e,n=!1){const r=function(t,e){for(let n=0;n<t.allWrites.length;n++){const r=t.allWrites[n];if(r.writeId===e)return r}return null}(t.pendingWriteTree_,e);if(function(t,e){const n=t.allWrites.findIndex((t=>t.writeId===e));ke(n>=0,"removeWrite called with nonexistent writeId.");const r=t.allWrites[n];t.allWrites.splice(n,1);let i=r.visible,o=!1,s=t.allWrites.length-1;for(;i&&s>=0;){const e=t.allWrites[s];e.visible&&(s>=n&&Ps(e,r.path)?i=!1:Zi(r.path,e.path)&&(o=!0)),s--}return!!i&&(o?(function(t){t.visibleWrites=Ns(t.allWrites,Ls,Ui()),t.allWrites.length>0?t.lastWriteId=t.allWrites[t.allWrites.length-1].writeId:t.lastWriteId=-1}(t),!0):(r.snap?t.visibleWrites=bs(t.visibleWrites,r.path):li(r.children,(e=>{t.visibleWrites=bs(t.visibleWrites,Ki(r.path,e))})),!0))}(t.pendingWriteTree_,e)){let e=new ys(null);return null!=r.snap?e=e.set(Ui(),!0):li(r.children,(t=>{e=e.set(new Bi(t),!0)})),wa(t,new rs(r.path,e,n))}return[]}function ya(t,e,n){return wa(t,new os({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},e,n))}function va(t,e,n,r,i=!1){const o=e._path,s=t.syncPointTree_.get(o);let a=[];if(s&&("default"===e._queryIdentifier||ua(s,e))){const c=function(t,e,n,r){const i=e._queryIdentifier,o=[];let s=[];const a=la(t);if("default"===i)for(const[e,i]of t.views.entries())s=s.concat(Xs(i,n,r)),Js(i)&&(t.views.delete(e),i.query._queryParams.loadsAllData()||o.push(i.query));else{const e=t.views.get(i);e&&(s=s.concat(Xs(e,n,r)),Js(e)&&(t.views.delete(i),e.query._queryParams.loadsAllData()||o.push(e.query)))}return a&&!la(t)&&o.push(new(ke(ea,"Reference.ts has not been loaded"),ea)(e._repo,e._path)),{removed:o,events:s}}(s,e,n,r);0===s.views.size&&(t.syncPointTree_=t.syncPointTree_.remove(o));const u=c.removed;if(a=c.events,!i){const n=-1!==u.findIndex((t=>t._queryParams.loadsAllData())),i=t.syncPointTree_.findOnPath(o,((t,e)=>la(e)));if(n&&!i){const e=t.syncPointTree_.subtree(o);if(!e.isEmpty()){const n=function(t){return t.fold(((t,e,n)=>{if(e&&la(e))return[ha(e)];{let t=[];return e&&(t=sa(e)),li(n,((e,n)=>{t=t.concat(n)})),t}}))}(e);for(let e=0;e<n.length;++e){const r=n[e],i=r.query,o=Sa(t,r);t.listenProvider_.startListening(La(i),ka(t,i),o.hashFn,o.onComplete)}}}if(!i&&u.length>0&&!r)if(n){const n=null;t.listenProvider_.stopListening(La(e),n)}else u.forEach((e=>{const n=t.queryToTagMap.get(Ia(e));t.listenProvider_.stopListening(La(e),n)}))}!function(t,e){for(let n=0;n<e.length;++n){const r=e[n];if(!r._queryParams.loadsAllData()){const e=Ia(r),n=t.queryToTagMap.get(e);t.queryToTagMap.delete(e),t.tagToQueryMap.delete(n)}}}(t,u)}return a}function ga(t,e,n,r){const i=Ta(t,r);if(null!=i){const r=xa(i),o=r.path,s=r.queryId,a=Ji(o,e);return Pa(t,o,new os(ns(s),a,n))}return[]}function _a(t,e,n,r=!1){const i=e._path;let o=null,s=!1;t.syncPointTree_.foreachOnPath(i,((t,e)=>{const n=Ji(t,i);o=o||aa(e,n),s=s||la(e)}));let a,c=t.syncPointTree_.get(i);c?(s=s||la(c),o=o||aa(c,Ui())):(c=new ra,t.syncPointTree_=t.syncPointTree_.set(i,c)),null!=o?a=!0:(a=!1,o=Oo.EMPTY_NODE,t.syncPointTree_.subtree(i).foreachChild(((t,e)=>{const n=aa(e,Ui());n&&(o=o.updateImmediateChild(t,n))})));const u=ua(c,e);if(!u&&!e._queryParams.loadsAllData()){const n=Ia(e);ke(!t.queryToTagMap.has(n),"View does not exist, but we have a tag");const r=da++;t.queryToTagMap.set(n,r),t.tagToQueryMap.set(r,n)}let l=function(t,e,n,r,i,o){const s=oa(t,e,r,i,o);return t.views.has(e._queryIdentifier)||t.views.set(e._queryIdentifier,s),function(t,e){t.eventRegistrations_.push(e)}(s,n),function(t,e){const n=t.viewCache_.eventCache,r=[];return n.getNode().isLeafNode()||n.getNode().forEachChild(So,((t,e)=>{r.push(qo(t,e))})),n.isFullyInitialized()&&r.push(Fo(n.getNode())),ta(t,r,n.getNode(),e)}(s,n)}(c,e,n,xs(t.pendingWriteTree_,i),o,a);if(!u&&!s&&!r){const n=ca(c,e);l=l.concat(function(t,e,n){const r=e._path,i=ka(t,e),o=Sa(t,n),s=t.listenProvider_.startListening(La(e),i,o.hashFn,o.onComplete),a=t.syncPointTree_.subtree(r);if(i)ke(!la(a.value),"If we're adding a query, it shouldn't be shadowed");else{const e=a.fold(((t,e,n)=>{if(!Qi(t)&&e&&la(e))return[ha(e).query];{let t=[];return e&&(t=t.concat(sa(e).map((t=>t.query)))),li(n,((e,n)=>{t=t.concat(n)})),t}}));for(let n=0;n<e.length;++n){const r=e[n];t.listenProvider_.stopListening(La(r),ka(t,r))}}return s}(t,e,n))}return l}function ba(t,e,n){const r=t.pendingWriteTree_,i=t.syncPointTree_.findOnPath(e,((t,n)=>{const r=aa(n,Ji(t,e));if(r)return r}));return Os(r,e,i,n,!0)}function wa(t,e){return Ca(e,t.syncPointTree_,null,xs(t.pendingWriteTree_,Ui()))}function Ca(t,e,n,r){if(Qi(t.path))return Ea(t,e,n,r);{const i=e.get(Ui());null==n&&null!=i&&(n=aa(i,Ui()));let o=[];const s=Wi(t.path),a=t.operationForChild(s),c=e.children.get(s);if(c&&a){const t=n?n.getImmediateChild(s):null,e=Fs(r,s);o=o.concat(Ca(a,c,t,e))}return i&&(o=o.concat(ia(i,t,r,n))),o}}function Ea(t,e,n,r){const i=e.get(Ui());null==n&&null!=i&&(n=aa(i,Ui()));let o=[];return e.children.inorderTraversal(((e,i)=>{const s=n?n.getImmediateChild(e):null,a=Fs(r,e),c=t.operationForChild(e);c&&(o=o.concat(Ea(c,i,s,a)))})),i&&(o=o.concat(ia(i,t,r,n))),o}function Sa(t,e){const n=e.query,r=ka(t,n);return{hashFn:()=>{const t=function(t){return t.viewCache_.serverCache.getNode()}(e)||Oo.EMPTY_NODE;return t.hash()},onComplete:e=>{if("ok"===e)return r?function(t,e,n){const r=Ta(t,n);if(r){const n=xa(r),i=n.path,o=n.queryId,s=Ji(i,e);return Pa(t,i,new is(ns(o),s))}return[]}(t,n._path,r):function(t,e){return wa(t,new is({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},e))}(t,n._path);{const r=function(t,e){let n="Unknown Error";"too_big"===t?n="The data requested exceeds the maximum size that can be accessed with a single request.":"permission_denied"===t?n="Client doesn't have permission to access the desired data.":"unavailable"===t&&(n="The service is unavailable");const r=new Error(t+" at "+e._path.toString()+": "+n);return r.code=t.toUpperCase(),r}(e,n);return va(t,n,null,r)}}}}function ka(t,e){const n=Ia(e);return t.queryToTagMap.get(n)}function Ia(t){return t._path.toString()+"$"+t._queryIdentifier}function Ta(t,e){return t.tagToQueryMap.get(e)}function xa(t){const e=t.indexOf("$");return ke(-1!==e&&e<t.length-1,"Bad queryKey."),{queryId:t.substr(e+1),path:new Bi(t.substr(0,e))}}function Pa(t,e,n){const r=t.syncPointTree_.get(e);return ke(r,"Missing sync point for query tag that we're tracking"),ia(r,n,xs(t.pendingWriteTree_,e),null)}function La(t){return t._queryParams.loadsAllData()&&!t._queryParams.isDefault()?new(ke(na,"Reference.ts has not been loaded"),na)(t._repo,t._path):t}class Na{constructor(t){this.node_=t}getImmediateChild(t){const e=this.node_.getImmediateChild(t);return new Na(e)}node(){return this.node_}}class Oa{constructor(t,e){this.syncTree_=t,this.path_=e}getImmediateChild(t){const e=Ki(this.path_,t);return new Oa(this.syncTree_,e)}node(){return ba(this.syncTree_,this.path_)}}const Da=function(t){return(t=t||{}).timestamp=t.timestamp||(new Date).getTime(),t},Aa=function(t,e,n){return t&&"object"==typeof t?(ke(".sv"in t,"Unexpected leaf node or priority contents"),"string"==typeof t[".sv"]?Ra(t[".sv"],e,n):"object"==typeof t[".sv"]?Ma(t[".sv"],e):void ke(!1,"Unexpected server value: "+JSON.stringify(t,null,2))):t},Ra=function(t,e,n){if("timestamp"===t)return n.timestamp;ke(!1,"Unexpected server value: "+t)},Ma=function(t,e,n){t.hasOwnProperty("increment")||ke(!1,"Unexpected server value: "+JSON.stringify(t,null,2));const r=t.increment;"number"!=typeof r&&ke(!1,"Unexpected increment value: "+r);const i=e.node();if(ke(null!=i,"Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return r;const o=i.getValue();return"number"!=typeof o?r:o+r},ja=function(t,e,n,r){return qa(e,new Oa(n,t),r)},Fa=function(t,e,n){return qa(t,new Na(e),n)};function qa(t,e,n){const r=t.getPriority().val(),i=Aa(r,e.getImmediateChild(".priority"),n);let o;if(t.isLeafNode()){const r=t,o=Aa(r.getValue(),e,n);return o!==r.getValue()||i!==r.getPriority().val()?new Eo(o,Ro(i)):t}{const r=t;return o=r,i!==r.getPriority().val()&&(o=o.updatePriority(new Eo(i))),r.forEachChild(So,((t,r)=>{const i=qa(r,e.getImmediateChild(t),n);i!==r&&(o=o.updateImmediateChild(t,i))})),o}}class za{constructor(t="",e=null,n={children:{},childCount:0}){this.name=t,this.parent=e,this.node=n}}function Ba(t,e){let n=e instanceof Bi?e:new Bi(e),r=t,i=Wi(n);for(;null!==i;){const t=Ye(r.node.children,i)||{children:{},childCount:0};r=new za(i,r,t),n=Vi(n),i=Wi(n)}return r}function Ua(t){return t.node.value}function Wa(t,e){t.node.value=e,Ya(t)}function Ha(t){return t.node.childCount>0}function Va(t,e){li(t.node.children,((n,r)=>{e(new za(n,t,r))}))}function Ga(t,e,n,r){n&&!r&&e(t),Va(t,(t=>{Ga(t,e,!0,r)})),n&&r&&e(t)}function $a(t){return new Bi(null===t.parent?t.name:$a(t.parent)+"/"+t.name)}function Ya(t){null!==t.parent&&function(t,e,n){const r=function(t){return void 0===Ua(t)&&!Ha(t)}(n),i=$e(t.node.children,e);r&&i?(delete t.node.children[e],t.node.childCount--,Ya(t)):r||i||(t.node.children[e]=n.node,t.node.childCount++,Ya(t))}(t.parent,t.name,t)}const Ka=/[\[\].#$\/\u0000-\u001F\u007F]/,Qa=/[\[\].#$\u0000-\u001F\u007F]/,Ja=10485760,Xa=function(t){return"string"==typeof t&&0!==t.length&&!Ka.test(t)},Za=function(t){return"string"==typeof t&&0!==t.length&&!Qa.test(t)},tc=function(t,e,n){const r=n instanceof Bi?new to(n,t):n;if(void 0===e)throw new Error(t+"contains undefined "+no(r));if("function"==typeof e)throw new Error(t+"contains a function "+no(r)+" with contents = "+e.toString());if(ni(e))throw new Error(t+"contains "+e.toString()+" "+no(r));if("string"==typeof e&&e.length>Ja/3&&en(e)>Ja)throw new Error(t+"contains a string greater than "+Ja+" utf8 bytes "+no(r)+" ('"+e.substring(0,50)+"...')");if(e&&"object"==typeof e){let n=!1,i=!1;if(li(e,((e,o)=>{if(".value"===e)n=!0;else if(".priority"!==e&&".sv"!==e&&(i=!0,!Xa(e)))throw new Error(t+" contains an invalid key ("+e+") "+no(r)+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');!function(t,e){t.parts_.length>0&&(t.byteLength_+=1),t.parts_.push(e),t.byteLength_+=en(e),eo(t)}(r,e),tc(t,o,r),function(t){const e=t.parts_.pop();t.byteLength_-=en(e),t.parts_.length>0&&(t.byteLength_-=1)}(r)})),n&&i)throw new Error(t+' contains ".value" child '+no(r)+" in addition to actual children.")}},ec=function(t,e,n,r){if(!(r&&void 0===n||Za(n)))throw new Error(tn(t,e)+'was an invalid path = "'+n+'". Paths must be non-empty strings and can\'t contain ".", "#", "$", "[", or "]"')},nc=function(t,e,n,r){n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),ec(t,e,n,r)};class rc{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function ic(t,e,n){(function(t,e){let n=null;for(let r=0;r<e.length;r++){const i=e[r],o=i.getPath();null===n||Xi(o,n.path)||(t.eventLists_.push(n),n=null),null===n&&(n={events:[],path:o}),n.events.push(i)}n&&t.eventLists_.push(n)})(t,n),function(t,e){t.recursionDepth_++;let n=!0;for(let r=0;r<t.eventLists_.length;r++){const i=t.eventLists_[r];i&&(e(i.path)?(oc(t.eventLists_[r]),t.eventLists_[r]=null):n=!1)}n&&(t.eventLists_=[]),t.recursionDepth_--}(t,(t=>Zi(t,e)||Zi(e,t)))}function oc(t){for(let e=0;e<t.events.length;e++){const n=t.events[e];if(null!==n){t.events[e]=null;const r=n.getEventRunner();Kr&&Jr("event: "+n.toString()),pi(r)}}}const sc=25;class ac{constructor(t,e,n,r){this.repoInfo_=t,this.forceRestClient_=e,this.authTokenProvider_=n,this.appCheckProvider_=r,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new rc,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=Qo(),this.transactionQueueTree_=new za,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function cc(t,e,n){if(t.stats_=Pi(t.repoInfo_),t.forceRestClient_||("object"==typeof window&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0)t.server_=new Yo(t.repoInfo_,((e,n,r,i)=>{hc(t,e,n,r,i)}),t.authTokenProvider_,t.appCheckProvider_),setTimeout((()=>dc(t,!0)),0);else{if(null!=n){if("object"!=typeof n)throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{Ve(n)}catch(t){throw new Error("Invalid authOverride provided: "+t)}}t.persistentConnection_=new oo(t.repoInfo_,e,((e,n,r,i)=>{hc(t,e,n,r,i)}),(e=>{dc(t,e)}),(e=>{!function(t,e){li(e,((e,n)=>{fc(t,e,n)}))}(t,e)}),t.authTokenProvider_,t.appCheckProvider_,n),t.server_=t.persistentConnection_}t.authTokenProvider_.addTokenChangeListener((e=>{t.server_.refreshAuthToken(e)})),t.appCheckProvider_.addTokenChangeListener((e=>{t.server_.refreshAppCheckToken(e.token)})),t.statsReporter_=function(e,n){const r=e.toString();return xi[r]||(xi[r]=new ts(t.stats_,t.server_)),xi[r]}(t.repoInfo_),t.infoData_=new Ko,t.infoSyncTree_=new fa({startListening:(e,n,r,i)=>{let o=[];const s=t.infoData_.getNode(e._path);return s.isEmpty()||(o=ya(t.infoSyncTree_,e._path,s),setTimeout((()=>{i("ok")}),0)),o},stopListening:()=>{}}),fc(t,"connected",!1),t.serverSyncTree_=new fa({startListening:(e,n,r,i)=>(t.server_.listen(e,r,n,((n,r)=>{const o=i(n,r);ic(t.eventQueue_,e._path,o)})),[]),stopListening:(e,n)=>{t.server_.unlisten(e,n)}})}function uc(t){const e=t.infoData_.getNode(new Bi(".info/serverTimeOffset")).val()||0;return(new Date).getTime()+e}function lc(t){return Da({timestamp:uc(t)})}function hc(t,e,n,r,i){t.dataUpdateCount++;const o=new Bi(e);n=t.interceptServerDataCallback_?t.interceptServerDataCallback_(e,n):n;let s=[];if(i)if(r){const e=Qe(n,(t=>Ro(t)));s=function(t,e,n,r){const i=Ta(t,r);if(i){const r=xa(i),o=r.path,s=r.queryId,a=Ji(o,e),c=ys.fromObject(n);return Pa(t,o,new ss(ns(s),a,c))}return[]}(t.serverSyncTree_,o,e,i)}else{const e=Ro(n);s=ga(t.serverSyncTree_,o,e,i)}else if(r){const e=Qe(n,(t=>Ro(t)));s=function(t,e,n){const r=ys.fromObject(n);return wa(t,new ss({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},e,r))}(t.serverSyncTree_,o,e)}else{const e=Ro(n);s=ya(t.serverSyncTree_,o,e)}let a=o;s.length>0&&(a=gc(t,o)),ic(t.eventQueue_,a,s)}function dc(t,e){fc(t,"connected",e),!1===e&&function(t){mc(t,"onDisconnectEvents");const e=lc(t),n=Qo();Xo(t.onDisconnect_,Ui(),((r,i)=>{const o=ja(r,i,t.serverSyncTree_,e);Jo(n,r,o)}));let r=[];Xo(n,Ui(),((e,n)=>{r=r.concat(ya(t.serverSyncTree_,e,n));const i=function(t,e){const n=$a(_c(t,e)),r=Ba(t.transactionQueueTree_,e);return function(t,e,n){let r=void 0?t:t.parent;for(;null!==r;){if(e(r))return!0;r=r.parent}}(r,(e=>{Ec(t,e)})),Ec(t,r),Ga(r,(e=>{Ec(t,e)})),n}(t,e);gc(t,i)})),t.onDisconnect_=Qo(),ic(t.eventQueue_,Ui(),r)}(t)}function fc(t,e,n){const r=new Bi("/.info/"+e),i=Ro(n);t.infoData_.updateSnapshot(r,i);const o=ya(t.infoSyncTree_,r,i);ic(t.eventQueue_,r,o)}function pc(t){return t.nextWriteId_++}function mc(t,...e){let n="";t.persistentConnection_&&(n=t.persistentConnection_.id+":"),Jr(n,...e)}function yc(t,e,n){return ba(t.serverSyncTree_,e,n)||Oo.EMPTY_NODE}function vc(t,e=t.transactionQueueTree_){if(e||Cc(t,e),Ua(e)){const n=bc(t,e);ke(n.length>0,"Sending zero length transaction queue"),n.every((t=>0===t.status))&&function(t,e,n){const r=n.map((t=>t.currentWriteId)),i=yc(t,e,r);let o=i;const s=i.hash();for(let t=0;t<n.length;t++){const r=n[t];ke(0===r.status,"tryToSendTransactionQueue_: items in queue should all be run."),r.status=1,r.retryCount++;const i=Ji(e,r.path);o=o.updateChild(i,r.currentOutputSnapshotRaw)}const a=o.val(!0),c=e;t.server_.put(c.toString(),a,(r=>{mc(t,"transaction put response",{path:c.toString(),status:r});let i=[];if("ok"===r){const r=[];for(let e=0;e<n.length;e++)n[e].status=2,i=i.concat(ma(t.serverSyncTree_,n[e].currentWriteId)),n[e].onComplete&&r.push((()=>n[e].onComplete(null,!0,n[e].currentOutputSnapshotResolved))),n[e].unwatcher();Cc(t,Ba(t.transactionQueueTree_,e)),vc(t,t.transactionQueueTree_),ic(t.eventQueue_,e,i);for(let t=0;t<r.length;t++)pi(r[t])}else{if("datastale"===r)for(let t=0;t<n.length;t++)3===n[t].status?n[t].status=4:n[t].status=0;else{ei("transaction at "+c.toString()+" failed: "+r);for(let t=0;t<n.length;t++)n[t].status=4,n[t].abortReason=r}gc(t,e)}}),s)}(t,$a(e),n)}else Ha(e)&&Va(e,(e=>{vc(t,e)}))}function gc(t,e){const n=_c(t,e),r=$a(n);return function(t,e,n){if(0===e.length)return;const r=[];let i=[];const o=e.filter((t=>0===t.status)).map((t=>t.currentWriteId));for(let a=0;a<e.length;a++){const c=e[a],u=Ji(n,c.path);let l,h=!1;if(ke(null!==u,"rerunTransactionsUnderNode_: relativePath should not be null."),4===c.status)h=!0,l=c.abortReason,i=i.concat(ma(t.serverSyncTree_,c.currentWriteId,!0));else if(0===c.status)if(c.retryCount>=sc)h=!0,l="maxretry",i=i.concat(ma(t.serverSyncTree_,c.currentWriteId,!0));else{const n=yc(t,c.path,o);c.currentInputSnapshot=n;const r=e[a].update(n.val());if(void 0!==r){tc("transaction failed: Data returned ",r,c.path);let e=Ro(r);"object"==typeof r&&null!=r&&$e(r,".priority")||(e=e.updatePriority(n.getPriority()));const s=c.currentWriteId,a=lc(t),u=Fa(e,n,a);c.currentOutputSnapshotRaw=e,c.currentOutputSnapshotResolved=u,c.currentWriteId=pc(t),o.splice(o.indexOf(s),1),i=i.concat(pa(t.serverSyncTree_,c.path,u,c.currentWriteId,c.applyLocally)),i=i.concat(ma(t.serverSyncTree_,s,!0))}else h=!0,l="nodata",i=i.concat(ma(t.serverSyncTree_,c.currentWriteId,!0))}ic(t.eventQueue_,n,i),i=[],h&&(e[a].status=2,s=e[a].unwatcher,setTimeout(s,Math.floor(0)),e[a].onComplete&&("nodata"===l?r.push((()=>e[a].onComplete(null,!1,e[a].currentInputSnapshot))):r.push((()=>e[a].onComplete(new Error(l),!1,null)))))}var s;Cc(t,t.transactionQueueTree_);for(let t=0;t<r.length;t++)pi(r[t]);vc(t,t.transactionQueueTree_)}(t,bc(t,n),r),r}function _c(t,e){let n,r=t.transactionQueueTree_;for(n=Wi(e);null!==n&&void 0===Ua(r);)r=Ba(r,n),n=Wi(e=Vi(e));return r}function bc(t,e){const n=[];return wc(t,e,n),n.sort(((t,e)=>t.order-e.order)),n}function wc(t,e,n){const r=Ua(e);if(r)for(let t=0;t<r.length;t++)n.push(r[t]);Va(e,(e=>{wc(t,e,n)}))}function Cc(t,e){const n=Ua(e);if(n){let t=0;for(let e=0;e<n.length;e++)2!==n[e].status&&(n[t]=n[e],t++);n.length=t,Wa(e,n.length>0?n:void 0)}Va(e,(e=>{Cc(t,e)}))}function Ec(t,e){const n=Ua(e);if(n){const r=[];let i=[],o=-1;for(let e=0;e<n.length;e++)3===n[e].status||(1===n[e].status?(ke(o===e-1,"All SENT items should be at beginning of queue."),o=e,n[e].status=3,n[e].abortReason="set"):(ke(0===n[e].status,"Unexpected transaction status in abort"),n[e].unwatcher(),i=i.concat(ma(t.serverSyncTree_,n[e].currentWriteId,!0)),n[e].onComplete&&r.push(n[e].onComplete.bind(null,new Error("set"),!1,null))));-1===o?Wa(e,void 0):n.length=o+1,ic(t.eventQueue_,$a(e),i);for(let t=0;t<r.length;t++)pi(r[t])}}const Sc=function(t,e){const n=kc(t),r=n.namespace;"firebase.com"===n.domain&&ti(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),r&&"undefined"!==r||"localhost"===n.domain||ti("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||"undefined"!=typeof window&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&ei("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().");const i="ws"===n.scheme||"wss"===n.scheme;return{repoInfo:new Si(n.host,n.secure,r,i,e,"",r!==n.subdomain),path:new Bi(n.pathString)}},kc=function(t){let e="",n="",r="",i="",o="",s=!0,a="https",c=443;if("string"==typeof t){let u=t.indexOf("//");u>=0&&(a=t.substring(0,u-1),t=t.substring(u+2));let l=t.indexOf("/");-1===l&&(l=t.length);let h=t.indexOf("?");-1===h&&(h=t.length),e=t.substring(0,Math.min(l,h)),l<h&&(i=function(t){let e="";const n=t.split("/");for(let t=0;t<n.length;t++)if(n[t].length>0){let r=n[t];try{r=decodeURIComponent(r.replace(/\+/g," "))}catch(t){}e+="/"+r}return e}(t.substring(l,h)));const d=function(t){const e={};"?"===t.charAt(0)&&(t=t.substring(1));for(const n of t.split("&")){if(0===n.length)continue;const r=n.split("=");2===r.length?e[decodeURIComponent(r[0])]=decodeURIComponent(r[1]):ei(`Invalid query segment '${n}' in query '${t}'`)}return e}(t.substring(Math.min(t.length,h)));u=e.indexOf(":"),u>=0?(s="https"===a||"wss"===a,c=parseInt(e.substring(u+1),10)):u=e.length;const f=e.slice(0,u);if("localhost"===f.toLowerCase())n="localhost";else if(f.split(".").length<=2)n=f;else{const t=e.indexOf(".");r=e.substring(0,t).toLowerCase(),n=e.substring(t+1),o=r}"ns"in d&&(o=d.ns)}return{host:e,port:c,domain:n,subdomain:r,secure:s,scheme:a,pathString:i,namespace:o}};class Ic{constructor(t,e,n,r){this.eventType=t,this.eventRegistration=e,this.snapshot=n,this.prevName=r}getPath(){const t=this.snapshot.ref;return"value"===this.eventType?t._path:t.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+Ve(this.snapshot.exportVal())}}class Tc{constructor(t,e,n){this.eventRegistration=t,this.error=e,this.path=n}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}class xc{constructor(t,e){this.snapshotCallback=t,this.cancelCallback=e}onValue(t,e){this.snapshotCallback.call(null,t,e)}onCancel(t){return ke(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,t)}get hasCancelCallback(){return!!this.cancelCallback}matches(t){return this.snapshotCallback===t.snapshotCallback||void 0!==this.snapshotCallback.userCallback&&this.snapshotCallback.userCallback===t.snapshotCallback.userCallback&&this.snapshotCallback.context===t.snapshotCallback.context}}class Pc{constructor(t,e,n,r){this._repo=t,this._path=e,this._queryParams=n,this._orderByCalled=r}get key(){return Qi(this._path)?null:Gi(this._path)}get ref(){return new Lc(this._repo,this._path)}get _queryIdentifier(){const t=$o(this._queryParams),e=ci(t);return"{}"===e?"default":e}get _queryObject(){return $o(this._queryParams)}isEqual(t){if(!((t=cn(t))instanceof Pc))return!1;const e=this._repo===t._repo,n=Xi(this._path,t._path),r=this._queryIdentifier===t._queryIdentifier;return e&&n&&r}toJSON(){return this.toString()}toString(){return this._repo.toString()+function(t){let e="";for(let n=t.pieceNum_;n<t.pieces_.length;n++)""!==t.pieces_[n]&&(e+="/"+encodeURIComponent(String(t.pieces_[n])));return e||"/"}(this._path)}}class Lc extends Pc{constructor(t,e){super(t,e,new Vo,!1)}get parent(){const t=Yi(this._path);return null===t?null:new Lc(this._repo,t)}get root(){let t=this;for(;null!==t.parent;)t=t.parent;return t}}class Nc{constructor(t,e,n){this._node=t,this.ref=e,this._index=n}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(t){const e=new Bi(t),n=Dc(this.ref,t);return new Nc(this._node.getChild(e),n,So)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(t){return!this._node.isLeafNode()&&!!this._node.forEachChild(this._index,((e,n)=>t(new Nc(n,Dc(this.ref,e),So))))}hasChild(t){const e=new Bi(t);return!this._node.getChild(e).isEmpty()}hasChildren(){return!this._node.isLeafNode()&&!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function Oc(t,e){return(t=cn(t))._checkNotDeleted("ref"),void 0!==e?Dc(t._root,e):t._root}function Dc(t,e){return null===Wi((t=cn(t))._path)?nc("child","path",e,!1):ec("child","path",e,!1),new Lc(t._repo,Ki(t._path,e))}function Ac(t){t=cn(t);const e=new xc((()=>{})),n=new Rc(e);return function(t,e,n){const r=function(t,e){const n=e._path;let r=null;t.syncPointTree_.foreachOnPath(n,((t,e)=>{const i=Ji(t,n);r=r||aa(e,i)}));let i=t.syncPointTree_.get(n);i?r=r||aa(i,Ui()):(i=new ra,t.syncPointTree_=t.syncPointTree_.set(n,i));const o=null!=r,s=o?new as(r,!0,!1):null;return fs(oa(i,e,xs(t.pendingWriteTree_,e._path),o?s.getNode():Oo.EMPTY_NODE,o).viewCache_)}(t.serverSyncTree_,e);return null!=r?Promise.resolve(r):t.server_.get(e).then((r=>{const i=Ro(r).withIndex(e._queryParams.getIndex());let o;if(_a(t.serverSyncTree_,e,n,!0),e._queryParams.loadsAllData())o=ya(t.serverSyncTree_,e._path,i);else{const n=ka(t.serverSyncTree_,e);o=ga(t.serverSyncTree_,e._path,i,n)}return ic(t.eventQueue_,e._path,o),va(t.serverSyncTree_,e,n,null,!0),i}),(n=>(mc(t,"get for query "+Ve(e)+" failed: "+n),Promise.reject(new Error(n)))))}(t._repo,t,n).then((e=>new Nc(e,new Lc(t._repo,t._path),t._queryParams.getIndex())))}class Rc{constructor(t){this.callbackContext=t}respondsTo(t){return"value"===t}createEvent(t,e){const n=e._queryParams.getIndex();return new Ic("value",this,new Nc(t.snapshotNode,new Lc(e._repo,e._path),n))}getEventRunner(t){return"cancel"===t.getEventType()?()=>this.callbackContext.onCancel(t.error):()=>this.callbackContext.onValue(t.snapshot,null)}createCancelEvent(t,e){return this.callbackContext.hasCancelCallback?new Tc(this,t,e):null}matches(t){return t instanceof Rc&&(!t.callbackContext||!this.callbackContext||t.callbackContext.matches(this.callbackContext))}hasAnyCallback(){return null!==this.callbackContext}}!function(t){ke(!ea,"__referenceConstructor has already been defined"),ea=t}(Lc),function(t){ke(!na,"__referenceConstructor has already been defined"),na=t}(Lc);const Mc={};function jc(t,e,n,r,i){let o=r||t.options.databaseURL;void 0===o&&(t.options.projectId||ti("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),Jr("Using default host for project ",t.options.projectId),o=`${t.options.projectId}-default-rtdb.firebaseio.com`);let s,a=Sc(o,i),c=a.repoInfo;s=!a.repoInfo.secure;const u=i&&s?new gi(gi.OWNER):new vi(t.name,t.options,e);(function(t,e){const n=e.path.toString();if("string"!=typeof e.repoInfo.host||0===e.repoInfo.host.length||!Xa(e.repoInfo.namespace)&&"localhost"!==e.repoInfo.host.split(":")[0]||0!==n.length&&!function(t){return t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),Za(t)}(n))throw new Error(tn(t,"url")+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')})("Invalid Firebase Database URL",a),Qi(a.path)||ti("Database URL must point to the root of a Firebase Database (not including a child path).");const l=function(t,e,n,r){let i=Mc[e.name];i||(i={},Mc[e.name]=i);let o=i[t.toURLString()];return o&&ti("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),o=new ac(t,false,n,r),i[t.toURLString()]=o,o}(c,t,u,new yi(t.name,n));return new Fc(l,t)}class Fc{constructor(t,e){this._repoInternal=t,this.app=e,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(cc(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new Lc(this._repo,Ui())),this._rootInternal}_delete(){return null!==this._rootInternal&&(function(t,e){const n=Mc[e];n&&n[t.key]===t||ti(`Database ${e}(${t.repoInfo_}) has already been deleted.`),function(t){t.persistentConnection_&&t.persistentConnection_.interrupt("repo_interrupt")}(t),delete n[t.key]}(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(t){null===this._rootInternal&&ti("Cannot call "+t+" on a deleted database.")}}oo.prototype.simpleListen=function(t,e){this.sendRequest("q",{p:t},e)},oo.prototype.echo=function(t,e){this.sendRequest("echo",{d:t},e)},qr="10.12.2",_r(new un("database",((t,{instanceIdentifier:e})=>jc(t.getProvider("app").getImmediate(),t.getProvider("auth-internal"),t.getProvider("app-check-internal"),e)),"PUBLIC").setMultipleInstances(!0)),kr(jr,Fr,void 0),kr(jr,Fr,"esm2017");const qc="@firebase/installations",zc="0.6.7",Bc=1e4,Uc=`w:${zc}`,Wc="FIS_v2",Hc="https://firebaseinstallations.googleapis.com/v1",Vc=36e5,Gc=new Ue("installations","Installations",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."});function $c(t){return t instanceof Be&&t.code.includes("request-failed")}function Yc({projectId:t}){return`${Hc}/projects/${t}/installations`}function Kc(t){return{token:t.token,requestStatus:2,expiresIn:(e=t.expiresIn,Number(e.replace("s","000"))),creationTime:Date.now()};var e}async function Qc(t,e){const n=(await e.json()).error;return Gc.create("request-failed",{requestName:t,serverCode:n.code,serverMessage:n.message,serverStatus:n.status})}function Jc({apiKey:t}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t})}async function Xc(t){const e=await t();return e.status>=500&&e.status<600?t():e}function Zc(t){return new Promise((e=>{setTimeout(e,t)}))}const tu=/^[cdef][\w-]{21}$/,eu="";function nu(){try{const t=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(t),t[0]=112+t[0]%16;const e=function(t){var e;return(e=t,btoa(String.fromCharCode(...e)).replace(/\+/g,"-").replace(/\//g,"_")).substr(0,22)}(t);return tu.test(e)?e:eu}catch(t){return eu}}function ru(t){return`${t.appName}!${t.appId}`}const iu=new Map;function ou(t,e){const n=ru(t);su(n,e),function(t,e){const n=(!au&&"BroadcastChannel"in self&&(au=new BroadcastChannel("[Firebase] FID Change"),au.onmessage=t=>{su(t.data.key,t.data.fid)}),au);n&&n.postMessage({key:t,fid:e}),0===iu.size&&au&&(au.close(),au=null)}(n,e)}function su(t,e){const n=iu.get(t);if(n)for(const t of n)t(e)}let au=null;const cu="firebase-installations-database",uu=1,lu="firebase-installations-store";let hu=null;function du(){return hu||(hu=On(cu,uu,{upgrade:(t,e)=>{0===e&&t.createObjectStore(lu)}})),hu}async function fu(t,e){const n=ru(t),r=(await du()).transaction(lu,"readwrite"),i=r.objectStore(lu),o=await i.get(n);return await i.put(e,n),await r.done,o&&o.fid===e.fid||ou(t,e.fid),e}async function pu(t){const e=ru(t),n=(await du()).transaction(lu,"readwrite");await n.objectStore(lu).delete(e),await n.done}async function mu(t,e){const n=ru(t),r=(await du()).transaction(lu,"readwrite"),i=r.objectStore(lu),o=await i.get(n),s=e(o);return void 0===s?await i.delete(n):await i.put(s,n),await r.done,!s||o&&o.fid===s.fid||ou(t,s.fid),s}async function yu(t){let e;const n=await mu(t.appConfig,(n=>{const r=function(t){return _u(t||{fid:nu(),registrationStatus:0})}(n),i=function(t,e){if(0===e.registrationStatus){if(!navigator.onLine)return{installationEntry:e,registrationPromise:Promise.reject(Gc.create("app-offline"))};const n={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},r=async function(t,e){try{const n=await async function({appConfig:t,heartbeatServiceProvider:e},{fid:n}){const r=Yc(t),i=Jc(t),o=e.getImmediate({optional:!0});if(o){const t=await o.getHeartbeatsHeader();t&&i.append("x-firebase-client",t)}const s={fid:n,authVersion:Wc,appId:t.appId,sdkVersion:Uc},a={method:"POST",headers:i,body:JSON.stringify(s)},c=await Xc((()=>fetch(r,a)));if(c.ok){const t=await c.json();return{fid:t.fid||n,registrationStatus:2,refreshToken:t.refreshToken,authToken:Kc(t.authToken)}}throw await Qc("Create Installation",c)}(t,e);return fu(t.appConfig,n)}catch(n){throw $c(n)&&409===n.customData.serverCode?await pu(t.appConfig):await fu(t.appConfig,{fid:e.fid,registrationStatus:0}),n}}(t,n);return{installationEntry:n,registrationPromise:r}}return 1===e.registrationStatus?{installationEntry:e,registrationPromise:vu(t)}:{installationEntry:e}}(t,r);return e=i.registrationPromise,i.installationEntry}));return n.fid===eu?{installationEntry:await e}:{installationEntry:n,registrationPromise:e}}async function vu(t){let e=await gu(t.appConfig);for(;1===e.registrationStatus;)await Zc(100),e=await gu(t.appConfig);if(0===e.registrationStatus){const{installationEntry:e,registrationPromise:n}=await yu(t);return n||e}return e}function gu(t){return mu(t,(t=>{if(!t)throw Gc.create("installation-not-found");return _u(t)}))}function _u(t){return 1===(e=t).registrationStatus&&e.registrationTime+Bc<Date.now()?{fid:t.fid,registrationStatus:0}:t;var e}async function bu({appConfig:t,heartbeatServiceProvider:e},n){const r=function(t,{fid:e}){return`${Yc(t)}/${e}/authTokens:generate`}(t,n),i=function(t,{refreshToken:e}){const n=Jc(t);return n.append("Authorization",function(t){return`${Wc} ${t}`}(e)),n}(t,n),o=e.getImmediate({optional:!0});if(o){const t=await o.getHeartbeatsHeader();t&&i.append("x-firebase-client",t)}const s={installation:{sdkVersion:Uc,appId:t.appId}},a={method:"POST",headers:i,body:JSON.stringify(s)},c=await Xc((()=>fetch(r,a)));if(c.ok)return Kc(await c.json());throw await Qc("Generate Auth Token",c)}async function wu(t,e=!1){let n;const r=await mu(t.appConfig,(r=>{if(!Eu(r))throw Gc.create("not-registered");const i=r.authToken;if(!e&&(2===(o=i).requestStatus&&!function(t){const e=Date.now();return e<t.creationTime||t.creationTime+t.expiresIn<e+Vc}(o)))return r;var o;if(1===i.requestStatus)return n=async function(t,e){let n=await Cu(t.appConfig);for(;1===n.authToken.requestStatus;)await Zc(100),n=await Cu(t.appConfig);const r=n.authToken;return 0===r.requestStatus?wu(t,e):r}(t,e),r;{if(!navigator.onLine)throw Gc.create("app-offline");const e=function(t){const e={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},t),{authToken:e})}(r);return n=async function(t,e){try{const n=await bu(t,e),r=Object.assign(Object.assign({},e),{authToken:n});return await fu(t.appConfig,r),n}catch(n){if(!$c(n)||401!==n.customData.serverCode&&404!==n.customData.serverCode){const n=Object.assign(Object.assign({},e),{authToken:{requestStatus:0}});await fu(t.appConfig,n)}else await pu(t.appConfig);throw n}}(t,e),e}}));return n?await n:r.authToken}function Cu(t){return mu(t,(t=>{if(!Eu(t))throw Gc.create("not-registered");return 1===(e=t.authToken).requestStatus&&e.requestTime+Bc<Date.now()?Object.assign(Object.assign({},t),{authToken:{requestStatus:0}}):t;var e}))}function Eu(t){return void 0!==t&&2===t.registrationStatus}function Su(t){return Gc.create("missing-app-config-values",{valueName:t})}const ku="installations";_r(new un(ku,(t=>{const e=t.getProvider("app").getImmediate(),n=function(t){if(!t||!t.options)throw Su("App Configuration");if(!t.name)throw Su("App Name");const e=["projectId","apiKey","appId"];for(const n of e)if(!t.options[n])throw Su(n);return{appName:t.name,projectId:t.options.projectId,apiKey:t.options.apiKey,appId:t.options.appId}}(e);return{app:e,appConfig:n,heartbeatServiceProvider:br(e,"heartbeat"),_delete:()=>Promise.resolve()}}),"PUBLIC")),_r(new un("installations-internal",(t=>{const e=br(t.getProvider("app").getImmediate(),ku).getImmediate();return{getId:()=>async function(t){const e=t,{installationEntry:n,registrationPromise:r}=await yu(e);return r?r.catch(console.error):wu(e).catch(console.error),n.fid}(e),getToken:t=>async function(t,e=!1){const n=t;return await async function(t){const{registrationPromise:e}=await yu(t);e&&await e}(n),(await wu(n,e)).token}(e,t)}}),"PRIVATE")),kr(qc,zc),kr(qc,zc,"esm2017");const Iu="analytics",Tu="firebase_id",xu="origin",Pu=6e4,Lu="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",Nu="https://www.googletagmanager.com/gtag/js",Ou=new _n("@firebase/analytics"),Du=new Ue("analytics","Analytics",{"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-intialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."});function Au(t){if(!t.startsWith(Nu)){const e=Du.create("invalid-gtag-resource",{gtagURL:t});return Ou.warn(e.message),""}return t}function Ru(t){return Promise.all(t.map((t=>t.catch((t=>t)))))}const Mu=30,ju=new class{constructor(t={},e=1e3){this.throttleMetadata=t,this.intervalMillis=e}getThrottleMetadata(t){return this.throttleMetadata[t]}setThrottleMetadata(t,e){this.throttleMetadata[t]=e}deleteThrottleMetadata(t){delete this.throttleMetadata[t]}};function Fu(t){return new Headers({Accept:"application/json","x-goog-api-key":t})}async function qu(t,e=ju,n){const{appId:r,apiKey:i,measurementId:o}=t.options;if(!r)throw Du.create("no-app-id");if(!i){if(o)return{measurementId:o,appId:r};throw Du.create("no-api-key")}const s=e.getThrottleMetadata(r)||{backoffCount:0,throttleEndTimeMillis:Date.now()},a=new Bu;return setTimeout((async()=>{a.abort()}),void 0!==n?n:Pu),zu({appId:r,apiKey:i,measurementId:o},s,a,e)}async function zu(t,{throttleEndTimeMillis:e,backoffCount:n},r,i=ju){var o;const{appId:s,measurementId:a}=t;try{await function(t,e){return new Promise(((n,r)=>{const i=Math.max(e-Date.now(),0),o=setTimeout(n,i);t.addEventListener((()=>{clearTimeout(o),r(Du.create("fetch-throttle",{throttleEndTimeMillis:e}))}))}))}(r,e)}catch(t){if(a)return Ou.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${a} provided in the "measurementId" field in the local Firebase config. [${null==t?void 0:t.message}]`),{appId:s,measurementId:a};throw t}try{const e=await async function(t){var e;const{appId:n,apiKey:r}=t,i={method:"GET",headers:Fu(r)},o=Lu.replace("{app-id}",n),s=await fetch(o,i);if(200!==s.status&&304!==s.status){let t="";try{const n=await s.json();(null===(e=n.error)||void 0===e?void 0:e.message)&&(t=n.error.message)}catch(t){}throw Du.create("config-fetch-failed",{httpStatus:s.status,responseMessage:t})}return s.json()}(t);return i.deleteThrottleMetadata(s),e}catch(e){const c=e;if(!function(t){if(!(t instanceof Be&&t.customData))return!1;const e=Number(t.customData.httpStatus);return 429===e||500===e||503===e||504===e}(c)){if(i.deleteThrottleMetadata(s),a)return Ou.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${a} provided in the "measurementId" field in the local Firebase config. [${null==c?void 0:c.message}]`),{appId:s,measurementId:a};throw e}const u=503===Number(null===(o=null==c?void 0:c.customData)||void 0===o?void 0:o.httpStatus)?an(n,i.intervalMillis,Mu):an(n,i.intervalMillis),l={throttleEndTimeMillis:Date.now()+u,backoffCount:n+1};return i.setThrottleMetadata(s,l),Ou.debug(`Calling attemptFetch again in ${u} millis`),zu(t,l,r,i)}}class Bu{constructor(){this.listeners=[]}addEventListener(t){this.listeners.push(t)}abort(){this.listeners.forEach((t=>t()))}}let Uu,Wu;async function Hu(t,e,n,r,i,o,s){var a;const c=qu(t);c.then((e=>{n[e.measurementId]=e.appId,t.options.measurementId&&e.measurementId!==t.options.measurementId&&Ou.warn(`The measurement ID in the local Firebase config (${t.options.measurementId}) does not match the measurement ID fetched from the server (${e.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)})).catch((t=>Ou.error(t))),e.push(c);const u=async function(){if(!qe())return Ou.warn(Du.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;try{await ze()}catch(t){return Ou.warn(Du.create("indexeddb-unavailable",{errorInfo:null==t?void 0:t.toString()}).message),!1}return!0}().then((t=>t?r.getId():void 0)),[l,h]=await Promise.all([c,u]);(function(t){const e=window.document.getElementsByTagName("script");for(const n of Object.values(e))if(n.src&&n.src.includes(Nu)&&n.src.includes(t))return n;return null})(o)||function(t,e){const n=function(t,e){let n;return window.trustedTypes&&(n=window.trustedTypes.createPolicy("firebase-js-sdk-policy",e)),n}(0,{createScriptURL:Au}),r=document.createElement("script"),i=`${Nu}?l=${t}&id=${e}`;r.src=n?null==n?void 0:n.createScriptURL(i):i,r.async=!0,document.head.appendChild(r)}(o,l.measurementId),Wu&&(i("consent","default",Wu),Wu=void 0),i("js",new Date);const d=null!==(a=null==s?void 0:s.config)&&void 0!==a?a:{};return d[xu]="firebase",d.update=!0,null!=h&&(d[Tu]=h),i("config",l.measurementId,d),Uu&&(i("set",Uu),Uu=void 0),l.measurementId}class Vu{constructor(t){this.app=t}_delete(){return delete Gu[this.app.options.appId],Promise.resolve()}}let Gu={},$u=[];const Yu={};let Ku,Qu,Ju="dataLayer",Xu=!1;function Zu(t,e,n){!function(){const t=[];if(function(){const t="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof t&&void 0!==t.id}()&&t.push("This is a browser extension environment."),"undefined"!=typeof navigator&&navigator.cookieEnabled||t.push("Cookies are not available."),t.length>0){const e=t.map(((t,e)=>`(${e+1}) ${t}`)).join(" "),n=Du.create("invalid-analytics-context",{errorInfo:e});Ou.warn(n.message)}}();const r=t.options.appId;if(!r)throw Du.create("no-app-id");if(!t.options.apiKey){if(!t.options.measurementId)throw Du.create("no-api-key");Ou.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${t.options.measurementId} provided in the "measurementId" field in the local Firebase config.`)}if(null!=Gu[r])throw Du.create("already-exists",{id:r});if(!Xu){!function(t){let e=[];Array.isArray(window[t])?e=window[t]:window[t]=e}(Ju);const{wrappedGtag:t,gtagCore:e}=function(t,e,n,r,i){let o=function(...t){window[r].push(arguments)};return window[i]&&"function"==typeof window[i]&&(o=window[i]),window[i]=function(t,e,n,r){return async function(i,...o){try{if("event"===i){const[r,i]=o;await async function(t,e,n,r,i){try{let o=[];if(i&&i.send_to){let t=i.send_to;Array.isArray(t)||(t=[t]);const r=await Ru(n);for(const n of t){const t=r.find((t=>t.measurementId===n)),i=t&&e[t.appId];if(!i){o=[];break}o.push(i)}}0===o.length&&(o=Object.values(e)),await Promise.all(o),t("event",r,i||{})}catch(t){Ou.error(t)}}(t,e,n,r,i)}else if("config"===i){const[i,s]=o;await async function(t,e,n,r,i,o){const s=r[i];try{if(s)await e[s];else{const t=(await Ru(n)).find((t=>t.measurementId===i));t&&await e[t.appId]}}catch(t){Ou.error(t)}t("config",i,o)}(t,e,n,r,i,s)}else if("consent"===i){const[e,n]=o;t("consent",e,n)}else if("get"===i){const[e,n,r]=o;t("get",e,n,r)}else if("set"===i){const[e]=o;t("set",e)}else t(i,...o)}catch(t){Ou.error(t)}}}(o,t,e,n),{gtagCore:o,wrappedGtag:window[i]}}(Gu,$u,Yu,Ju,"gtag");Qu=t,Ku=e,Xu=!0}return Gu[r]=Hu(t,$u,Yu,e,Ku,Ju,n),new Vu(t)}const tl="@firebase/analytics",el="0.10.4";_r(new un(Iu,((t,{options:e})=>Zu(t.getProvider("app").getImmediate(),t.getProvider("installations-internal").getImmediate(),e)),"PUBLIC")),_r(new un("analytics-internal",(function(t){try{const e=t.getProvider(Iu).getImmediate();return{logEvent:(t,n,r)=>function(t,e,n,r){t=cn(t),async function(t,e,n,r,i){if(i&&i.global)t("event",n,r);else{const i=await e;t("event",n,Object.assign(Object.assign({},r),{send_to:i}))}}(Qu,Gu[t.app.options.appId],e,n,r).catch((t=>Ou.error(t)))}(e,t,n,r)}}catch(t){throw Du.create("interop-component-reg-failed",{reason:t})}}),"PRIVATE")),kr(tl,el),kr(tl,el,"esm2017"),kr("firebase","10.12.2","app");var nl=Er({apiKey:"AIzaSyAWYeI6zrtWGTk-7C09L1wdFv5thN0ucxo",authDomain:"grill-40501.firebaseapp.com",projectId:"grill-40501",storageBucket:"grill-40501.appspot.com",messagingSenderId:"982455765104",appId:"1:982455765104:web:99999e02b833cab6ab0cb5",measurementId:"G-6L2202EX8R",databaseURL:"https://grill-40501-default-rtdb.europe-west1.firebasedatabase.app/"}),rl=(function(t=Sr()){const e=br(t=cn(t),Iu);e.isInitialized()?e.getImmediate():function(t,e={}){const n=br(t,Iu);if(n.isInitialized()){const t=n.getImmediate();if(Je(e,n.getOptions()))return t;throw Du.create("already-initialized")}n.initialize({options:e})}(t)}(nl),function(t=Sr(),e){const n=br(t,"database").getImmediate({identifier:e});if(!n._instanceStarted){const t=(t=>{const e=(t=>{var e,n;return null===(n=null===(e=Re())||void 0===e?void 0:e.emulatorHosts)||void 0===n?void 0:n[t]})(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return"["===e[0]?[e.substring(1,n-1),r]:[e.substring(0,n),r]})("database");t&&function(t,e,n,r={}){(t=cn(t))._checkNotDeleted("useEmulator"),t._instanceStarted&&ti("Cannot call useEmulator() after instance has already been initialized.");const i=t._repoInternal;let o;if(i.repoInfo_.nodeAdmin)r.mockUserToken&&ti('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),o=new gi(gi.OWNER);else if(r.mockUserToken){const e="string"==typeof r.mockUserToken?r.mockUserToken:function(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n=e||"demo-project",r=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:r,exp:r+3600,auth_time:r,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},t);return[Ne(JSON.stringify({alg:"none",type:"JWT"})),Ne(JSON.stringify(o)),""].join(".")}(r.mockUserToken,t.app.options.projectId);o=new gi(e)}!function(t,e,n,r){t.repoInfo_=new Si(`${e}:${n}`,!1,t.repoInfo_.namespace,t.repoInfo_.webSocketOnly,t.repoInfo_.nodeAdmin,t.repoInfo_.persistenceKey,t.repoInfo_.includeNamespaceInQueryParams,!0),r&&(t.authTokenProvider_=r)}(i,e,n,o)}(n,...t)}return n}(nl));function il(t){return il="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},il(t)}function ol(){ol=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,i=Object.defineProperty||function(t,e,n){t[e]=n.value},o="function"==typeof Symbol?Symbol:{},s=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function u(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,n){return t[e]=n}}function l(t,e,n,r){var o=e&&e.prototype instanceof v?e:v,s=Object.create(o.prototype),a=new L(r||[]);return i(s,"_invoke",{value:I(t,n,a)}),s}function h(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var d="suspendedStart",f="suspendedYield",p="executing",m="completed",y={};function v(){}function g(){}function _(){}var b={};u(b,s,(function(){return this}));var w=Object.getPrototypeOf,C=w&&w(w(N([])));C&&C!==n&&r.call(C,s)&&(b=C);var E=_.prototype=v.prototype=Object.create(b);function S(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function k(t,e){function n(i,o,s,a){var c=h(t[i],t,o);if("throw"!==c.type){var u=c.arg,l=u.value;return l&&"object"==il(l)&&r.call(l,"__await")?e.resolve(l.__await).then((function(t){n("next",t,s,a)}),(function(t){n("throw",t,s,a)})):e.resolve(l).then((function(t){u.value=t,s(u)}),(function(t){return n("throw",t,s,a)}))}a(c.arg)}var o;i(this,"_invoke",{value:function(t,r){function i(){return new e((function(e,i){n(t,r,e,i)}))}return o=o?o.then(i,i):i()}})}function I(e,n,r){var i=d;return function(o,s){if(i===p)throw Error("Generator is already running");if(i===m){if("throw"===o)throw s;return{value:t,done:!0}}for(r.method=o,r.arg=s;;){var a=r.delegate;if(a){var c=T(a,r);if(c){if(c===y)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(i===d)throw i=m,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i=p;var u=h(e,n,r);if("normal"===u.type){if(i=r.done?m:f,u.arg===y)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(i=m,r.method="throw",r.arg=u.arg)}}}function T(e,n){var r=n.method,i=e.iterator[r];if(i===t)return n.delegate=null,"throw"===r&&e.iterator.return&&(n.method="return",n.arg=t,T(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),y;var o=h(i,e.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,y;var s=o.arg;return s?s.done?(n[e.resultName]=s.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,y):s:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,y)}function x(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function P(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function L(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(x,this),this.reset(!0)}function N(e){if(e||""===e){var n=e[s];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,o=function n(){for(;++i<e.length;)if(r.call(e,i))return n.value=e[i],n.done=!1,n;return n.value=t,n.done=!0,n};return o.next=o}}throw new TypeError(il(e)+" is not iterable")}return g.prototype=_,i(E,"constructor",{value:_,configurable:!0}),i(_,"constructor",{value:g,configurable:!0}),g.displayName=u(_,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,_):(t.__proto__=_,u(t,c,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},S(k.prototype),u(k.prototype,a,(function(){return this})),e.AsyncIterator=k,e.async=function(t,n,r,i,o){void 0===o&&(o=Promise);var s=new k(l(t,n,r,i),o);return e.isGeneratorFunction(n)?s:s.next().then((function(t){return t.done?t.value:s.next()}))},S(E),u(E,c,"Generator"),u(E,s,(function(){return this})),u(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},e.values=N,L.prototype={constructor:L,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(P),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function i(r,i){return a.type="throw",a.arg=e,n.next=r,i&&(n.method="next",n.arg=t),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var s=this.tryEntries[o],a=s.completion;if("root"===s.tryLoc)return i("end");if(s.tryLoc<=this.prev){var c=r.call(s,"catchLoc"),u=r.call(s,"finallyLoc");if(c&&u){if(this.prev<s.catchLoc)return i(s.catchLoc,!0);if(this.prev<s.finallyLoc)return i(s.finallyLoc)}else if(c){if(this.prev<s.catchLoc)return i(s.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return i(s.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=t,s.arg=e,o?(this.method="next",this.next=o.finallyLoc,y):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),P(n),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;P(n)}return i}}throw Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:N(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),y}},e}function sl(t,e,n,r,i,o,s){try{var a=t[o](s),c=a.value}catch(t){return void n(t)}a.done?e(c):Promise.resolve(c).then(r,i)}function al(t){return function(){var e=this,n=arguments;return new Promise((function(r,i){var o=t.apply(e,n);function s(t){sl(o,r,i,s,a,"next",t)}function a(t){sl(o,r,i,s,a,"throw",t)}s(void 0)}))}}function cl(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,ul(r.key),r)}}function ul(t){var e=function(t,e){if("object"!=il(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!=il(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==il(e)?e:e+""}var ll=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.database=rl},e=[{key:"getProductList",value:(r=al(ol().mark((function t(e){var n,r;return ol().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=Oc(this.database,"product/".concat(e)),t.prev=1,t.next=4,Ac(n);case 4:if(!(r=t.sent).exists()){t.next=7;break}return t.abrupt("return",r.val());case 7:return t.abrupt("return",null);case 10:throw t.prev=10,t.t0=t.catch(1),t.t0;case 13:case"end":return t.stop()}}),t,this,[[1,10]])}))),function(t){return r.apply(this,arguments)})},{key:"getProduct",value:(n=al(ol().mark((function t(e,n){var r,i;return ol().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=Oc(this.database,"product/".concat(e,"/").concat(n)),t.prev=1,t.next=4,Ac(r);case 4:if(!(i=t.sent).exists()){t.next=7;break}return t.abrupt("return",i.val());case 7:return t.abrupt("return",null);case 10:throw t.prev=10,t.t0=t.catch(1),t.t0;case 13:case"end":return t.stop()}}),t,this,[[1,10]])}))),function(t,e){return n.apply(this,arguments)})}],e&&cl(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n,r}();function hl(t){return hl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hl(t)}function dl(){dl=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,i=Object.defineProperty||function(t,e,n){t[e]=n.value},o="function"==typeof Symbol?Symbol:{},s=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function u(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,n){return t[e]=n}}function l(t,e,n,r){var o=e&&e.prototype instanceof v?e:v,s=Object.create(o.prototype),a=new L(r||[]);return i(s,"_invoke",{value:I(t,n,a)}),s}function h(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var d="suspendedStart",f="suspendedYield",p="executing",m="completed",y={};function v(){}function g(){}function _(){}var b={};u(b,s,(function(){return this}));var w=Object.getPrototypeOf,C=w&&w(w(N([])));C&&C!==n&&r.call(C,s)&&(b=C);var E=_.prototype=v.prototype=Object.create(b);function S(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function k(t,e){function n(i,o,s,a){var c=h(t[i],t,o);if("throw"!==c.type){var u=c.arg,l=u.value;return l&&"object"==hl(l)&&r.call(l,"__await")?e.resolve(l.__await).then((function(t){n("next",t,s,a)}),(function(t){n("throw",t,s,a)})):e.resolve(l).then((function(t){u.value=t,s(u)}),(function(t){return n("throw",t,s,a)}))}a(c.arg)}var o;i(this,"_invoke",{value:function(t,r){function i(){return new e((function(e,i){n(t,r,e,i)}))}return o=o?o.then(i,i):i()}})}function I(e,n,r){var i=d;return function(o,s){if(i===p)throw Error("Generator is already running");if(i===m){if("throw"===o)throw s;return{value:t,done:!0}}for(r.method=o,r.arg=s;;){var a=r.delegate;if(a){var c=T(a,r);if(c){if(c===y)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(i===d)throw i=m,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i=p;var u=h(e,n,r);if("normal"===u.type){if(i=r.done?m:f,u.arg===y)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(i=m,r.method="throw",r.arg=u.arg)}}}function T(e,n){var r=n.method,i=e.iterator[r];if(i===t)return n.delegate=null,"throw"===r&&e.iterator.return&&(n.method="return",n.arg=t,T(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),y;var o=h(i,e.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,y;var s=o.arg;return s?s.done?(n[e.resultName]=s.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,y):s:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,y)}function x(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function P(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function L(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(x,this),this.reset(!0)}function N(e){if(e||""===e){var n=e[s];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,o=function n(){for(;++i<e.length;)if(r.call(e,i))return n.value=e[i],n.done=!1,n;return n.value=t,n.done=!0,n};return o.next=o}}throw new TypeError(hl(e)+" is not iterable")}return g.prototype=_,i(E,"constructor",{value:_,configurable:!0}),i(_,"constructor",{value:g,configurable:!0}),g.displayName=u(_,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,_):(t.__proto__=_,u(t,c,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},S(k.prototype),u(k.prototype,a,(function(){return this})),e.AsyncIterator=k,e.async=function(t,n,r,i,o){void 0===o&&(o=Promise);var s=new k(l(t,n,r,i),o);return e.isGeneratorFunction(n)?s:s.next().then((function(t){return t.done?t.value:s.next()}))},S(E),u(E,c,"Generator"),u(E,s,(function(){return this})),u(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},e.values=N,L.prototype={constructor:L,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(P),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function i(r,i){return a.type="throw",a.arg=e,n.next=r,i&&(n.method="next",n.arg=t),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var s=this.tryEntries[o],a=s.completion;if("root"===s.tryLoc)return i("end");if(s.tryLoc<=this.prev){var c=r.call(s,"catchLoc"),u=r.call(s,"finallyLoc");if(c&&u){if(this.prev<s.catchLoc)return i(s.catchLoc,!0);if(this.prev<s.finallyLoc)return i(s.finallyLoc)}else if(c){if(this.prev<s.catchLoc)return i(s.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return i(s.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=t,s.arg=e,o?(this.method="next",this.next=o.finallyLoc,y):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),P(n),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;P(n)}return i}}throw Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:N(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),y}},e}function fl(t,e,n,r,i,o,s){try{var a=t[o](s),c=a.value}catch(t){return void n(t)}a.done?e(c):Promise.resolve(c).then(r,i)}function pl(t){return function(){var e=this,n=arguments;return new Promise((function(r,i){var o=t.apply(e,n);function s(t){fl(o,r,i,s,a,"next",t)}function a(t){fl(o,r,i,s,a,"throw",t)}s(void 0)}))}}function ml(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,yl(r.key),r)}}function yl(t){var e=function(t,e){if("object"!=hl(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!=hl(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==hl(e)?e:e+""}var vl=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.database=new ll},e=[{key:"getProductList",value:(r=pl(dl().mark((function t(e){var n;return dl().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.database.getProductList(e);case 3:return n=t.sent,t.abrupt("return",n||[]);case 7:return t.prev=7,t.t0=t.catch(0),console.error("Error fetching product list for ".concat(e,":"),t.t0),t.abrupt("return",[]);case 11:case"end":return t.stop()}}),t,this,[[0,7]])}))),function(t){return r.apply(this,arguments)})},{key:"getProduct",value:(n=pl(dl().mark((function t(e,n){var r;return dl().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.database.getProduct(e,n);case 3:return r=t.sent,t.abrupt("return",r||[]);case 7:return t.prev=7,t.t0=t.catch(0),console.error("Error fetching product for ".concat(e," ").concat(n,":"),t.t0),t.abrupt("return",[]);case 11:case"end":return t.stop()}}),t,this,[[0,7]])}))),function(t,e){return n.apply(this,arguments)})}],e&&ml(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n,r}();function gl(t){return gl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gl(t)}function _l(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,bl(r.key),r)}}function bl(t){var e=function(t,e){if("object"!=gl(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!=gl(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==gl(e)?e:e+""}var wl=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)},(e=[{key:"addClickListener",value:function(t,e){t&&t.addEventListener("click",e)}}])&&_l(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function Cl(t){return Cl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Cl(t)}function El(){El=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,i=Object.defineProperty||function(t,e,n){t[e]=n.value},o="function"==typeof Symbol?Symbol:{},s=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function u(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,n){return t[e]=n}}function l(t,e,n,r){var o=e&&e.prototype instanceof v?e:v,s=Object.create(o.prototype),a=new L(r||[]);return i(s,"_invoke",{value:I(t,n,a)}),s}function h(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var d="suspendedStart",f="suspendedYield",p="executing",m="completed",y={};function v(){}function g(){}function _(){}var b={};u(b,s,(function(){return this}));var w=Object.getPrototypeOf,C=w&&w(w(N([])));C&&C!==n&&r.call(C,s)&&(b=C);var E=_.prototype=v.prototype=Object.create(b);function S(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function k(t,e){function n(i,o,s,a){var c=h(t[i],t,o);if("throw"!==c.type){var u=c.arg,l=u.value;return l&&"object"==Cl(l)&&r.call(l,"__await")?e.resolve(l.__await).then((function(t){n("next",t,s,a)}),(function(t){n("throw",t,s,a)})):e.resolve(l).then((function(t){u.value=t,s(u)}),(function(t){return n("throw",t,s,a)}))}a(c.arg)}var o;i(this,"_invoke",{value:function(t,r){function i(){return new e((function(e,i){n(t,r,e,i)}))}return o=o?o.then(i,i):i()}})}function I(e,n,r){var i=d;return function(o,s){if(i===p)throw Error("Generator is already running");if(i===m){if("throw"===o)throw s;return{value:t,done:!0}}for(r.method=o,r.arg=s;;){var a=r.delegate;if(a){var c=T(a,r);if(c){if(c===y)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(i===d)throw i=m,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i=p;var u=h(e,n,r);if("normal"===u.type){if(i=r.done?m:f,u.arg===y)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(i=m,r.method="throw",r.arg=u.arg)}}}function T(e,n){var r=n.method,i=e.iterator[r];if(i===t)return n.delegate=null,"throw"===r&&e.iterator.return&&(n.method="return",n.arg=t,T(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),y;var o=h(i,e.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,y;var s=o.arg;return s?s.done?(n[e.resultName]=s.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,y):s:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,y)}function x(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function P(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function L(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(x,this),this.reset(!0)}function N(e){if(e||""===e){var n=e[s];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,o=function n(){for(;++i<e.length;)if(r.call(e,i))return n.value=e[i],n.done=!1,n;return n.value=t,n.done=!0,n};return o.next=o}}throw new TypeError(Cl(e)+" is not iterable")}return g.prototype=_,i(E,"constructor",{value:_,configurable:!0}),i(_,"constructor",{value:g,configurable:!0}),g.displayName=u(_,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,_):(t.__proto__=_,u(t,c,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},S(k.prototype),u(k.prototype,a,(function(){return this})),e.AsyncIterator=k,e.async=function(t,n,r,i,o){void 0===o&&(o=Promise);var s=new k(l(t,n,r,i),o);return e.isGeneratorFunction(n)?s:s.next().then((function(t){return t.done?t.value:s.next()}))},S(E),u(E,c,"Generator"),u(E,s,(function(){return this})),u(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},e.values=N,L.prototype={constructor:L,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(P),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function i(r,i){return a.type="throw",a.arg=e,n.next=r,i&&(n.method="next",n.arg=t),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var s=this.tryEntries[o],a=s.completion;if("root"===s.tryLoc)return i("end");if(s.tryLoc<=this.prev){var c=r.call(s,"catchLoc"),u=r.call(s,"finallyLoc");if(c&&u){if(this.prev<s.catchLoc)return i(s.catchLoc,!0);if(this.prev<s.finallyLoc)return i(s.finallyLoc)}else if(c){if(this.prev<s.catchLoc)return i(s.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return i(s.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=t,s.arg=e,o?(this.method="next",this.next=o.finallyLoc,y):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),P(n),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;P(n)}return i}}throw Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:N(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),y}},e}function Sl(t,e,n,r,i,o,s){try{var a=t[o](s),c=a.value}catch(t){return void n(t)}a.done?e(c):Promise.resolve(c).then(r,i)}function kl(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Il(r.key),r)}}function Il(t){var e=function(t,e){if("object"!=Cl(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!=Cl(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Cl(e)?e:e+""}var Tl=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.modalTitle=document.querySelector(".modal__title"),this.modalCode=document.querySelector(".modal__code"),this.modalPrice=document.querySelector(".modal__price"),this.orderBtn=document.getElementById("order-modal"),this.productService=new vl,this.productCounter=new ie,this.productGallery=new be,this.sizeList=new Se(this.modalCode,this.modalPrice,this.updateSizeAndPrice.bind(this)),this.productDescription=new ce,this.eventHandler=new wl,this.productCounter.setupEventListeners(),this.price=null,this.size=null,this.modalImg=null},e=[{key:"setupEventListeners",value:function(t){this.eventHandler.addClickListener(this.orderBtn,t)}},{key:"updateModalContent",value:(n=El().mark((function t(e,n){var r;return El().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.renderSkeletonContent(),t.next=3,this.productService.getProduct(e,n);case 3:r=t.sent,this.renderModalContent(r);case 5:case"end":return t.stop()}}),t,this)})),r=function(){var t=this,e=arguments;return new Promise((function(r,i){var o=n.apply(t,e);function s(t){Sl(o,r,i,s,a,"next",t)}function a(t){Sl(o,r,i,s,a,"throw",t)}s(void 0)}))},function(t,e){return r.apply(this,arguments)})},{key:"renderSkeletonContent",value:function(){var t=this.modalTitle.parentElement;t.classList.add("skeleton__container"),document.querySelector(".modal__images").classList.add("skeleton","skeleton__img--container"),this.modalTitle.classList.add("skeleton","skeleton__text"),this.modalCode.classList.add("skeleton","skeleton__text","skeleton__text--width"),this.modalPrice.innerHTML="<p class='skeleton skeleton__text'></p><p class='skeleton skeleton__text'></p>";var e=document.createElement("div");e.classList.add("skeleton__container--flex"),e.innerHTML="\n      <p class='skeleton skeleton__text'></p>\n      <p class='skeleton skeleton__text'></p>\n      <p class='skeleton skeleton__text'></p>\n      <p class='skeleton skeleton__text'></p>\n      <p class='skeleton skeleton__text'></p>\n      <p class='skeleton skeleton__text'></p>\n      <p class='skeleton skeleton__text'></p>\n      <p class='skeleton skeleton__text'></p>\n    ",t.appendChild(e)}},{key:"removeSkeleton",value:function(){var t=this.modalTitle.parentElement;t.classList.remove("skeleton__container"),document.querySelector(".modal__images").classList.remove("skeleton","skeleton__img--container"),this.modalTitle.classList.remove("skeleton","skeleton__text"),this.modalCode.classList.remove("skeleton","skeleton__text","skeleton__text--width"),this.modalPrice.innerHTML="",t.lastChild.remove()}},{key:"renderModalContent",value:function(t){this.removeSkeleton(),this.modalTitle.textContent=t.title||t.name,this.size=t.sizeList[0].name;var e=document.createElement("p");this.modalCode.appendChild(e),this.updateSizeAndPrice(t.sizeList[0]),t.sizeList.length>1&&this.sizeList.render(t.sizeList),this.productDescription.render(t),this.productGallery.renderGallery(t),this.modalImg=t.imgsUrl[0]}},{key:"updateSizeAndPrice",value:function(t){this.size=t,this.modalCode.firstChild.innerText="Код товару: ".concat(t.code),this.price=t.newCost,this.modalPrice.innerHTML='\n      <p class="price__new price__new--modal margin--bottom">'.concat(t.newCost," грн</p>\n      ").concat(t.oldCost?'<p class="price__old price__old--modal margin--bottom">'.concat(t.oldCost," грн</p>"):"","\n    ")}},{key:"removeSize",value:function(){this.sizeList.remove()}},{key:"removePrice",value:function(){Array.from(this.modalPrice.children).forEach((function(t){t.remove()}))}},{key:"removeCode",value:function(){this.modalCode.firstChild&&this.modalCode.firstChild.remove()}},{key:"removeDescription",value:function(){this.productDescription.remove()}},{key:"getCounter",value:function(){return this.productCounter.counterInputValue}},{key:"resetCounter",value:function(){this.productCounter.resetCounter()}},{key:"removeGallery",value:function(){this.productGallery.removeGallery()}},{key:"clearContent",value:function(){this.modalTitle.textContent="",this.removeCode(),this.removePrice(),this.removeGallery(),this.removeSize(),this.resetCounter(),this.removeDescription()}}],e&&kl(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n,r}();function xl(t){return xl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xl(t)}function Pl(){Pl=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,i=Object.defineProperty||function(t,e,n){t[e]=n.value},o="function"==typeof Symbol?Symbol:{},s=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function u(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,n){return t[e]=n}}function l(t,e,n,r){var o=e&&e.prototype instanceof v?e:v,s=Object.create(o.prototype),a=new L(r||[]);return i(s,"_invoke",{value:I(t,n,a)}),s}function h(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var d="suspendedStart",f="suspendedYield",p="executing",m="completed",y={};function v(){}function g(){}function _(){}var b={};u(b,s,(function(){return this}));var w=Object.getPrototypeOf,C=w&&w(w(N([])));C&&C!==n&&r.call(C,s)&&(b=C);var E=_.prototype=v.prototype=Object.create(b);function S(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function k(t,e){function n(i,o,s,a){var c=h(t[i],t,o);if("throw"!==c.type){var u=c.arg,l=u.value;return l&&"object"==xl(l)&&r.call(l,"__await")?e.resolve(l.__await).then((function(t){n("next",t,s,a)}),(function(t){n("throw",t,s,a)})):e.resolve(l).then((function(t){u.value=t,s(u)}),(function(t){return n("throw",t,s,a)}))}a(c.arg)}var o;i(this,"_invoke",{value:function(t,r){function i(){return new e((function(e,i){n(t,r,e,i)}))}return o=o?o.then(i,i):i()}})}function I(e,n,r){var i=d;return function(o,s){if(i===p)throw Error("Generator is already running");if(i===m){if("throw"===o)throw s;return{value:t,done:!0}}for(r.method=o,r.arg=s;;){var a=r.delegate;if(a){var c=T(a,r);if(c){if(c===y)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(i===d)throw i=m,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i=p;var u=h(e,n,r);if("normal"===u.type){if(i=r.done?m:f,u.arg===y)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(i=m,r.method="throw",r.arg=u.arg)}}}function T(e,n){var r=n.method,i=e.iterator[r];if(i===t)return n.delegate=null,"throw"===r&&e.iterator.return&&(n.method="return",n.arg=t,T(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),y;var o=h(i,e.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,y;var s=o.arg;return s?s.done?(n[e.resultName]=s.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,y):s:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,y)}function x(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function P(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function L(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(x,this),this.reset(!0)}function N(e){if(e||""===e){var n=e[s];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,o=function n(){for(;++i<e.length;)if(r.call(e,i))return n.value=e[i],n.done=!1,n;return n.value=t,n.done=!0,n};return o.next=o}}throw new TypeError(xl(e)+" is not iterable")}return g.prototype=_,i(E,"constructor",{value:_,configurable:!0}),i(_,"constructor",{value:g,configurable:!0}),g.displayName=u(_,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,_):(t.__proto__=_,u(t,c,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},S(k.prototype),u(k.prototype,a,(function(){return this})),e.AsyncIterator=k,e.async=function(t,n,r,i,o){void 0===o&&(o=Promise);var s=new k(l(t,n,r,i),o);return e.isGeneratorFunction(n)?s:s.next().then((function(t){return t.done?t.value:s.next()}))},S(E),u(E,c,"Generator"),u(E,s,(function(){return this})),u(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},e.values=N,L.prototype={constructor:L,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(P),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function i(r,i){return a.type="throw",a.arg=e,n.next=r,i&&(n.method="next",n.arg=t),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var s=this.tryEntries[o],a=s.completion;if("root"===s.tryLoc)return i("end");if(s.tryLoc<=this.prev){var c=r.call(s,"catchLoc"),u=r.call(s,"finallyLoc");if(c&&u){if(this.prev<s.catchLoc)return i(s.catchLoc,!0);if(this.prev<s.finallyLoc)return i(s.finallyLoc)}else if(c){if(this.prev<s.catchLoc)return i(s.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return i(s.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=t,s.arg=e,o?(this.method="next",this.next=o.finallyLoc,y):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),P(n),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;P(n)}return i}}throw Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:N(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),y}},e}function Ll(t,e,n,r,i,o,s){try{var a=t[o](s),c=a.value}catch(t){return void n(t)}a.done?e(c):Promise.resolve(c).then(r,i)}function Nl(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Ol(r.key),r)}}function Ol(t){var e=function(t,e){if("object"!=xl(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!=xl(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==xl(e)?e:e+""}function Dl(t,e,n){return e=Ml(e),function(t,e){if(e&&("object"===xl(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Al()?Reflect.construct(e,n||[],Ml(t).constructor):e.apply(t,n))}function Al(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(Al=function(){return!!t})()}function Rl(){return Rl="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Ml(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Rl.apply(this,arguments)}function Ml(t){return Ml=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Ml(t)}function jl(t,e){return jl=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},jl(t,e)}var Fl=function(t){function e(t,n){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=Dl(this,e,["#modal-product","#close-product"])).basket=t,r.basketModal=n,r.productComponent=new Tl,r.product={},r.description=document.querySelector(".product"),r.productComponent.setupEventListeners(r.handleClickOrderBtn.bind(r)),r.setupEventListeners(),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&jl(t,e)}(e,t),n=e,r=[{key:"setupEventListeners",value:function(){Rl(Ml(e.prototype),"setupEventListeners",this).call(this)}},{key:"openWithProduct",value:(i=Pl().mark((function t(e,n){return Pl().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.productComponent.updateModalContent(e,n),this.open();case 2:case"end":return t.stop()}}),t,this)})),o=function(){var t=this,e=arguments;return new Promise((function(n,r){var o=i.apply(t,e);function s(t){Ll(o,n,r,s,a,"next",t)}function a(t){Ll(o,n,r,s,a,"throw",t)}s(void 0)}))},function(t,e){return o.apply(this,arguments)})},{key:"close",value:function(){Rl(Ml(e.prototype),"close",this).call(this),this.productComponent.clearContent()}},{key:"handleClickOrderBtn",value:function(){this.basketModal.openWithBasket(this.productComponent.modalImg,this.productComponent.modalTitle.textContent,this.productComponent.modalCode.textContent.split(":")[1].trim(),this.productComponent.price,this.productComponent.size.name,this.productComponent.getCounter())}}],r&&Nl(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,i,o}(kt);function ql(t){return ql="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ql(t)}function zl(){zl=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,i=Object.defineProperty||function(t,e,n){t[e]=n.value},o="function"==typeof Symbol?Symbol:{},s=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function u(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,n){return t[e]=n}}function l(t,e,n,r){var o=e&&e.prototype instanceof v?e:v,s=Object.create(o.prototype),a=new L(r||[]);return i(s,"_invoke",{value:I(t,n,a)}),s}function h(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var d="suspendedStart",f="suspendedYield",p="executing",m="completed",y={};function v(){}function g(){}function _(){}var b={};u(b,s,(function(){return this}));var w=Object.getPrototypeOf,C=w&&w(w(N([])));C&&C!==n&&r.call(C,s)&&(b=C);var E=_.prototype=v.prototype=Object.create(b);function S(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function k(t,e){function n(i,o,s,a){var c=h(t[i],t,o);if("throw"!==c.type){var u=c.arg,l=u.value;return l&&"object"==ql(l)&&r.call(l,"__await")?e.resolve(l.__await).then((function(t){n("next",t,s,a)}),(function(t){n("throw",t,s,a)})):e.resolve(l).then((function(t){u.value=t,s(u)}),(function(t){return n("throw",t,s,a)}))}a(c.arg)}var o;i(this,"_invoke",{value:function(t,r){function i(){return new e((function(e,i){n(t,r,e,i)}))}return o=o?o.then(i,i):i()}})}function I(e,n,r){var i=d;return function(o,s){if(i===p)throw Error("Generator is already running");if(i===m){if("throw"===o)throw s;return{value:t,done:!0}}for(r.method=o,r.arg=s;;){var a=r.delegate;if(a){var c=T(a,r);if(c){if(c===y)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(i===d)throw i=m,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i=p;var u=h(e,n,r);if("normal"===u.type){if(i=r.done?m:f,u.arg===y)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(i=m,r.method="throw",r.arg=u.arg)}}}function T(e,n){var r=n.method,i=e.iterator[r];if(i===t)return n.delegate=null,"throw"===r&&e.iterator.return&&(n.method="return",n.arg=t,T(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),y;var o=h(i,e.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,y;var s=o.arg;return s?s.done?(n[e.resultName]=s.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,y):s:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,y)}function x(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function P(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function L(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(x,this),this.reset(!0)}function N(e){if(e||""===e){var n=e[s];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,o=function n(){for(;++i<e.length;)if(r.call(e,i))return n.value=e[i],n.done=!1,n;return n.value=t,n.done=!0,n};return o.next=o}}throw new TypeError(ql(e)+" is not iterable")}return g.prototype=_,i(E,"constructor",{value:_,configurable:!0}),i(_,"constructor",{value:g,configurable:!0}),g.displayName=u(_,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,_):(t.__proto__=_,u(t,c,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},S(k.prototype),u(k.prototype,a,(function(){return this})),e.AsyncIterator=k,e.async=function(t,n,r,i,o){void 0===o&&(o=Promise);var s=new k(l(t,n,r,i),o);return e.isGeneratorFunction(n)?s:s.next().then((function(t){return t.done?t.value:s.next()}))},S(E),u(E,c,"Generator"),u(E,s,(function(){return this})),u(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},e.values=N,L.prototype={constructor:L,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(P),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function i(r,i){return a.type="throw",a.arg=e,n.next=r,i&&(n.method="next",n.arg=t),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var s=this.tryEntries[o],a=s.completion;if("root"===s.tryLoc)return i("end");if(s.tryLoc<=this.prev){var c=r.call(s,"catchLoc"),u=r.call(s,"finallyLoc");if(c&&u){if(this.prev<s.catchLoc)return i(s.catchLoc,!0);if(this.prev<s.finallyLoc)return i(s.finallyLoc)}else if(c){if(this.prev<s.catchLoc)return i(s.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return i(s.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=t,s.arg=e,o?(this.method="next",this.next=o.finallyLoc,y):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),P(n),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;P(n)}return i}}throw Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:N(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),y}},e}function Bl(t,e,n,r,i,o,s){try{var a=t[o](s),c=a.value}catch(t){return void n(t)}a.done?e(c):Promise.resolve(c).then(r,i)}function Ul(t){return function(){var e=this,n=arguments;return new Promise((function(r,i){var o=t.apply(e,n);function s(t){Bl(o,r,i,s,a,"next",t)}function a(t){Bl(o,r,i,s,a,"throw",t)}s(void 0)}))}}function Wl(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Hl(r.key),r)}}function Hl(t){var e=function(t,e){if("object"!=ql(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!=ql(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==ql(e)?e:e+""}var Vl=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.productService=new vl,this.containers=document.querySelectorAll(".catalog__list"),this.initialize(),this.basket=new bt,this.basketModal=new te(this.basket),this.productModal=new Fl(this.basket,this.basketModal)},e=[{key:"initialize",value:(i=Ul(zl().mark((function t(){return zl().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.renderSkeleton(),t.next=3,this.getProductsList();case 3:case"end":return t.stop()}}),t,this)}))),function(){return i.apply(this,arguments)})},{key:"initializeSplide",value:function(t){new yt(t)}},{key:"renderSkeleton",value:function(){var t=this;this.containers.forEach((function(e){for(var n=0;n<4;n++){var r=document.createElement("li");r.classList.add("splide__slide");var i=document.createElement("article");i.classList.add("card"),i.innerHTML="\n      <div class='card__image skeleton skeleton__img'></div>\n      <div class='card__container'>\n        <h4 class='card__title skeleton skeleton__text'></h4>\n        <div class='card__price-container price'>\n          <p class='price__new skeleton skeleton__text'></p>\n          <p class='price__old skeleton skeleton__text'></p>\n        </div>\n        <div class='card__buttons'>\n          <button type='button' class='button card__button-detail details' value='Деталі'>Деталі</button>\n          <button type='button' class='button card__button-buy buy' value='Замовити'>Замовити</button>\n        </div>\n      </div>",r.appendChild(i),e.appendChild(r)}t.initializeSplide(e.parentNode)}))}},{key:"getProductsList",value:(r=Ul(zl().mark((function t(){var e,n=this;return zl().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=Array.from(this.containers).map(function(){var t=Ul(zl().mark((function t(e){var r,i;return zl().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.dataset.category,t.next=3,n.productService.getProductList(r);case 3:i=t.sent,n.renderProducts(e,i,r),n.addClickListeners(e);case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),t.next=3,Promise.all(e);case 3:case"end":return t.stop()}}),t,this)}))),function(){return r.apply(this,arguments)})},{key:"renderProducts",value:function(t,e,n){var r=this;this.removeSkeleton(t),e.forEach((function(e){var i=r.createProductElement(e,n);t.appendChild(i)})),this.initializeSplide(t.parentNode)}},{key:"removeSkeleton",value:function(t){var e=t.parentNode.parentNode.querySelector(".splide__pagination");e&&e.remove(),t.innerHTML=""}},{key:"createProductElement",value:function(t,e){var n=this.formatPrice(t.sizeList[0].newCost),r=t.sizeList[0].oldCost?"".concat(this.formatPrice(t.sizeList[0].oldCost)," грн."):"",i=document.createElement("li");i.classList.add("splide__slide");var o=document.createElement("article");return o.setAttribute("data-id",t.id),o.setAttribute("data-category",e),o.classList.add("card"),o.innerHTML="\n      <img class='card__image' src='".concat(t.imgsUrl[0],"' alt='").concat(t.alt,"'/>\n      <div class='card__container'>\n        <h4 class='card__title'>").concat(t.name,"</h4>\n        <div class='card__price-container price'>\n          <p class='price__new'>").concat(n," грн.</p>\n          <p class='price__old'>").concat(r,"</p>\n        </div>\n        <div class='card__buttons'>\n          <button type='button' class='button card__button-detail details' value='Деталі'>Деталі</button>\n          <button type='button' class='button card__button-buy buy' value='Замовити'>Замовити</button>\n        </div>\n      </div>"),i.appendChild(o),i}},{key:"formatPrice",value:function(t){var e=t.toString();return 4===e.length?e.slice(0,1)+" "+e.slice(1):e}},{key:"addClickListeners",value:function(t){var e=this,n=t.querySelectorAll(".card"),r=t.querySelectorAll(".details"),i=t.querySelectorAll(".card__button-buy");n.forEach((function(t){ht(t,"click").subscribe((function(t){return e.handleCardClick(t)}))})),r.forEach((function(t){ht(t,"click").subscribe((function(t){return e.handleClickDetails(t)}))})),i.forEach((function(t){ht(t,"click").subscribe((function(t){return e.handleClickBuy(t)}))}))}},{key:"handleCardClick",value:function(t){var e=t.currentTarget.closest(".card").dataset.id,n=t.currentTarget.closest(".card").dataset.category;this.productModal.openWithProduct(n,e)}},{key:"handleClickDetails",value:function(t){t.stopPropagation();var e=t.currentTarget.closest(".card").dataset.id,n=t.currentTarget.closest(".card").dataset.category;this.productModal.openWithProduct(n,e)}},{key:"handleClickBuy",value:(n=Ul(zl().mark((function t(e){var n,r,i,o;return zl().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.stopPropagation(),n=e.currentTarget.closest(".card"),r=e.currentTarget.closest(".card").dataset.id,i=e.currentTarget.closest(".card").dataset.category,t.next=6,this.productService.getProduct(i,r);case 6:o=t.sent,n&&this.basketModal.openWithBasket(o.imgsUrl[0],o.name,o.sizeList[0].code,o.sizeList[0].newCost,o.sizeList[0].name,1);case 8:case"end":return t.stop()}}),t,this)}))),function(t){return n.apply(this,arguments)})}],e&&Wl(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n,r,i}();function Gl(t){return Gl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Gl(t)}function $l(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Yl(r.key),r)}}function Yl(t){var e=function(t,e){if("object"!=Gl(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!=Gl(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Gl(e)?e:e+""}var Kl=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.containerDelivery=document.getElementById("delivery-slider"),this.initSplide(this.containerDelivery)},(e=[{key:"initSplide",value:function(t){new Splide(t,{arrows:!1,perPage:4,classes:{pagination:"splide__pagination pagination",page:"splide__pagination__page pagination__button"},breakpoints:{992:{fixedWidth:300},768:{fixedWidth:0,perPage:2,perMove:2},600:{perPage:1}}}).mount()}}])&&$l(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function Ql(t){return Ql="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ql(t)}function Jl(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Xl(r.key),r)}}function Xl(t){var e=function(t,e){if("object"!=Ql(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!=Ql(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Ql(e)?e:e+""}var Zl=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.menu=document.querySelector(".mobile-menu"),this.menuBtnOpen=document.querySelector(".menu-btn-open"),this.menuBtnClose=document.querySelector(".menu-btn-close"),this.body=document.querySelector("body")},(e=[{key:"toggleMenu",value:function(){this.menu.classList.toggle("is-open")}},{key:"disableScroll",value:function(){document.body.classList.toggle("is-scroll-disable")}},{key:"addListener",value:function(){var t=this,e=ht(this.menuBtnOpen,"click").pipe(wt((function(){t.toggleMenu(),t.disableScroll()}))),n=ht(this.menuBtnClose,"click").pipe(wt((function(){t.toggleMenu(),t.disableScroll()})));e.subscribe(),n.subscribe(),this.menuBtnOpen.addEventListener("click",this.handleClickInsideMenu.bind(this)),this.body.addEventListener("click",this.handleClickOutsideMenu.bind(this))}},{key:"handleClickInsideMenu",value:function(t){t.stopPropagation()}},{key:"handleClickOutsideMenu",value:function(t){this.menu.contains(t.target)||t.target===this.menuBtnOpen||t.target===this.menuBtnClose||this.menu.classList.contains("is-open")&&(this.toggleMenu(),this.disableScroll())}}])&&Jl(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function th(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var eh="(prefers-reduced-motion: reduce)",nh={CREATED:1,MOUNTED:2,IDLE:3,MOVING:4,SCROLLING:5,DRAGGING:6,DESTROYED:7};function rh(t){t.length=0}function ih(t,e,n){return Array.prototype.slice.call(t,e,n)}function oh(t){return t.bind.apply(t,[null].concat(ih(arguments,1)))}var sh=setTimeout,ah=function(){};function ch(t){return requestAnimationFrame(t)}function uh(t,e){return typeof e===t}function lh(t){return!mh(t)&&uh("object",t)}var hh=Array.isArray,dh=oh(uh,"function"),fh=oh(uh,"string"),ph=oh(uh,"undefined");function mh(t){return null===t}function yh(t){try{return t instanceof(t.ownerDocument.defaultView||window).HTMLElement}catch(t){return!1}}function vh(t){return hh(t)?t:[t]}function gh(t,e){vh(t).forEach(e)}function _h(t,e){return t.indexOf(e)>-1}function bh(t,e){return t.push.apply(t,vh(e)),t}function wh(t,e,n){t&&gh(e,(function(e){e&&t.classList[n?"add":"remove"](e)}))}function Ch(t,e){wh(t,fh(e)?e.split(" "):e,!0)}function Eh(t,e){gh(e,t.appendChild.bind(t))}function Sh(t,e){gh(t,(function(t){var n=(e||t).parentNode;n&&n.insertBefore(t,e)}))}function kh(t,e){return yh(t)&&(t.msMatchesSelector||t.matches).call(t,e)}function Ih(t,e){var n=t?ih(t.children):[];return e?n.filter((function(t){return kh(t,e)})):n}function Th(t,e){return e?Ih(t,e)[0]:t.firstElementChild}var xh=Object.keys;function Ph(t,e,n){return t&&(n?xh(t).reverse():xh(t)).forEach((function(n){"__proto__"!==n&&e(t[n],n)})),t}function Lh(t){return ih(arguments,1).forEach((function(e){Ph(e,(function(n,r){t[r]=e[r]}))})),t}function Nh(t){return ih(arguments,1).forEach((function(e){Ph(e,(function(e,n){hh(e)?t[n]=e.slice():lh(e)?t[n]=Nh({},lh(t[n])?t[n]:{},e):t[n]=e}))})),t}function Oh(t,e){gh(e||xh(t),(function(e){delete t[e]}))}function Dh(t,e){gh(t,(function(t){gh(e,(function(e){t&&t.removeAttribute(e)}))}))}function Ah(t,e,n){lh(e)?Ph(e,(function(e,n){Ah(t,n,e)})):gh(t,(function(t){mh(n)||""===n?Dh(t,e):t.setAttribute(e,String(n))}))}function Rh(t,e,n){var r=document.createElement(t);return e&&(fh(e)?Ch(r,e):Ah(r,e)),n&&Eh(n,r),r}function Mh(t,e,n){if(ph(n))return getComputedStyle(t)[e];mh(n)||(t.style[e]=""+n)}function jh(t,e){Mh(t,"display",e)}function Fh(t){t.setActive&&t.setActive()||t.focus({preventScroll:!0})}function qh(t,e){return t.getAttribute(e)}function zh(t,e){return t&&t.classList.contains(e)}function Bh(t){return t.getBoundingClientRect()}function Uh(t){gh(t,(function(t){t&&t.parentNode&&t.parentNode.removeChild(t)}))}function Wh(t){return Th((new DOMParser).parseFromString(t,"text/html").body)}function Hh(t,e){t.preventDefault(),e&&(t.stopPropagation(),t.stopImmediatePropagation())}function Vh(t,e){return t&&t.querySelector(e)}function Gh(t,e){return e?ih(t.querySelectorAll(e)):[]}function $h(t,e){wh(t,e,!1)}function Yh(t){return t.timeStamp}function Kh(t){return fh(t)?t:t?t+"px":""}var Qh="splide",Jh="data-"+Qh;function Xh(t,e){if(!t)throw new Error("["+Qh+"] "+(e||""))}var Zh=Math.min,td=Math.max,ed=Math.floor,nd=Math.ceil,rd=Math.abs;function id(t,e,n){return rd(t-e)<n}function od(t,e,n,r){var i=Zh(e,n),o=td(e,n);return r?i<t&&t<o:i<=t&&t<=o}function sd(t,e,n){var r=Zh(e,n),i=td(e,n);return Zh(td(r,t),i)}function ad(t){return+(t>0)-+(t<0)}function cd(t,e){return gh(e,(function(e){t=t.replace("%s",""+e)})),t}function ud(t){return t<10?"0"+t:""+t}var ld={};function hd(){var t=[];function e(t,e,n){gh(t,(function(t){t&&gh(e,(function(e){e.split(" ").forEach((function(e){var r=e.split(".");n(t,r[0],r[1])}))}))}))}return{bind:function(n,r,i,o){e(n,r,(function(e,n,r){var s="addEventListener"in e,a=s?e.removeEventListener.bind(e,n,i,o):e.removeListener.bind(e,i);s?e.addEventListener(n,i,o):e.addListener(i),t.push([e,n,r,i,a])}))},unbind:function(n,r,i){e(n,r,(function(e,n,r){t=t.filter((function(t){return!!(t[0]!==e||t[1]!==n||t[2]!==r||i&&t[3]!==i)||(t[4](),!1)}))}))},dispatch:function(t,e,n){var r,i=!0;return"function"==typeof CustomEvent?r=new CustomEvent(e,{bubbles:i,detail:n}):(r=document.createEvent("CustomEvent")).initCustomEvent(e,i,!1,n),t.dispatchEvent(r),r},destroy:function(){t.forEach((function(t){t[4]()})),rh(t)}}}var dd="mounted",fd="ready",pd="move",md="moved",yd="click",vd="refresh",gd="updated",_d="resize",bd="resized",wd="scroll",Cd="scrolled",Ed="destroy",Sd="navigation:mounted",kd="autoplay:play",Id="autoplay:pause",Td="lazyload:loaded",xd="ei";function Pd(t){var e=t?t.event.bus:document.createDocumentFragment(),n=hd();return t&&t.event.on(Ed,n.destroy),Lh(n,{bus:e,on:function(t,r){n.bind(e,vh(t).join(" "),(function(t){r.apply(r,hh(t.detail)?t.detail:[])}))},off:oh(n.unbind,e),emit:function(t){n.dispatch(e,t,ih(arguments,1))}})}function Ld(t,e,n,r){var i,o,s=Date.now,a=0,c=!0,u=0;function l(){if(!c){if(a=t?Zh((s()-i)/t,1):1,n&&n(a),a>=1&&(e(),i=s(),r&&++u>=r))return h();o=ch(l)}}function h(){c=!0}function d(){o&&cancelAnimationFrame(o),a=0,o=0,c=!0}return{start:function(e){e||d(),i=s()-(e?a*t:0),c=!1,o=ch(l)},rewind:function(){i=s(),a=0,n&&n(a)},pause:h,cancel:d,set:function(e){t=e},isPaused:function(){return c}}}var Nd="Arrow",Od=Nd+"Left",Dd=Nd+"Right",Ad=Nd+"Up",Rd=Nd+"Down",Md="ttb",jd={width:["height"],left:["top","right"],right:["bottom","left"],x:["y"],X:["Y"],Y:["X"],ArrowLeft:[Ad,Dd],ArrowRight:[Rd,Od]};var Fd="role",qd="tabindex",zd="aria-",Bd=zd+"controls",Ud=zd+"current",Wd=zd+"selected",Hd=zd+"label",Vd=zd+"labelledby",Gd=zd+"hidden",$d=zd+"orientation",Yd=zd+"roledescription",Kd=zd+"live",Qd=zd+"busy",Jd=zd+"atomic",Xd=[Fd,qd,"disabled",Bd,Ud,Hd,Vd,Gd,$d,Yd],Zd=Qh+"__",tf="is-",ef=Qh,nf=Zd+"track",rf=Zd+"list",of=Zd+"slide",sf=of+"--clone",af=of+"__container",cf=Zd+"arrows",uf=Zd+"arrow",lf=uf+"--prev",hf=uf+"--next",df=Zd+"pagination",ff=df+"__page",pf=Zd+"progress__bar",mf=Zd+"toggle",yf=Zd+"sr",vf=tf+"initialized",gf=tf+"active",_f=tf+"prev",bf=tf+"next",wf=tf+"visible",Cf=tf+"loading",Ef=tf+"focus-in",Sf=tf+"overflow",kf=[gf,wf,_f,bf,Cf,Ef,Sf],If={slide:of,clone:sf,arrows:cf,arrow:uf,prev:lf,next:hf,pagination:df,page:ff,spinner:Zd+"spinner"},Tf="touchstart mousedown",xf="touchmove mousemove",Pf="touchend touchcancel mouseup click",Lf="slide",Nf="loop",Of="fade";var Df=Jh+"-interval",Af={passive:!1,capture:!0},Rf={Spacebar:" ",Right:Dd,Left:Od,Up:Ad,Down:Rd};function Mf(t){return t=fh(t)?t:t.key,Rf[t]||t}var jf="keydown",Ff=Jh+"-lazy",qf=Ff+"-srcset",zf="["+Ff+"], ["+qf+"]",Bf=[" ","Enter"],Uf=Object.freeze({__proto__:null,Media:function(t,e,n){var r=t.state,i=n.breakpoints||{},o=n.reducedMotion||{},s=hd(),a=[];function c(t){t&&s.destroy()}function u(t,e){var n=matchMedia(e);s.bind(n,"change",l),a.push([t,n])}function l(){var e=r.is(7),i=n.direction,o=a.reduce((function(t,e){return Nh(t,e[1].matches?e[0]:{})}),{});Oh(n),h(o),n.destroy?t.destroy("completely"===n.destroy):e?(c(!0),t.mount()):i!==n.direction&&t.refresh()}function h(e,i,o){Nh(n,e),i&&Nh(Object.getPrototypeOf(n),e),!o&&r.is(1)||t.emit(gd,n)}return{setup:function(){var t="min"===n.mediaQuery;xh(i).sort((function(e,n){return t?+e-+n:+n-+e})).forEach((function(e){u(i[e],"("+(t?"min":"max")+"-width:"+e+"px)")})),u(o,eh),l()},destroy:c,reduce:function(t){matchMedia(eh).matches&&(t?Nh(n,o):Oh(n,xh(o)))},set:h}},Direction:function(t,e,n){return{resolve:function(t,e,r){var i="rtl"!==(r=r||n.direction)||e?r===Md?0:-1:1;return jd[t]&&jd[t][i]||t.replace(/width|left|right/i,(function(t,e){var n=jd[t.toLowerCase()][i]||t;return e>0?n.charAt(0).toUpperCase()+n.slice(1):n}))},orient:function(t){return t*("rtl"===n.direction?1:-1)}}},Elements:function(t,e,n){var r,i,o,s=Pd(t),a=s.on,c=s.bind,u=t.root,l=n.i18n,h={},d=[],f=[],p=[];function m(){var t,e,o;r=g("."+nf),i=Th(r,"."+rf),Xh(r&&i,"A track/list element is missing."),bh(d,Ih(i,"."+of+":not(."+sf+")")),Ph({arrows:cf,pagination:df,prev:lf,next:hf,bar:pf,toggle:mf},(function(t,e){h[e]=g("."+t)})),Lh(h,{root:u,track:r,list:i,slides:d}),e=u.id||""+(t=Qh)+ud(ld[t]=(ld[t]||0)+1),o=n.role,u.id=e,r.id=r.id||e+"-track",i.id=i.id||e+"-list",!qh(u,Fd)&&"SECTION"!==u.tagName&&o&&Ah(u,Fd,o),Ah(u,Yd,l.carousel),Ah(i,Fd,"presentation"),v()}function y(t){var e=Xd.concat("style");rh(d),$h(u,f),$h(r,p),Dh([r,i],e),Dh(u,t?e:["style",Yd])}function v(){$h(u,f),$h(r,p),f=_(ef),p=_(nf),Ch(u,f),Ch(r,p),Ah(u,Hd,n.label),Ah(u,Vd,n.labelledby)}function g(t){var e=Vh(u,t);return e&&function(t,e){if(dh(t.closest))return t.closest(e);for(var n=t;n&&1===n.nodeType&&!kh(n,e);)n=n.parentElement;return n}(e,"."+ef)===u?e:void 0}function _(t){return[t+"--"+n.type,t+"--"+n.direction,n.drag&&t+"--draggable",n.isNavigation&&t+"--nav",t===ef&&gf]}return Lh(h,{setup:m,mount:function(){a(vd,y),a(vd,m),a(gd,v),c(document,Tf+" keydown",(function(t){o="keydown"===t.type}),{capture:!0}),c(u,"focusin",(function(){wh(u,Ef,!!o)}))},destroy:y})},Slides:function(t,e,n){var r=Pd(t),i=r.on,o=r.emit,s=r.bind,a=e.Elements,c=a.slides,u=a.list,l=[];function h(){c.forEach((function(t,e){f(t,e,-1)}))}function d(){m((function(t){t.destroy()})),rh(l)}function f(e,n,r){var i=function(t,e,n,r){var i,o=Pd(t),s=o.on,a=o.emit,c=o.bind,u=t.Components,l=t.root,h=t.options,d=h.isNavigation,f=h.updateOnMove,p=h.i18n,m=h.pagination,y=h.slideFocus,v=u.Direction.resolve,g=qh(r,"style"),_=qh(r,Hd),b=n>-1,w=Th(r,"."+af);function C(){var i=t.splides.map((function(t){var n=t.splide.Components.Slides.getAt(e);return n?n.slide.id:""})).join(" ");Ah(r,Hd,cd(p.slideX,(b?n:e)+1)),Ah(r,Bd,i),Ah(r,Fd,y?"button":""),y&&Dh(r,Yd)}function E(){i||S()}function S(){if(!i){var n=t.index;(o=k())!==zh(r,gf)&&(wh(r,gf,o),Ah(r,Ud,d&&o||""),a(o?"active":"inactive",I)),function(){var e=function(){if(t.is(Of))return k();var e=Bh(u.Elements.track),n=Bh(r),i=v("left",!0),o=v("right",!0);return ed(e[i])<=nd(n[i])&&ed(n[o])<=nd(e[o])}(),n=!e&&(!k()||b);if(t.state.is([4,5])||Ah(r,Gd,n||""),Ah(Gh(r,h.focusableNodes||""),qd,n?-1:""),y&&Ah(r,qd,n?-1:0),e!==zh(r,wf)&&(wh(r,wf,e),a(e?"visible":"hidden",I)),!e&&document.activeElement===r){var i=u.Slides.getAt(t.index);i&&Fh(i.slide)}}(),wh(r,_f,e===n-1),wh(r,bf,e===n+1)}var o}function k(){var r=t.index;return r===e||h.cloneStatus&&r===n}var I={index:e,slideIndex:n,slide:r,container:w,isClone:b,mount:function(){b||(r.id=l.id+"-slide"+ud(e+1),Ah(r,Fd,m?"tabpanel":"group"),Ah(r,Yd,p.slide),Ah(r,Hd,_||cd(p.slideLabel,[e+1,t.length]))),c(r,"click",oh(a,yd,I)),c(r,"keydown",oh(a,"sk",I)),s([md,"sh",Cd],S),s(Sd,C),f&&s(pd,E)},destroy:function(){i=!0,o.destroy(),$h(r,kf),Dh(r,Xd),Ah(r,"style",g),Ah(r,Hd,_||"")},update:S,style:function(t,e,n){Mh(n&&w||r,t,e)},isWithin:function(n,r){var i=rd(n-e);return b||!h.rewind&&!t.is(Nf)||(i=Zh(i,t.length-i)),i<=r}};return I}(t,n,r,e);i.mount(),l.push(i),l.sort((function(t,e){return t.index-e.index}))}function p(t){return t?y((function(t){return!t.isClone})):l}function m(t,e){p(e).forEach(t)}function y(t){return l.filter(dh(t)?t:function(e){return fh(t)?kh(e.slide,t):_h(vh(t),e.index)})}return{mount:function(){h(),i(vd,d),i(vd,h)},destroy:d,update:function(){m((function(t){t.update()}))},register:f,get:p,getIn:function(t){var r=e.Controller,i=r.toIndex(t),o=r.hasFocus()?1:n.perPage;return y((function(t){return od(t.index,i,i+o-1)}))},getAt:function(t){return y(t)[0]},add:function(t,e){gh(t,(function(t){if(fh(t)&&(t=Wh(t)),yh(t)){var r=c[e];r?Sh(t,r):Eh(u,t),Ch(t,n.classes.slide),i=t,a=oh(o,_d),l=Gh(i,"img"),(h=l.length)?l.forEach((function(t){s(t,"load error",(function(){--h||a()}))})):a()}var i,a,l,h})),o(vd)},remove:function(t){Uh(y(t).map((function(t){return t.slide}))),o(vd)},forEach:m,filter:y,style:function(t,e,n){m((function(r){r.style(t,e,n)}))},getLength:function(t){return t?c.length:l.length},isEnough:function(){return l.length>n.perPage}}},Layout:function(t,e,n){var r,i,o,s=Pd(t),a=s.on,c=s.bind,u=s.emit,l=e.Slides,h=e.Direction.resolve,d=e.Elements,f=d.root,p=d.track,m=d.list,y=l.getAt,v=l.style;function g(){r=n.direction===Md,Mh(f,"maxWidth",Kh(n.width)),Mh(p,h("paddingLeft"),b(!1)),Mh(p,h("paddingRight"),b(!0)),_(!0)}function _(t){var e,s=Bh(f);(t||i.width!==s.width||i.height!==s.height)&&(Mh(p,"height",(e="",r&&(Xh(e=w(),"height or heightRatio is missing."),e="calc("+e+" - "+b(!1)+" - "+b(!0)+")"),e)),v(h("marginRight"),Kh(n.gap)),v("width",n.autoWidth?null:Kh(n.fixedWidth)||(r?"":C())),v("height",Kh(n.fixedHeight)||(r?n.autoHeight?null:C():w()),!0),i=s,u(bd),o!==(o=x())&&(wh(f,Sf,o),u("overflow",o)))}function b(t){var e=n.padding,r=h(t?"right":"left");return e&&Kh(e[r]||(lh(e)?0:e))||"0px"}function w(){return Kh(n.height||Bh(m).width*n.heightRatio)}function C(){var t=Kh(n.gap);return"calc((100%"+(t&&" + "+t)+")/"+(n.perPage||1)+(t&&" - "+t)+")"}function E(){return Bh(m)[h("width")]}function S(t,e){var n=y(t||0);return n?Bh(n.slide)[h("width")]+(e?0:T()):0}function k(t,e){var n=y(t);if(n){var r=Bh(n.slide)[h("right")],i=Bh(m)[h("left")];return rd(r-i)+(e?0:T())}return 0}function I(e){return k(t.length-1)-k(0)+S(0,e)}function T(){var t=y(0);return t&&parseFloat(Mh(t.slide,h("marginRight")))||0}function x(){return t.is(Of)||I(!0)>E()}return{mount:function(){var t,e;g(),c(window,"resize load",(t=oh(u,_d),e=Ld(0,t,null,1),function(){e.isPaused()&&e.start()})),a([gd,vd],g),a(_d,_)},resize:_,listSize:E,slideSize:S,sliderSize:I,totalSize:k,getPadding:function(t){return parseFloat(Mh(p,h("padding"+(t?"Right":"Left"))))||0},isOverflow:x}},Clones:function(t,e,n){var r,i=Pd(t),o=i.on,s=e.Elements,a=e.Slides,c=e.Direction.resolve,u=[];function l(){o(vd,h),o([gd,_d],f),(r=p())&&(function(e){var r=a.get().slice(),i=r.length;if(i){for(;r.length<e;)bh(r,r);bh(r.slice(-e),r.slice(0,e)).forEach((function(o,c){var l=c<e,h=function(e,r){var i=e.cloneNode(!0);return Ch(i,n.classes.clone),i.id=t.root.id+"-clone"+ud(r+1),i}(o.slide,c);l?Sh(h,r[0].slide):Eh(s.list,h),bh(u,h),a.register(h,c-e+(l?0:i),o.index)}))}}(r),e.Layout.resize(!0))}function h(){d(),l()}function d(){Uh(u),rh(u),i.destroy()}function f(){var t=p();r!==t&&(r<t||!t)&&i.emit(vd)}function p(){var r=n.clones;if(t.is(Nf)){if(ph(r)){var i=n[c("fixedWidth")]&&e.Layout.slideSize(0);r=i&&nd(Bh(s.track)[c("width")]/i)||n[c("autoWidth")]&&t.length||2*n.perPage}}else r=0;return r}return{mount:l,destroy:d}},Move:function(t,e,n){var r,i=Pd(t),o=i.on,s=i.emit,a=t.state.set,c=e.Layout,u=c.slideSize,l=c.getPadding,h=c.totalSize,d=c.listSize,f=c.sliderSize,p=e.Direction,m=p.resolve,y=p.orient,v=e.Elements,g=v.list,_=v.track;function b(){e.Controller.isBusy()||(e.Scroll.cancel(),w(t.index),e.Slides.update())}function w(t){C(I(t,!0))}function C(n,r){if(!t.is(Of)){var i=r?n:function(n){if(t.is(Nf)){var r=k(n),i=r>e.Controller.getEnd();(r<0||i)&&(n=E(n,i))}return n}(n);Mh(g,"transform","translate"+m("X")+"("+i+"px)"),n!==i&&s("sh")}}function E(t,e){var n=t-x(e),r=f();return t-y(r*(nd(rd(n)/r)||1))*(e?1:-1)}function S(){C(T(),!0),r.cancel()}function k(t){for(var n=e.Slides.get(),r=0,i=1/0,o=0;o<n.length;o++){var s=n[o].index,a=rd(I(s,!0)-t);if(!(a<=i))break;i=a,r=s}return r}function I(e,r){var i=y(h(e-1)-function(t){var e=n.focus;return"center"===e?(d()-u(t,!0))/2:+e*u(t)||0}(e));return r?function(e){return n.trimSpace&&t.is(Lf)&&(e=sd(e,0,y(f(!0)-d()))),e}(i):i}function T(){var t=m("left");return Bh(g)[t]-Bh(_)[t]+y(l(!1))}function x(t){return I(t?e.Controller.getEnd():0,!!n.trimSpace)}return{mount:function(){r=e.Transition,o([dd,bd,gd,vd],b)},move:function(t,e,n,i){var o,c;t!==e&&(o=t>n,c=y(E(T(),o)),o?c>=0:c<=g[m("scrollWidth")]-Bh(_)[m("width")])&&(S(),C(E(T(),t>n),!0)),a(4),s(pd,e,n,t),r.start(e,(function(){a(3),s(md,e,n,t),i&&i()}))},jump:w,translate:C,shift:E,cancel:S,toIndex:k,toPosition:I,getPosition:T,getLimit:x,exceededLimit:function(t,e){e=ph(e)?T():e;var n=!0!==t&&y(e)<y(x(!1)),r=!1!==t&&y(e)>y(x(!0));return n||r},reposition:b}},Controller:function(t,e,n){var r,i,o,s,a=Pd(t),c=a.on,u=a.emit,l=e.Move,h=l.getPosition,d=l.getLimit,f=l.toPosition,p=e.Slides,m=p.isEnough,y=p.getLength,v=n.omitEnd,g=t.is(Nf),_=t.is(Lf),b=oh(I,!1),w=oh(I,!0),C=n.start||0,E=C;function S(){i=y(!0),o=n.perMove,s=n.perPage,r=P();var t=sd(C,0,v?r:i-1);t!==C&&(C=t,l.reposition())}function k(){r!==P()&&u(xd)}function I(t,e){var n=o||(D()?1:s),i=T(C+n*(t?-1:1),C,!(o||D()));return-1===i&&_&&!id(h(),d(!t),1)?t?0:r:e?i:x(i)}function T(e,a,c){if(m()||D()){var u=function(e){if(_&&"move"===n.trimSpace&&e!==C)for(var r=h();r===f(e,!0)&&od(e,0,t.length-1,!n.rewind);)e<C?--e:++e;return e}(e);u!==e&&(a=e,e=u,c=!1),e<0||e>r?e=o||!od(0,e,a,!0)&&!od(r,a,e,!0)?g?c?e<0?-(i%s||s):i:e:n.rewind?e<0?r:0:-1:L(N(e)):c&&e!==a&&(e=L(N(a)+(e<a?-1:1)))}else e=-1;return e}function x(t){return g?(t+i)%i||0:t}function P(){for(var t=i-(D()||g&&o?1:s);v&&t-- >0;)if(f(i-1,!0)!==f(t,!0)){t++;break}return sd(t,0,i-1)}function L(t){return sd(D()?t:s*t,0,r)}function N(t){return D()?Zh(t,r):ed((t>=r?i-1:t)/s)}function O(t){t!==C&&(E=C,C=t)}function D(){return!ph(n.focus)||n.isNavigation}function A(){return t.state.is([4,5])&&!!n.waitForTransition}return{mount:function(){S(),c([gd,vd,xd],S),c(bd,k)},go:function(t,e,n){if(!A()){var i=function(t){var e=C;if(fh(t)){var n=t.match(/([+\-<>])(\d+)?/)||[],i=n[1],o=n[2];"+"===i||"-"===i?e=T(C+ +(""+i+(+o||1)),C):">"===i?e=o?L(+o):b(!0):"<"===i&&(e=w(!0))}else e=g?t:sd(t,0,r);return e}(t),o=x(i);o>-1&&(e||o!==C)&&(O(o),l.move(i,o,E,n))}},scroll:function(t,n,i,o){e.Scroll.scroll(t,n,i,(function(){var t=x(l.toIndex(h()));O(v?Zh(t,r):t),o&&o()}))},getNext:b,getPrev:w,getAdjacent:I,getEnd:P,setIndex:O,getIndex:function(t){return t?E:C},toIndex:L,toPage:N,toDest:function(t){var e=l.toIndex(t);return _?sd(e,0,r):e},hasFocus:D,isBusy:A}},Arrows:function(t,e,n){var r,i,o=Pd(t),s=o.on,a=o.bind,c=o.emit,u=n.classes,l=n.i18n,h=e.Elements,d=e.Controller,f=h.arrows,p=h.track,m=f,y=h.prev,v=h.next,g={};function _(){var t;!(t=n.arrows)||y&&v||(m=f||Rh("div",u.arrows),y=E(!0),v=E(!1),r=!0,Eh(m,[y,v]),!f&&Sh(m,p)),y&&v&&(Lh(g,{prev:y,next:v}),jh(m,t?"":"none"),Ch(m,i=cf+"--"+n.direction),t&&(s([dd,md,vd,Cd,xd],S),a(v,"click",oh(C,">")),a(y,"click",oh(C,"<")),S(),Ah([y,v],Bd,p.id),c("arrows:mounted",y,v))),s(gd,b)}function b(){w(),_()}function w(){o.destroy(),$h(m,i),r?(Uh(f?[y,v]:m),y=v=null):Dh([y,v],Xd)}function C(t){d.go(t,!0)}function E(t){return Wh('<button class="'+u.arrow+" "+(t?u.prev:u.next)+'" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 40 40" width="40" height="40" focusable="false"><path d="'+(n.arrowPath||"m15.5 0.932-4.3 4.38 14.5 14.6-14.5 14.5 4.3 4.4 14.6-14.6 4.4-4.3-4.4-4.4-14.6-14.6z")+'" />')}function S(){if(y&&v){var e=t.index,n=d.getPrev(),r=d.getNext(),i=n>-1&&e<n?l.last:l.prev,o=r>-1&&e>r?l.first:l.next;y.disabled=n<0,v.disabled=r<0,Ah(y,Hd,i),Ah(v,Hd,o),c("arrows:updated",y,v,n,r)}}return{arrows:g,mount:_,destroy:w,update:S}},Autoplay:function(t,e,n){var r,i,o=Pd(t),s=o.on,a=o.bind,c=o.emit,u=Ld(n.interval,t.go.bind(t,">"),(function(t){var e=h.bar;e&&Mh(e,"width",100*t+"%"),c("autoplay:playing",t)})),l=u.isPaused,h=e.Elements,d=e.Elements,f=d.root,p=d.toggle,m=n.autoplay,y="pause"===m;function v(){l()&&e.Slides.isEnough()&&(u.start(!n.resetProgress),i=r=y=!1,b(),c(kd))}function g(t){void 0===t&&(t=!0),y=!!t,b(),l()||(u.pause(),c(Id))}function _(){y||(r||i?g(!1):v())}function b(){p&&(wh(p,gf,!y),Ah(p,Hd,n.i18n[y?"play":"pause"]))}function w(t){var r=e.Slides.getAt(t);u.set(r&&+qh(r.slide,Df)||n.interval)}return{mount:function(){m&&(n.pauseOnHover&&a(f,"mouseenter mouseleave",(function(t){r="mouseenter"===t.type,_()})),n.pauseOnFocus&&a(f,"focusin focusout",(function(t){i="focusin"===t.type,_()})),p&&a(p,"click",(function(){y?v():g(!0)})),s([pd,wd,vd],u.rewind),s(pd,w),p&&Ah(p,Bd,h.track.id),y||v(),b())},destroy:u.cancel,play:v,pause:g,isPaused:l}},Cover:function(t,e,n){var r=Pd(t).on;function i(t){e.Slides.forEach((function(e){var n=Th(e.container||e.slide,"img");n&&n.src&&o(t,n,e)}))}function o(t,e,n){n.style("background",t?'center/cover no-repeat url("'+e.src+'")':"",!0),jh(e,t?"none":"")}return{mount:function(){n.cover&&(r(Td,oh(o,!0)),r([dd,gd,vd],oh(i,!0)))},destroy:oh(i,!1)}},Scroll:function(t,e,n){var r,i,o=Pd(t),s=o.on,a=o.emit,c=t.state.set,u=e.Move,l=u.getPosition,h=u.getLimit,d=u.exceededLimit,f=u.translate,p=t.is(Lf),m=1;function y(t,n,o,s,h){var f=l();if(_(),o&&(!p||!d())){var y=e.Layout.sliderSize(),b=ad(t)*y*ed(rd(t)/y)||0;t=u.toPosition(e.Controller.toDest(t%y))+b}var w=id(f,t,1);m=1,n=w?0:n||td(rd(t-f)/1.5,800),i=s,r=Ld(n,v,oh(g,f,t,h),1),c(5),a(wd),r.start()}function v(){c(3),i&&i(),a(Cd)}function g(t,e,r,o){var s,a,c=l(),u=(t+(e-t)*(s=o,(a=n.easingFunc)?a(s):1-Math.pow(1-s,4))-c)*m;f(c+u),p&&!r&&d()&&(m*=.6,rd(u)<10&&y(h(d(!0)),600,!1,i,!0))}function _(){r&&r.cancel()}function b(){r&&!r.isPaused()&&(_(),v())}return{mount:function(){s(pd,_),s([gd,vd],b)},destroy:_,scroll:y,cancel:b}},Drag:function(t,e,n){var r,i,o,s,a,c,u,l,h=Pd(t),d=h.on,f=h.emit,p=h.bind,m=h.unbind,y=t.state,v=e.Move,g=e.Scroll,_=e.Controller,b=e.Elements.track,w=e.Media.reduce,C=e.Direction,E=C.resolve,S=C.orient,k=v.getPosition,I=v.exceededLimit,T=!1;function x(){var t=n.drag;q(!t),s="free"===t}function P(t){if(c=!1,!u){var e=F(t);r=t.target,i=n.noDrag,kh(r,"."+ff+", ."+uf)||i&&kh(r,i)||!e&&t.button||(_.isBusy()?Hh(t,!0):(l=e?b:window,a=y.is([4,5]),o=null,p(l,xf,L,Af),p(l,Pf,N,Af),v.cancel(),g.cancel(),D(t)))}var r,i}function L(e){if(y.is(6)||(y.set(6),f("drag")),e.cancelable)if(a){v.translate(r+A(e)/(T&&t.is(Lf)?5:1));var i=R(e)>200,o=T!==(T=I());(i||o)&&D(e),c=!0,f("dragging"),Hh(e)}else(function(t){return rd(A(t))>rd(A(t,!0))})(e)&&(a=function(t){var e=n.dragMinThreshold,r=lh(e),i=r&&e.mouse||0,o=(r?e.touch:+e)||10;return rd(A(t))>(F(t)?o:i)}(e),Hh(e))}function N(r){y.is(6)&&(y.set(3),f("dragged")),a&&(function(r){var i=function(e){if(t.is(Nf)||!T){var n=R(e);if(n&&n<200)return A(e)/n}return 0}(r),o=function(t){return k()+ad(t)*Zh(rd(t)*(n.flickPower||600),s?1/0:e.Layout.listSize()*(n.flickMaxPages||1))}(i),a=n.rewind&&n.rewindByDrag;w(!1),s?_.scroll(o,0,n.snap):t.is(Of)?_.go(S(ad(i))<0?a?"<":"-":a?">":"+"):t.is(Lf)&&T&&a?_.go(I(!0)?">":"<"):_.go(_.toDest(o),!0),w(!0)}(r),Hh(r)),m(l,xf,L),m(l,Pf,N),a=!1}function O(t){!u&&c&&Hh(t,!0)}function D(t){o=i,i=t,r=k()}function A(t,e){return j(t,e)-j(M(t),e)}function R(t){return Yh(t)-Yh(M(t))}function M(t){return i===t&&o||i}function j(t,e){return(F(t)?t.changedTouches[0]:t)["page"+E(e?"Y":"X")]}function F(t){return"undefined"!=typeof TouchEvent&&t instanceof TouchEvent}function q(t){u=t}return{mount:function(){p(b,xf,ah,Af),p(b,Pf,ah,Af),p(b,Tf,P,Af),p(b,"click",O,{capture:!0}),p(b,"dragstart",Hh),d([dd,gd],x)},disable:q,isDragging:function(){return a}}},Keyboard:function(t,e,n){var r,i,o=Pd(t),s=o.on,a=o.bind,c=o.unbind,u=t.root,l=e.Direction.resolve;function h(){var t=n.keyboard;t&&(r="global"===t?window:u,a(r,jf,p))}function d(){c(r,jf)}function f(){var t=i;i=!0,sh((function(){i=t}))}function p(e){if(!i){var n=Mf(e);n===l(Od)?t.go("<"):n===l(Dd)&&t.go(">")}}return{mount:function(){h(),s(gd,d),s(gd,h),s(pd,f)},destroy:d,disable:function(t){i=t}}},LazyLoad:function(t,e,n){var r=Pd(t),i=r.on,o=r.off,s=r.bind,a=r.emit,c="sequential"===n.lazyLoad,u=[md,Cd],l=[];function h(){rh(l),e.Slides.forEach((function(t){Gh(t.slide,zf).forEach((function(e){var r=qh(e,Ff),i=qh(e,qf);if(r!==e.src||i!==e.srcset){var o=n.classes.spinner,s=e.parentElement,a=Th(s,"."+o)||Rh("span",o,s);l.push([e,t,a]),e.src||jh(e,"none")}}))})),c?m():(o(u),i(u,d),d())}function d(){(l=l.filter((function(e){var r=n.perPage*((n.preloadPages||1)+1)-1;return!e[1].isWithin(t.index,r)||f(e)}))).length||o(u)}function f(t){var e=t[0];Ch(t[1].slide,Cf),s(e,"load error",oh(p,t)),Ah(e,"src",qh(e,Ff)),Ah(e,"srcset",qh(e,qf)),Dh(e,Ff),Dh(e,qf)}function p(t,e){var n=t[0],r=t[1];$h(r.slide,Cf),"error"!==e.type&&(Uh(t[2]),jh(n,""),a(Td,n,r),a(_d)),c&&m()}function m(){l.length&&f(l.shift())}return{mount:function(){n.lazyLoad&&(h(),i(vd,h))},destroy:oh(rh,l),check:d}},Pagination:function(t,e,n){var r,i,o=Pd(t),s=o.on,a=o.emit,c=o.bind,u=e.Slides,l=e.Elements,h=e.Controller,d=h.hasFocus,f=h.getIndex,p=h.go,m=e.Direction.resolve,y=l.pagination,v=[];function g(){r&&(Uh(y?ih(r.children):r),$h(r,i),rh(v),r=null),o.destroy()}function _(t){p(">"+t,!0)}function b(t,e){var n=v.length,r=Mf(e),i=w(),o=-1;r===m(Dd,!1,i)?o=++t%n:r===m(Od,!1,i)?o=(--t+n)%n:"Home"===r?o=0:"End"===r&&(o=n-1);var s=v[o];s&&(Fh(s.button),p(">"+o),Hh(e,!0))}function w(){return n.paginationDirection||n.direction}function C(t){return v[h.toPage(t)]}function E(){var t=C(f(!0)),e=C(f());if(t){var n=t.button;$h(n,gf),Dh(n,Wd),Ah(n,qd,-1)}if(e){var i=e.button;Ch(i,gf),Ah(i,Wd,!0),Ah(i,qd,"")}a("pagination:updated",{list:r,items:v},t,e)}return{items:v,mount:function e(){g(),s([gd,vd,xd],e);var o=n.pagination;y&&jh(y,o?"":"none"),o&&(s([pd,wd,Cd],E),function(){var e=t.length,o=n.classes,s=n.i18n,a=n.perPage,f=d()?h.getEnd()+1:nd(e/a);Ch(r=y||Rh("ul",o.pagination,l.track.parentElement),i=df+"--"+w()),Ah(r,Fd,"tablist"),Ah(r,Hd,s.select),Ah(r,$d,w()===Md?"vertical":"");for(var p=0;p<f;p++){var m=Rh("li",null,r),g=Rh("button",{class:o.page,type:"button"},m),C=u.getIn(p).map((function(t){return t.slide.id})),E=!d()&&a>1?s.pageX:s.slideX;c(g,"click",oh(_,p)),n.paginationKeyboard&&c(g,"keydown",oh(b,p)),Ah(m,Fd,"presentation"),Ah(g,Fd,"tab"),Ah(g,Bd,C.join(" ")),Ah(g,Hd,cd(E,p+1)),Ah(g,qd,-1),v.push({li:m,button:g,page:p})}}(),E(),a("pagination:mounted",{list:r,items:v},C(t.index)))},destroy:g,getAt:C,update:E}},Sync:function(t,e,n){var r=n.isNavigation,i=n.slideFocus,o=[];function s(){t.splides.forEach((function(e){e.isParent||(c(t,e.splide),c(e.splide,t))})),r&&function(){var e=Pd(t),n=e.on;n(yd,l),n("sk",h),n([dd,gd],u),o.push(e),e.emit(Sd,t.splides)}()}function a(){o.forEach((function(t){t.destroy()})),rh(o)}function c(t,e){var n=Pd(t);n.on(pd,(function(t,n,r){e.go(e.is(Nf)?r:t)})),o.push(n)}function u(){Ah(e.Elements.list,$d,n.direction===Md?"vertical":"")}function l(e){t.go(e.index)}function h(t,e){_h(Bf,Mf(e))&&(l(t),Hh(e))}return{setup:oh(e.Media.set,{slideFocus:ph(i)?r:i},!0),mount:s,destroy:a,remount:function(){a(),s()}}},Wheel:function(t,e,n){var r=Pd(t).bind,i=0;function o(r){if(r.cancelable){var o=r.deltaY,s=o<0,a=Yh(r),c=n.wheelMinThreshold||0,u=n.wheelSleep||0;rd(o)>c&&a-i>u&&(t.go(s?"<":">"),i=a),function(r){return!n.releaseWheel||t.state.is(4)||-1!==e.Controller.getAdjacent(r)}(s)&&Hh(r)}}return{mount:function(){n.wheel&&r(e.Elements.track,"wheel",o,Af)}}},Live:function(t,e,n){var r=Pd(t).on,i=e.Elements.track,o=n.live&&!n.isNavigation,s=Rh("span",yf),a=Ld(90,oh(c,!1));function c(t){Ah(i,Qd,t),t?(Eh(i,s),a.start()):(Uh(s),a.cancel())}function u(t){o&&Ah(i,Kd,t?"off":"polite")}return{mount:function(){o&&(u(!e.Autoplay.isPaused()),Ah(i,Jd,!0),s.textContent="…",r(kd,oh(u,!0)),r(Id,oh(u,!1)),r([md,Cd],oh(c,!0)))},disable:u,destroy:function(){Dh(i,[Kd,Jd,Qd]),Uh(s)}}}}),Wf={type:"slide",role:"region",speed:400,perPage:1,cloneStatus:!0,arrows:!0,pagination:!0,paginationKeyboard:!0,interval:5e3,pauseOnHover:!0,pauseOnFocus:!0,resetProgress:!0,easing:"cubic-bezier(0.25, 1, 0.5, 1)",drag:!0,direction:"ltr",trimSpace:!0,focusableNodes:"a, button, textarea, input, select, iframe",live:!0,classes:If,i18n:{prev:"Previous slide",next:"Next slide",first:"Go to first slide",last:"Go to last slide",slideX:"Go to slide %s",pageX:"Go to page %s",play:"Start autoplay",pause:"Pause autoplay",carousel:"carousel",slide:"slide",select:"Select a slide to show",slideLabel:"%s of %s"},reducedMotion:{speed:0,rewindSpeed:0,autoplay:"pause"}};function Hf(t,e,n){var r=e.Slides;function i(){r.forEach((function(t){t.style("transform","translateX(-"+100*t.index+"%)")}))}return{mount:function(){Pd(t).on([dd,vd],i)},start:function(t,e){r.style("transition","opacity "+n.speed+"ms "+n.easing),sh(e)},cancel:ah}}function Vf(t,e,n){var r,i=e.Move,o=e.Controller,s=e.Scroll,a=e.Elements.list,c=oh(Mh,a,"transition");function u(){c(""),s.cancel()}return{mount:function(){Pd(t).bind(a,"transitionend",(function(t){t.target===a&&r&&(u(),r())}))},start:function(e,a){var u=i.toPosition(e,!0),l=i.getPosition(),h=function(e){var r=n.rewindSpeed;if(t.is(Lf)&&r){var i=o.getIndex(!0),s=o.getEnd();if(0===i&&e>=s||i>=s&&0===e)return r}return n.speed}(e);rd(u-l)>=1&&h>=1?n.useScroll?s.scroll(u,h,!1,a):(c("transform "+h+"ms "+n.easing),i.translate(u,!0),r=a):(i.jump(e),a())},cancel:u}}var Gf=function(){function t(e,n){var r;this.event=Pd(),this.Components={},this.state=(r=1,{set:function(t){r=t},is:function(t){return _h(vh(t),r)}}),this.splides=[],this._o={},this._E={};var i=fh(e)?Vh(document,e):e;Xh(i,i+" is invalid."),this.root=i,n=Nh({label:qh(i,Hd)||"",labelledby:qh(i,Vd)||""},Wf,t.defaults,n||{});try{Nh(n,JSON.parse(qh(i,Jh)))}catch(t){Xh(!1,"Invalid JSON")}this._o=Object.create(Nh({},n))}var e,n,r=t.prototype;return r.mount=function(t,e){var n=this,r=this.state,i=this.Components;return Xh(r.is([1,7]),"Already mounted!"),r.set(1),this._C=i,this._T=e||this._T||(this.is(Of)?Hf:Vf),this._E=t||this._E,Ph(Lh({},Uf,this._E,{Transition:this._T}),(function(t,e){var r=t(n,i,n._o);i[e]=r,r.setup&&r.setup()})),Ph(i,(function(t){t.mount&&t.mount()})),this.emit(dd),Ch(this.root,vf),r.set(3),this.emit(fd),this},r.sync=function(t){return this.splides.push({splide:t}),t.splides.push({splide:this,isParent:!0}),this.state.is(3)&&(this._C.Sync.remount(),t.Components.Sync.remount()),this},r.go=function(t){return this._C.Controller.go(t),this},r.on=function(t,e){return this.event.on(t,e),this},r.off=function(t){return this.event.off(t),this},r.emit=function(t){var e;return(e=this.event).emit.apply(e,[t].concat(ih(arguments,1))),this},r.add=function(t,e){return this._C.Slides.add(t,e),this},r.remove=function(t){return this._C.Slides.remove(t),this},r.is=function(t){return this._o.type===t},r.refresh=function(){return this.emit(vd),this},r.destroy=function(t){void 0===t&&(t=!0);var e=this.event,n=this.state;return n.is(1)?Pd(this).on(fd,this.destroy.bind(this,t)):(Ph(this._C,(function(e){e.destroy&&e.destroy(t)}),!0),e.emit(Ed),e.destroy(),t&&rh(this.splides),n.set(7)),this},e=t,(n=[{key:"options",get:function(){return this._o},set:function(t){this._C.Media.set(t,!0,!0)}},{key:"length",get:function(){return this._C.Slides.getLength(!0)}},{key:"index",get:function(){return this._C.Controller.getIndex()}}])&&th(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function $f(t,e,n){return Array.prototype.slice.call(t,e,n)}function Yf(t){return t.bind.apply(t,[null].concat($f(arguments,1)))}function Kf(t){return requestAnimationFrame(t)}function Qf(t,e){return typeof e===t}Gf.defaults={},Gf.STATES=nh;var Jf=Array.isArray;function Xf(t){return Jf(t)?t:[t]}function Zf(t,e){Xf(t).forEach(e)}Yf(Qf,"function"),Yf(Qf,"string"),Yf(Qf,"undefined");var tp=Object.keys;var ep=Math.min,np="move",rp="moved",ip="drag",op="scroll",sp="scrolled",ap="destroy";function cp(t){var e=t?t.event.bus:document.createDocumentFragment(),n=function(){var t=[];function e(t,e,n){Zf(t,(function(t){t&&Zf(e,(function(e){e.split(" ").forEach((function(e){var r=e.split(".");n(t,r[0],r[1])}))}))}))}return{bind:function(n,r,i,o){e(n,r,(function(e,n,r){var s="addEventListener"in e,a=s?e.removeEventListener.bind(e,n,i,o):e.removeListener.bind(e,i);s?e.addEventListener(n,i,o):e.addListener(i),t.push([e,n,r,i,a])}))},unbind:function(n,r,i){e(n,r,(function(e,n,r){t=t.filter((function(t){return!!(t[0]!==e||t[1]!==n||t[2]!==r||i&&t[3]!==i)||(t[4](),!1)}))}))},dispatch:function(t,e,n){var r,i=!0;return"function"==typeof CustomEvent?r=new CustomEvent(e,{bubbles:i,detail:n}):(r=document.createEvent("CustomEvent")).initCustomEvent(e,i,!1,n),t.dispatchEvent(r),r},destroy:function(){t.forEach((function(t){t[4]()})),t.length=0}}}();return t&&t.event.on(ap,n.destroy),function(t){return $f(arguments,1).forEach((function(e){!function(t,e,n){if(t)for(var r=tp(t),i=0;i<r.length;i++){var o=r[i];if("__proto__"!==o&&!1===e(t[o],o))break}}(e,(function(n,r){t[r]=e[r]}))})),t}(n,{bus:e,on:function(t,r){n.bind(e,Xf(t).join(" "),(function(t){r.apply(r,Jf(t.detail)?t.detail:[])}))},off:Yf(n.unbind,e),emit:function(t){n.dispatch(e,t,$f(arguments,1))}})}function up(t,e,n,r){var i,o,s=Date.now,a=0,c=!0,u=0;function l(){if(!c){if(a=t?ep((s()-i)/t,1):1,n&&n(a),a>=1&&(e(),i=s(),r&&++u>=r))return h();Kf(l)}}function h(){c=!0}function d(){o&&cancelAnimationFrame(o),a=0,o=0,c=!0}return{start:function(e){!e&&d(),i=s()-(e?a*t:0),c=!1,Kf(l)},rewind:function(){i=s(),a=0,n&&n(a)},pause:h,cancel:d,set:function(e){t=e},isPaused:function(){return c}}}function lp(t,e,n){return Array.prototype.slice.call(t,e,n)}function hp(t){return t.bind(null,...lp(arguments,1))}function dp(t,e){return typeof e===t}function fp(t){return!yp(t)&&dp("object",t)}const pp=Array.isArray;hp(dp,"function"),hp(dp,"string");const mp=hp(dp,"undefined");function yp(t){return null===t}function vp(t,e){var n;(n=t,pp(n)?n:[n]).forEach(e)}const gp=Object.keys;function _p(t,e,n){if(t){let r=gp(t);r=n?r.reverse():r;for(let n=0;n<r.length;n++){const i=r[n];if("__proto__"!==i&&!1===e(t[i],i))break}}return t}function bp(t){return lp(arguments,1).forEach((e=>{_p(e,((n,r)=>{t[r]=e[r]}))})),t}function wp(t,e,n){fp(e)?_p(e,((e,n)=>{wp(t,n,e)})):vp(t,(t=>{yp(n)||""===n?function(t,e){vp(t,(t=>{vp(e,(e=>{t&&t.removeAttribute(e)}))}))}(t,e):t.setAttribute(e,String(n))}))}const{min:Cp,max:Ep,floor:Sp,ceil:kp,abs:Ip}=Math,Tp={speed:1,autoStart:!0,pauseOnHover:!0,pauseOnFocus:!0},xp={startScroll:"Start auto scroll",pauseScroll:"Pause auto scroll"};function Pp(t,e,n){const{on:r,off:i,bind:o,unbind:s}=cp(t),{translate:a,getPosition:c,toIndex:u,getLimit:l}=e.Move,{setIndex:h,getIndex:d}=e.Controller,{orient:f}=e.Direction,{toggle:p}=e.Elements,{Live:m}=e,{root:y}=t,v=function(t,e){var n;return function(){n||(n=up(500,(function(){t(),n=null}),null,1)).start()}}(e.Arrows.update);let g,_,b,w,C,E,S={};function k(){t.is("fade")||g||!1===n.autoScroll||(g=up(0,N),S.pauseOnHover&&o(y,"mouseenter mouseleave",(t=>{b="mouseenter"===t.type,L()})),S.pauseOnFocus&&o(y,"focusin focusout",(t=>{w="focusin"===t.type,L()})),S.useToggleButton&&o(p,"click",(()=>{_?x():P()})),r("updated",T),r([np,ip,op],(()=>{C=!0,P(!1)})),r([rp,"dragged",sp],(()=>{C=!1,L()})),S.autoStart&&("complete"===document.readyState?x():o(window,"load",x)))}function I(){g&&(g.cancel(),g=null,E=void 0,i([np,ip,op,rp,sp]),s(y,"mouseenter mouseleave focusin focusout"),s(p,"click"))}function T(){const{autoScroll:t}=n;!1!==t?(S=bp({},S,fp(t)?t:{}),k()):I(),g&&!mp(E)&&a(E)}function x(){D()&&(g.start(!0),m.disable(!0),w=b=_=!1,O())}function P(t=!0){_||(_=t,O(),D()||(g.pause(),m.disable(!1)))}function L(){_||(b||w||C?P(!1):x())}function N(){const r=c(),i=function(e){const n=S.speed||1;return e+=f(n),t.is("slide")&&(e=function(t,e,n){const r=Cp(e,n),i=Ep(e,n);return Cp(Ep(r,t),i)}(e,l(!1),l(!0))),e}(r);r!==i?(a(i),function(r){const{length:i}=t,o=(u(r)+i)%i;o!==d()&&(h(o),e.Slides.update(),e.Pagination.update(),"nearby"===n.lazyLoad&&e.LazyLoad.check())}(E=c())):(P(!1),S.rewind&&t.go(S.speed>0?0:e.Controller.getEnd())),v()}function O(){if(p){const r=_?"startScroll":"pauseScroll";"is-active",e=!_,(t=p)&&vp("is-active",(n=>{n&&t.classList[e?"add":"remove"](n)})),wp(p,"aria-label",n.i18n[r]||xp[r])}var t,e}function D(){return!g||g.isPaused()}return{setup:function(){const{autoScroll:t}=n;S=bp({},Tp,fp(t)?t:{})},mount:k,destroy:I,play:x,pause:P,isPaused:D}}function Lp(t){return Lp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Lp(t)}function Np(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Op(r.key),r)}}function Op(t){var e=function(t,e){if("object"!=Lp(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!=Lp(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Lp(e)?e:e+""}var Dp=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.initSlider()},(e=[{key:"initSlider",value:function(){new Gf("#reviews-slider",{type:"loop",drag:"free",focus:"center",perPage:3,autoScroll:{speed:1},autoWidth:!0,gap:20,padding:"10px",classes:{pagination:"splide__pagination pagination",page:"splide__pagination__page pagination__button",arrows:"splide__arrows gallery__arrows",arrow:"splide__arrow gallery__arrow",prev:"splide__arrow--prev gallery__prev",next:"splide__arrow--next gallery__next"}}).mount({AutoScroll:Pp})}}])&&Np(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function Ap(t){return Ap="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ap(t)}function Rp(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Mp(r.key),r)}}function Mp(t){var e=function(t,e){if("object"!=Ap(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!=Ap(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Ap(e)?e:e+""}var jp=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.mobileMenu=new Zl,this.init()},(e=[{key:"init",value:function(){this.initMobileMenu(),this.initCatalog(),this.initForm(),this.initDeliverySection(),new g,new Dp,(new Dt).init()}},{key:"initMobileMenu",value:function(){this.mobileMenu.addListener()}},{key:"initCatalog",value:function(){new Vl}},{key:"initForm",value:function(){var t=document.querySelector(".contacts__form");new Vt(t)}},{key:"initDeliverySection",value:function(){new Kl}}])&&Rp(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();document.addEventListener("DOMContentLoaded",(function(){var t=document.getElementById("up");t.addEventListener("click",(function(){window.scrollTo({top:0,behavior:"smooth"})})),window.addEventListener("load",(function(){return Ft(t)})),window.addEventListener("scroll",(function(){return Ft(t)})),new jp}))})();
//# sourceMappingURL=main-a75b68d9.js.map